PROJECT STRUCTURE:
==================
./
    .env
    .env.example
    .gitignore
    docker-compose.yml
    plan.docx
    README.md
    backend/
        Dockerfile
        manage.py
        pytest.ini
        requirements.txt
        .pytest_cache/
            .gitignore
            CACHEDIR.TAG
            README.md
            v/
                cache/
                    lastfailed
                    nodeids
        config/
            asgi.py
            celery.py
            settings.py
            urls.py
            wsgi.py
            __init__.py
        registry/
            admin.py
            apps.py
            permissions.py
            serializers.py
            services.py
            signals.py
            structures.py
            tasks.py
            tests.py
            urls.py
            views.py
            __init__.py
            migrations/
                0001_initial.py
                0002_registryconfig_template_fields.py
                0003_trigger_trigram.py
                0004_registryconfig_public_list_fields.py
                0005_registryconfig_filter_fields.py
                0006_historicalsec1identification_structure_image_and_more.py
                0007_alter_chemicalelement_primary_name_ru_and_more.py
                __init__.py
            models/
                common.py
                core.py
                identification.py
                physical.py
                properties.py
                __init__.py
            templates/
                admin/
                    registry/
                        chemicalelement/
                            change_list.html
                        registryconfig/
                            custom_change_form.html
                registry/
                    passport_pdf.html
        support/
            admin.py
            apps.py
            models.py
            serializers.py
            tasks.py
            tests.py
            urls.py
            views.py
            __init__.py
            migrations/
                0001_initial.py
                0002_supportticket_contact_email_alter_supportticket_user.py
                __init__.py
        tests/
            conftest.py
            test_api.py
            test_api_complete.py
            test_registry_scenarios.py
            test_services.py
            test_signals.py
        users/
            admin.py
            apps.py
            models.py
            serializers.py
            tests.py
            urls.py
            views.py
            __init__.py
            migrations/
                0001_initial.py
                0002_remove_user_company_name_remove_user_inn_and_more.py
                0003_companyprofile_logo.py
                __init__.py
    frontend/
        .gitignore
        Dockerfile
        eslint.config.js
        index.html
        package.json
        README.md
        tsconfig.app.json
        tsconfig.json
        tsconfig.node.json
        vite.config.ts
        public/
            vite.svg
        src/
            App.tsx
            index.css
            main.tsx
            theme.ts
            api/
                auth.ts
                client.ts
                registry.ts
                support.ts
            assets/
                react.svg
            components/
                Layout/
                    DashboardLayout.tsx
            constants/
                formOptions.ts
            context/
                AuthContext.tsx
            hooks/
                useDebounce.ts
            pages/
                Auth/
                    LoginPage.tsx
                    RegisterPage.tsx
                Dashboard/
                    ElementPage.tsx
                    ImportPage.tsx
                    OrganizationPage.tsx
                    SubstancesList.tsx
                Public/
                    HomePage.tsx
                    LandingPage.tsx
                    PublicElementPage.styles.ts
                    PublicElementPage.tsx
                    StatisticsPage.tsx
                    StatisticsSection.tsx
                    components/
                        DataAtoms.tsx
                        ElementHeader.tsx
                        ElementSidebar.tsx
                        ElementTabs.tsx
                        FilterSidebar.tsx
                        PdfThumbnail.tsx
                        SupportFab.tsx
                        UI/
                            PropertyKit.tsx
                    utils/
                        formatters.ts
    Postman collection/
        ChemicalRegistry.postman_collection.json
        ChemicalRegistry.postman_environment.json

==================================================

==================================================
FILE: .\.env
==================================================
DB_NAME=chem_db
DB_USER=chem_user
DB_PASSWORD=chem_password
SECRET_KEY=super-secret-dev-key-123
BASE_URL=localhost

TELEGRAM_BOT_TOKEN=8543155516:AAFo6g8K2KkuzDjzAPM09mhKClKmil_sVtk
TELEGRAM_CHAT_ID=-5096950741

# === EMAIL (–ü—Ä–∏–º–µ—Ä –¥–ª—è Yandex) ===
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.yandex.ru
EMAIL_PORT=465
EMAIL_USE_SSL=True
EMAIL_HOST_USER=–≤–∞—à_–∞–¥—Ä–µ—Å@yandex.ru
EMAIL_HOST_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

# –ö—É–¥–∞ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –ø–∏—Å—å–º–æ —Å –∂–∞–ª–æ–±–æ–π?
SUPPORT_EMAIL=mvrinatovicso@gmail.com

==================================================
FILE: .\.env.example
==================================================
DB_NAME=chem_db
DB_USER=chem_user
DB_PASSWORD=change_me_please
SECRET_KEY=change_me_unsafe_key
DEBUG=1
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minio_weak_password
CELERY_BROKER_URL=amqp://guest:guest@rabbitmq:5672//

# TELEGRAM SETTINGS
# 1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather -> –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
TELEGRAM_BOT_TOKEN=123456789:AAHExxxxxxxxx_xxxxxxxxxxxx
# 2. –°–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É, –¥–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞ –±–æ—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-—Ç–æ, —É–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã (—á–µ—Ä–µ–∑ @getmyid_bot –∏–ª–∏ API)
# ID –≥—Ä—É–ø–ø—ã –æ–±—ã—á–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –º–∏–Ω—É—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä -100...)
TELEGRAM_CHAT_ID=-100123456789

==================================================
FILE: .\.gitignore
==================================================
# === –°–ò–°–¢–ï–ú–ù–´–ï –§–ê–ô–õ–´ ===
.DS_Store
Thumbs.db

# === –°–†–ï–î–´ IDE (Visual Studio Code, Pycharm) ===
.idea/
.vscode/
*.swp

# === PYTHON / DJANGO ===
*.pyc
*~
__pycache__/
venv/
env/
.pytest_cache/
htmlcov/
.coverage

# === –°–ï–ö–†–ï–¢–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò (–ö–†–ò–¢–ò–ß–ù–û –í–ê–ñ–ù–û!) ===
.env
backend/config/local_settings.py

# === –î–ê–ù–ù–´–ï (–ë–ê–ó–ê –ò –§–ê–ô–õ–´) ===
# –ú—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –∫–æ–º–º–∏—Ç–∏—Ç—å —Ç–æ–º–∞ Docker!
postgres_data/
minio_data/
media_data/
backend/media/
# –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –æ—Å—Ç–∞–≤–ª—è–µ–º .gitkeep, –µ—Å–ª–∏ –ø–∞–ø–∫–∞ –Ω—É–∂–Ω–∞ –ø—É—Å—Ç–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
!backend/media/.gitkeep

# === FRONTEND (NODE.JS) ===
frontend/node_modules/
frontend/dist/
frontend/.env.local
frontend/npm-debug.log*
frontend/yarn-debug.log*
frontend/yarn-error.log*

==================================================
FILE: .\docker-compose.yml
==================================================
services:
  # 1. –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö
  db:
    image: postgres:15-alpine
    restart: always
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      - POSTGRES_DB=${DB_NAME}
      - POSTGRES_USER=${DB_USER}
      - POSTGRES_PASSWORD=${DB_PASSWORD}
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${DB_USER} -d ${DB_NAME}"]
      interval: 10s
      timeout: 5s
      retries: 5

  # 2. –û—Å–Ω–æ–≤–Ω–æ–µ API (Django)
  api:
    build: ./backend
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä
    command: python manage.py runserver 0.0.0.0:8000
    volumes:
      - ./backend:/app
      # media_data –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –∫—ç—à, –Ω–æ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –≤ minio
      - media_data:/app/media
    ports:
      - "8000:8000"
    depends_on:
      db:
        condition: service_healthy
      rabbitmq:
        condition: service_started
      minio:
        condition: service_healthy
      # === –î–û–ë–ê–í–õ–ï–ù–ê –°–¢–†–û–ì–ê–Ø –ó–ê–í–ò–°–ò–ú–û–°–¢–¨ ===
#      tests:
#        condition: service_completed_successfully
    environment:
      - DB_NAME=${DB_NAME}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_HOST=db
      - SECRET_KEY=${SECRET_KEY}
      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Celery
      - CELERY_BROKER_URL=amqp://guest:guest@rabbitmq:5672//
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - TELEGRAM_CHAT_ID=${TELEGRAM_CHAT_ID}
      - SUPPORT_EMAIL=${SUPPORT_EMAIL}
      - EMAIL_HOST_USER=${EMAIL_HOST_USER}
      - EMAIL_HOST_PASSWORD=${EMAIL_HOST_PASSWORD}

  # 3. –§–æ–Ω–æ–≤—á–∏–∫ (Celery Worker) - –ù–û–í–´–ô –°–ï–†–í–ò–°
  # –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ –∫–æ–¥, —á—Ç–æ –∏ API, –Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–µ —Å–µ—Ä–≤–µ—Ä, –∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–¥–∞—á
  worker:
    build: ./backend
    command: celery -A config worker --loglevel=info
    volumes:
      - ./backend:/app
    depends_on:
      - db
      - rabbitmq
      - minio
    environment:
      - C_FORCE_ROOT=1
      - DB_NAME=${DB_NAME}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_HOST=db
      - SECRET_KEY=${SECRET_KEY}
      - CELERY_BROKER_URL=amqp://guest:guest@rabbitmq:5672//
      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AWS/MinIO –¥—É–±–ª–∏—Ä—É–µ–º, —Ç–∞–∫ –∫–∞–∫ –≤–æ—Ä–∫–µ—Ä —Ç–æ–∂–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã
      - AWS_ACCESS_KEY_ID=minioadmin
      - AWS_SECRET_ACCESS_KEY=minioadmin
      - AWS_STORAGE_BUCKET_NAME=chem-media
      - AWS_S3_ENDPOINT_URL=http://minio:9000
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - TELEGRAM_CHAT_ID=${TELEGRAM_CHAT_ID}

  # 4. –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (S3)
  minio:
    image: minio/minio:latest
    container_name: minio
    ports:
      - "9000:9000"   # API S3
      - "9001:9001"   # –ö–æ–Ω—Å–æ–ª—å –∞–¥–º–∏–Ω–∞
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin
      MINIO_API_CORS_ALLOW_ORIGIN: "*"
    command: server /data --console-address ":9001"
    volumes:
      - minio_data:/data
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]
      interval: 10s
      timeout: 5s
      retries: 5

  # 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–∞–∫–µ—Ç–∞
  # 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–∞–∫–µ—Ç–∞ (–ü–†–û–°–¢–ê–Ø –í–ï–†–°–ò–Ø)
  minio-init:
    image: minio/mc:latest
    depends_on:
      - minio
    entrypoint: >
      /bin/sh -c "
      echo 'Waiting for MinIO...' &&
      until mc alias set myminio http://minio:9000 minioadmin minioadmin; do
        echo '...MinIO is not ready, retrying in 2s...' && sleep 2;
      done &&
      mc mb myminio/chem-media --ignore-existing &&
      mc anonymous set download myminio/chem-media &&
      echo 'SUCCESS: Bucket created successfully!' &&
      exit 0;
      "
  redis:
    image: redis:alpine
    container_name: redis
    ports:
      - "6379:6379"

  # 6. –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
  rabbitmq:
    image: rabbitmq:3-management
    container_name: rabbitmq
    ports:
      - "5672:5672"   # –ü–æ—Ä—Ç –¥–ª—è Celery
      - "15672:15672" # –ê–¥–º–∏–Ω–∫–∞ RabbitMQ
    environment:
      RABBITMQ_DEFAULT_USER: guest
      RABBITMQ_DEFAULT_PASS: guest
    healthcheck:
      test: ["CMD", "rabbitmq-diagnostics", "-q", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5
  tests:
    build: ./backend
    command: pytest
    volumes:
      - ./backend:/app # –ß—Ç–æ–±—ã —Ç–µ—Å—Ç—ã –≤–∏–¥–µ–ª–∏ —Å–≤–µ–∂–∏–π –∫–æ–¥
    depends_on:
      db:
        condition: service_healthy
      redis:
        condition: service_started
    environment:
      - DB_NAME=${DB_NAME}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_HOST=db
      - SECRET_KEY=${SECRET_KEY}
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    volumes:
      - ./frontend:/app
      # –•–∞–∫, —á—Ç–æ–±—ã –ø–∞–ø–∫–∞ node_modules –Ω–µ –∑–∞—Ç–∏—Ä–∞–ª–∞—Å—å –ª–æ–∫–∞–ª—å–Ω–æ–π –ø—É—Å—Ç–æ–π –ø–∞–ø–∫–æ–π
      - /app/node_modules
    ports:
      - "5173:5173"
    environment:
      # –í–∞–∂–Ω–æ –¥–ª—è Windows –∏ WSL2, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–∞—Ö
      - CHOKIDAR_USEPOLLING=true
    depends_on:
      - api
volumes:
  postgres_data:
  media_data:
  minio_data:

==================================================
FILE: .\plan.docx
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\README.md
==================================================
# National Chemical Registry (–ù–†–û–•–í)

–°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–ø–∞—Å–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –†–£–∑.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Backend:** Django, DRF, Celery
- **Database:** PostgreSQL + pg_trgm (Search)
- **Files:** MinIO (S3)
- **Infrastructure:** Docker Compose

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone <—Å—Å—ã–ª–∫–∞>
   cd chem_project


–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env:
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ .env.example –≤ .env –∏ –∑–∞–¥–∞–π—Ç–µ —Å–≤–æ–∏ –ø–∞—Ä–æ–ª–∏.
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:
code
Bash
docker-compose up -d --build
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
code
Bash
docker-compose exec api python manage.py migrate
docker-compose exec api python manage.py createsuperuser
–î–æ—Å—Ç—É–ø—ã:
–°–∞–π—Ç API: http://localhost:8000
–ê–¥–º–∏–Ω–∫–∞: http://localhost:8000/admin
MinIO Console: http://localhost:9001
code
Code
---

### –®–ê–ì 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git –∏ –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ `docker-compose.yml`).

1.  **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
    ```bash
    git init
    ```

2.  **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è):**
    ```bash
    git add .
    ```
    *–ü–æ—Å–ª–µ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ (`git status`). –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–º –ù–ï–¢ –ø–∞–ø–æ–∫ `node_modules`, `postgres_data`, `venv`.*

3.  **–ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç:**
    ```bash
    git commit -m "Initial commit: Backend Ready (API, S3, Celery, Auth, Registry Logic)"
    ```

4.  **–°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–∫–∏ main:**
    ```bash
    git branch -M main
    ```

---

### –®–ê–ì 6. –ó–∞–ª–∏–≤–∫–∞ –Ω–∞ GitHub/GitLab

1.  –°–æ–∑–¥–∞–π—Ç–µ **–ø—É—Å—Ç–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** –Ω–∞ GitHub (–±–µ–∑ README, –±–µ–∑ .gitignore ‚Äî –æ–Ω–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å).
2.  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä `https://github.com/yourname/chem-registry.git`).
3.  –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å–≤—è–∂–∏—Ç–µ –≤–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π –≥–∏—Ç —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º:
    ```bash
    git remote add origin https://github.com/yourname/chem-registry.git
    ```
4.  –û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ:
    ```bash
    git push -u origin main
    ```

### –ò–¢–û–ì

–í–∞—à –ø—Ä–æ–µ–∫—Ç –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –≤—ã —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–µ—Ç–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –∏–ª–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–∞—Ö, –≤—ã –≤—Å–µ–≥–¥–∞ —Å–º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é **"–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π –±—ç–∫–µ–Ω–¥"**.

==================================================
FILE: .\backend\Dockerfile
==================================================
FROM python:3.10-slim

WORKDIR /app

ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Postgres –∏ —Å–±–æ—Ä–∫–∏
RUN apt-get update && apt-get install -y \
    gcc \
    libpq-dev \
    && rm -rf /var/lib/apt/lists/*

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN apt-get update && apt-get install -y \
    gcc \
    libpq-dev \
    # === –ù–û–í–û–ï: –ó–ê–í–ò–°–ò–ú–û–°–¢–ò –î–õ–Ø PDF ===
    python3-dev python3-pip python3-setuptools python3-wheel python3-cffi libcairo2 libpango-1.0-0 libpangocairo-1.0-0 libgdk-pixbuf-2.0-0 libffi-dev shared-mime-info \
    # ==================================
    && rm -rf /var/lib/apt/lists/*
# –°–Ω–∞—á–∞–ª–∞ –∫–æ–ø–∏—Ä—É–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–µ–≤ Docker)
COPY requirements.txt .
RUN pip install --upgrade pip && pip install -r requirements.txt

# –ö–æ–ø–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
COPY . .

# –ü–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
EXPOSE 8000

# –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é dev-—Ä–µ–∂–∏–º)
CMD ["python", "manage.py", "runserver", "0.0.0.0:8000"]

==================================================
FILE: .\backend\manage.py
==================================================
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()


==================================================
FILE: .\backend\pytest.ini
==================================================
[pytest]
DJANGO_SETTINGS_MODULE = config.settings
# –ò—â–µ–º —Ñ–∞–π–ª—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ test_
python_files = test_*.py *_tests.py
# –û—Ç–∫–ª—é—á–∞–µ–º –≤–æ—Ä–Ω–∏–Ω–≥–∏, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞–ª–∏
filterwarnings =
    ignore::DeprecationWarning

==================================================
FILE: .\backend\requirements.txt
==================================================
Django>=4.2,<5.0
psycopg2-binary        # –î—Ä–∞–π–≤–µ—Ä PostgreSQL
djangorestframework    # API
django-cors-headers    # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç—É–ø—ã
drf-yasg               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger (–±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ)
pandas                 # –î–ª—è –±—É–¥—É—â–µ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ Excel
openpyxl               # –î—Ä–∞–π–≤–µ—Ä Excel
gunicorn               # –°–µ—Ä–≤–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
django-jazzmin
djangorestframework_simplejwt
django-filter
WeasyPrint>=59.0
django-weasyprint
django-simple-history
django-storages
boto3
celery
django-redis              # –î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
django-modeltranslation   # –î–ª—è —è–∑—ã–∫–æ–≤
django-constance[database] # –î–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è)
django-picklefield               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è constance
celery-progress           # (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)
Pillow

pytest
pytest-django
pytest-pythonpath
model-bakery
requests

==================================================
FILE: .\backend\.pytest_cache\.gitignore
==================================================
# Created by pytest automatically.
*


==================================================
FILE: .\backend\.pytest_cache\CACHEDIR.TAG
==================================================
Signature: 8a477f597d28d172789f06886806bc55
# This file is a cache directory tag created by pytest.
# For information about cache directory tags, see:
#	https://bford.info/cachedir/spec.html


==================================================
FILE: .\backend\.pytest_cache\README.md
==================================================
# pytest cache directory #

This directory contains data from the pytest's cache plugin,
which provides the `--lf` and `--ff` options, as well as the `cache` fixture.

**Do not** commit this to version control.

See [the docs](https://docs.pytest.org/en/stable/how-to/cache.html) for more information.


==================================================
FILE: .\backend\.pytest_cache\v\cache\lastfailed
==================================================
{
  "tests/test_api.py::TestRegistryAPI::test_create_full_structure": true,
  "tests/test_api_complete.py::TestRegistryCRUD::test_create_element_manual": true
}

==================================================
FILE: .\backend\.pytest_cache\v\cache\nodeids
==================================================
[
  "tests/test_api.py::TestRegistryAPI::test_create_full_structure",
  "tests/test_api.py::TestRegistryAPI::test_n_plus_one_problem",
  "tests/test_api.py::TestRegistryAPI::test_permissions_isolation",
  "tests/test_api_complete.py::TestAdminActions::test_admin_set_status",
  "tests/test_api_complete.py::TestAdminActions::test_pdf_generation",
  "tests/test_api_complete.py::TestAdminActions::test_smart_search",
  "tests/test_api_complete.py::TestAdminActions::test_statistics",
  "tests/test_api_complete.py::TestAuthAPI::test_login_and_me",
  "tests/test_api_complete.py::TestAuthAPI::test_registration",
  "tests/test_api_complete.py::TestRegistryCRUD::test_create_element_manual",
  "tests/test_api_complete.py::TestRegistryCRUD::test_delete_permission",
  "tests/test_api_complete.py::TestRegistryCRUD::test_update_element",
  "tests/test_registry_scenarios.py::TestRegistryWorkFlow::test_excel_import_full_cycle",
  "tests/test_registry_scenarios.py::TestRegistryWorkFlow::test_validation_config",
  "tests/test_registry_scenarios.py::TestRegistryWorkFlow::test_visibility_b2b",
  "tests/test_services.py::TestExcelImportService::test_import_clean_headers",
  "tests/test_services.py::TestExcelImportService::test_import_validation_error",
  "tests/test_signals.py::TestSignalsAndTasks::test_email_task_execution",
  "tests/test_signals.py::TestSignalsAndTasks::test_signal_queues_email_on_publish"
]

==================================================
FILE: .\backend\config\asgi.py
==================================================
"""
ASGI config for config project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

application = get_asgi_application()


==================================================
FILE: .\backend\config\celery.py
==================================================
import os
from celery import Celery

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Django –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

app = Celery('config')

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ settings.py, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å CELERY_
app.config_from_object('django.conf:settings', namespace='CELERY')

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–¥–∞—á–∏ –≤ —Ñ–∞–π–ª–∞—Ö tasks.py –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
app.autodiscover_tasks()

==================================================
FILE: .\backend\config\settings.py
==================================================
from pathlib import Path
import os
from datetime import timedelta
import sys

if 'pytest' in sys.modules or 'test' in sys.argv:
    CELERY_TASK_ALWAYS_EAGER = True
    CELERY_TASK_EAGER_PROPAGATES = True
    CELERY_TASK_STORE_EAGER_RESULT = True

    # –ù–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)
    STORAGES = {
        "default": {
            "BACKEND": "django.core.files.storage.FileSystemStorage",
        },
        "staticfiles": {
            "BACKEND": "django.contrib.staticfiles.storage.StaticFilesStorage",
        },
    }
    MEDIA_ROOT = '/tmp/django_test_media'
# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/4.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-a3zad5iz)-pjdkg*=dt_&ovu9ul&+tu#p1$i8w_x%v2y!d4*z('

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
   # –ê–¥–º–∏–Ω–∫–∞ –∏ –±–∞–∑–æ–≤—ã–µ Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    'jazzmin',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.postgres',

    'simple_history',               # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–æ–¥–µ–ª–µ–π
    'rest_framework',               # DRF
    'rest_framework_simplejwt',     # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    'corsheaders',                  # CORS
    'drf_yasg',                     # Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    'django_filters',               # –§–∏–ª—å—Ç—Ä—ã –¥–ª—è DRF
    'storages',                     # –†–∞–±–æ—Ç–∞ —Å S3/MinIO

    # –ù–∞—à–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    'users',
    'registry',
    'constance',
    'constance.backends.database',
    'support',
]
EMAIL_BACKEND = os.environ.get('EMAIL_BACKEND',
    'django.core.mail.backends.console.EmailBackend' if DEBUG else 'django.core.mail.backends.smtp.EmailBackend'
)

EMAIL_HOST = os.environ.get('EMAIL_HOST', 'smtp.gmail.com')
EMAIL_PORT = int(os.environ.get('EMAIL_PORT', 587))
EMAIL_USE_TLS = os.environ.get('EMAIL_USE_TLS', 'True') == 'True'
EMAIL_USE_SSL = os.environ.get('EMAIL_USE_SSL', 'False') == 'True'
EMAIL_HOST_USER = os.environ.get('EMAIL_HOST_USER', '')
EMAIL_HOST_PASSWORD = os.environ.get('EMAIL_HOST_PASSWORD', '')

# –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏
SUPPORT_EMAIL = os.environ.get('SUPPORT_EMAIL', EMAIL_HOST_USER)

# === TELEGRAM SETTINGS ===
TELEGRAM_BOT_TOKEN = os.environ.get('TELEGRAM_BOT_TOKEN')
TELEGRAM_CHAT_ID = os.environ.get('TELEGRAM_CHAT_ID')

CONSTANCE_BACKEND = 'constance.backends.database.DatabaseBackend'

CONSTANCE_CONFIG = {
    'REQUIRED_FIELDS': ('primary_name_ru,cas_number', '–°–ø–∏—Å–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (API/–ò–º–ø–æ—Ä—Ç)'),
    'BLOCK_DRAFTS_WITHOUT_MANDATORY': (True, '–ó–∞–ø—Ä–µ—Ç–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫–∏ –±–µ–∑ —ç—Ç–∏—Ö –ø–æ–ª–µ–π?'),
}

REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ),
    # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticatedOrReadOnly',
    ],
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 20, # –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
}

SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(days=1), # –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - 1 –¥–µ–Ω—å
    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),
}

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
    'simple_history.middleware.HistoryRequestMiddleware',
]

ROOT_URLCONF = 'config.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'config.wsgi.application'


# Database
# https://docs.djangoproject.com/en/4.2/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': os.environ.get('DB_NAME'),
        'USER': os.environ.get('DB_USER'),
        'PASSWORD': os.environ.get('DB_PASSWORD'),
        'HOST': os.environ.get('DB_HOST'),
        'PORT': '5432',
    }
}


# Password validation
# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/4.2/topics/i18n/

LANGUAGE_CODE = 'ru'


TIME_ZONE = 'Asia/Tashkent'

USE_I18N = True
USE_L10N = True # (–ï—Å–ª–∏ –µ—Å—Ç—å, –æ—Å—Ç–∞–≤—å—Ç–µ)
USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/4.2/howto/static-files/

STATIC_URL = 'static/'

# Default primary key field type
# https://docs.djangoproject.com/en/4.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
AUTH_USER_MODEL = 'users.User'

ALLOWED_HOSTS = ['*']  # –†–∞–∑—Ä–µ—à–∞–µ–º –¥–æ—Å—Ç—É–ø –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
CORS_ALLOW_ALL_ORIGINS = True  # –ß—Ç–æ–±—ã API –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º

# URL, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä /media/doc.pdf)
# MEDIA_URL = '/media/'

# –§–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–ø–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –≥–¥–µ –ª–µ–∂–∞—Ç —Ñ–∞–π–ª—ã
# MEDIA_ROOT = os.path.join(BASE_DIR, 'media')

JAZZMIN_SETTINGS = {
    # –ó–∞–≥–æ–ª–æ–≤–∫–∏
    "site_title": "–†–µ–µ—Å—Ç—Ä –û–•–í",
    "site_header": "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –†–µ–µ—Å—Ç—Ä",
    "site_brand": "ChemRegistry",
    "welcome_sign": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –†–µ–µ—Å—Ç—Ä–æ–º",
    "copyright": "Chemical Registry Ltd",

    # –õ–æ–≥–æ—Ç–∏–ø (–º–æ–∂–Ω–æ –ø–æ—Ç–æ–º –ø–æ–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª –≤ —Å—Ç–∞—Ç–∏–∫—É, –ø–æ–∫–∞ —Ç–µ–∫—Å—Ç–æ–º)
    # "site_logo": "img/logo.png",

    # –ú–µ–Ω—é
    "search_model": "registry.ChemicalElement",  # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º

    # –¢–æ–ø-–º–µ–Ω—é
    "topmenu_links": [
        {"name": "–ì–ª–∞–≤–Ω–∞—è",  "url": "admin:index", "permissions": ["auth.view_user"]},
        {"name": "–û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç", "url": "/"},
    ],

    # –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é
    "show_sidebar": True,
    "navigation_expanded": True,

    # –ò–∫–æ–Ω–∫–∏ –¥–ª—è –º–µ–Ω—é (–∏—Å–ø–æ–ª—å–∑—É–µ–º FontAwesome)
    "icons": {
        "auth": "fas fa-users-cog",
        "users.User": "fas fa-user",
        "registry.ChemicalElement": "fas fa-flask",        # –ò–∫–æ–Ω–∫–∞ –∫–æ–ª–±—ã
        "registry.ElementAttachment": "fas fa-file-pdf",   # –ò–∫–æ–Ω–∫–∞ —Ñ–∞–π–ª–∞
        # –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∫—Ä—ã—Ç–∏–µ –∏–ª–∏ –∏–∫–æ–Ω–∫–∏
    },

    # –ü–æ—Ä—è–¥–æ–∫ –º–µ–Ω—é
    "order_with_respect_to": ["registry", "users", "auth"],
}

JAZZMIN_UI_TWEAKS = {
    "theme": "flatly",        # –¢–µ–º–∞: —Å–≤–µ—Ç–ª–∞—è, —Å—Ç—Ä–æ–≥–∞—è, –Ω–∞—É—á–Ω–∞—è (–≤–∞—Ä–∏–∞–Ω—Ç—ã: darkly, simplex, cerulean)
    "navbar": "navbar-dark",  # –¢–µ–º–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å
}

SWAGGER_SETTINGS = {
    'SECURITY_DEFINITIONS': {
        'Bearer': {
            'type': 'apiKey',
            'name': 'Authorization',
            'in': 'header'
        }
    },
    'USE_SESSION_AUTH': False,
    'JSON_EDITOR': True,
    'SUPPORT_GENERATED_MEDIA_TYPES': True,
}

# –û—Ç–∫–ª—é—á–∞–µ–º –ø–æ–∫–∞–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Django-—Å–µ—Å—Å–∏–∏ (–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–∫–µ–Ω—ã)
LOGIN_URL = 'rest_framework:login'
LOGOUT_URL = 'rest_framework:logout'

# EMAIL SETTINGS
EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'
EMAIL_HOST_USER = 'no-reply@chem-registry.uz'


# === S3 SETTINGS (MINIO) ===

AWS_ACCESS_KEY_ID = 'minioadmin'
AWS_SECRET_ACCESS_KEY = 'minioadmin'
AWS_STORAGE_BUCKET_NAME = 'chem-media'
AWS_S3_ENDPOINT_URL = 'http://minio:9000'
AWS_S3_REGION_NAME = 'us-east-1'

# 1. –ó–∞–¥–∞–µ–º –¥–æ–º–µ–Ω (–±–µ–∑ http/https –≤ –Ω–∞—á–∞–ª–µ)
AWS_S3_CUSTOM_DOMAIN = 'localhost:9000/chem-media'

# 2. –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –í–ö–õ–Æ–ß–ê–ï–ú HTTP (–ë–ï–ó SSL)
AWS_S3_USE_SSL = False       # –û—Ç–∫–ª—é—á–∞–µ–º SSL –¥–ª—è boto3
AWS_S3_URL_PROTOCOL = 'http:' # –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è —Å—Å—ã–ª–æ–∫

# 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è "–ø—Ä—è–º—ã—Ö" —Å—Å—ã–ª–æ–∫
AWS_QUERYSTRING_AUTH = False
AWS_S3_FILE_OVERWRITE = False

# –ï—Å–ª–∏ –º—ã –ù–ï –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Å—Ç–æ–≤ (pytest –Ω–µ –∑–∞–ø—É—â–µ–Ω)
if 'pytest' not in sys.modules and 'test' not in sys.argv:
    STORAGES = {
        "default": {
            "BACKEND": "storages.backends.s3boto3.S3Boto3Storage",
        },
        "staticfiles": {
            "BACKEND": "django.contrib.staticfiles.storage.StaticFilesStorage",
        },
    }

MEDIA_URL = 'http://localhost:9000/chem-media/'

# === CACHE (REDIS) ===
CACHES = {
    "default": {
        "BACKEND": "django_redis.cache.RedisCache",
        "LOCATION": "redis://redis:6379/1",
        "OPTIONS": {
            "CLIENT_CLASS": "django_redis.client.DefaultClient",
        }
    }
}

# === CELERY SETTINGS UPDATE ===
# –ë—Ä–æ–∫–µ—Ä (–û—á–µ—Ä–µ–¥—å) - RabbitMQ
CELERY_BROKER_URL = 'amqp://guest:guest@rabbitmq:5672//'
# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã (Result Backend) - Redis (—Ö—Ä–∞–Ω–∏–º 1 –¥–µ–Ω—å)
CELERY_RESULT_BACKEND = 'redis://redis:6379/0'
CELERY_RESULT_EXPIRES = 86400

==================================================
FILE: .\backend\config\urls.py
==================================================
from django.contrib import admin
from django.urls import path, include, re_path
from django.conf import settings
from django.conf.urls.static import static
from rest_framework_simplejwt.views import (
    TokenObtainPairView,
    TokenRefreshView,
)
from rest_framework import permissions
from drf_yasg.views import get_schema_view
from drf_yasg import openapi


# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∞—à–µ–º API
schema_view = get_schema_view(
   openapi.Info(
      title="Chemical Registry API",
      default_version='v1',
      description="API –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞ —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –†–£–∑.\n"
                  "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É 'Authorize' -> –≤–≤–µ–¥–∏—Ç–µ 'Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>'",
      terms_of_service="https://www.google.com/policies/terms/",
      contact=openapi.Contact(email="contact@chem-registry.uz"),
      license=openapi.License(name="Private License"),
   ),
   public=True,
   permission_classes=[permissions.AllowAny], # –û—Ç–∫—Ä—ã—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è (–Ω–æ –º–µ—Ç–æ–¥—ã –≤–Ω—É—Ç—Ä–∏ –∑–∞—â–∏—â–µ–Ω—ã)
)




urlpatterns = [
    path('admin/', admin.site.urls),
    # –í–∞—à–∏ API URL-—ã —Ç—É—Ç, –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–∏
    path('api/registry/', include('registry.urls')),

    # ...
    path('api/auth/', include('users.urls')), # <--- –ù–û–í–ê–Ø –°–¢–†–û–ö–ê
    path('api/token/', TokenObtainPairView.as_view()),
    # ...

    # === –î–û–ë–ê–í–õ–Ø–ï–ú –≠–¢–ò –î–í–ï –°–¢–†–û–ö–ò ===
    path('api/token/', TokenObtainPairView.as_view(), name='token_obtain_pair'), # –õ–æ–≥–∏–Ω
    path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),

    # 4. –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø
    # –°–≤–∞–≥–≥–µ—Ä (JSON)
    re_path(r'^swagger(?P<format>\.json|\.yaml)$', schema_view.without_ui(cache_timeout=0), name='schema-json'),
    # –°–≤–∞–≥–≥–µ—Ä (UI - –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
    re_path(r'^swagger/$', schema_view.with_ui('swagger', cache_timeout=0), name='schema-swagger-ui'),
    # Redoc (–ê–Ω–∞–ª–æ–≥ - —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è)
    re_path(r'^redoc/$', schema_view.with_ui('redoc', cache_timeout=0), name='schema-redoc'),

    # Your app URLs...
    path('api-auth/', include('rest_framework.urls', namespace='rest_framework')),
    path('api/support/', include('support.urls')),
]

# –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏, —Ä–∞–∑–¥–∞–µ–º –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)

==================================================
FILE: .\backend\config\wsgi.py
==================================================
"""
WSGI config for config project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

application = get_wsgi_application()


==================================================
FILE: .\backend\config\__init__.py
==================================================
from .celery import app as celery_app

__all__ = ('celery_app',)

==================================================
FILE: .\backend\registry\admin.py
==================================================
from django.contrib import admin
from django import forms
from django.utils.html import format_html
from django.utils.safestring import mark_safe
from simple_history.admin import SimpleHistoryAdmin
from .models import *
from .structures import SECTION_MAP

# =========================================================
# 1. –ï–î–ò–ù–´–ô –í–ò–î–ñ–ï–¢ (–ú–ê–¢–†–ò–¶–ê –ù–ê–°–¢–†–û–ï–ö)
# =========================================================
class MatrixConfigWidget(forms.Widget):
    def __init__(self, attrs=None, data_source=None):
        super().__init__(attrs)
        self.data_source = data_source or {}

    def render(self, name, value, attrs=None, renderer=None):
        # –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        curr_req = self.data_source.get('required', []) or []
        curr_vis = self.data_source.get('template', []) or []
        curr_pub = self.data_source.get('public', []) or []
        curr_flt = self.data_source.get('filters', []) or [] # <--- –ù–û–í–û–ï: –§–∏–ª—å—Ç—Ä—ã

        html = [
            '<div class="matrix-wrapper">',
            '<table class="matrix-table" style="width:100%; border-collapse: collapse;">',
            '<thead>',
            '<tr>',
                '<th class="th-name" style="text-align:left; width:28%; padding:12px; background:#2c3e50; color:white;">–ü–∞—Ä–∞–º–µ—Ç—Ä / –ü–æ–ª–µ</th>',
                '<th class="th-check" style="width:18%; background:#ffe6e6; color:black; border:1px solid #ddd;">–°—Ç—Ä–æ–≥–æ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</th>',
                '<th class="th-check" style="width:18%; background:#e6f2ff; color:black; border:1px solid #ddd;">–í Excel –®–∞–±–ª–æ–Ω–µ</th>',
                '<th class="th-check" style="width:18%; background:#e6fffa; color:black; border:1px solid #ddd;">–ü—É–±–ª–∏—á–Ω–∞—è –¢–∞–±–ª–∏—Ü–∞</th>',
                # –ù–û–í–ê–Ø –ö–û–õ–û–ù–ö–ê
                '<th class="th-check" style="width:18%; background:#fff9db; color:black; border:1px solid #ddd;">–§–∏–ª—å—Ç—Ä (–°–∞–π–¥–±–∞—Ä)</th>',
            '</tr>',
            '</thead>',
            '<tbody>'
        ]

        for section_name, _, _, fields_list in SECTION_MAP:
            # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –°–µ–∫—Ü–∏–∏
            html.append(f'''
                <tr class="section-row">
                    <td colspan="5" style="background:#34495e; color:white; font-weight:bold; padding:8px 12px;">{section_name}</td>
                </tr>
            ''')

            for excel_name, db_name, is_sys_req in fields_list:
                # 1. REQUIRED (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                if is_sys_req:
                    req_input = f'''
                        <input type="checkbox" checked disabled>
                        <input type="hidden" name="custom_req" value="{db_name}">
                        <br><small style="color:red; font-weight:bold">SYSTEM</small>
                    '''
                else:
                    is_chk = "checked" if db_name in curr_req else ""
                    req_input = f'<input type="checkbox" name="custom_req" value="{db_name}" {is_chk} class="big-chk">'

                # 2. TEMPLATE (Excel)
                if is_sys_req:
                    vis_input = f'''
                        <input type="checkbox" checked disabled>
                        <input type="hidden" name="custom_vis" value="{db_name}">
                    '''
                else:
                    is_chk = "checked" if db_name in curr_vis else ""
                    vis_input = f'<input type="checkbox" name="custom_vis" value="{db_name}" {is_chk} class="big-chk">'

                # 3. PUBLIC (–¢–∞–±–ª–∏—Ü–∞)
                if is_sys_req:
                    pub_input = f'''
                        <input type="checkbox" checked disabled>
                        <input type="hidden" name="custom_pub" value="{db_name}">
                    '''
                else:
                    is_chk = "checked" if db_name in curr_pub else ""
                    pub_input = f'<input type="checkbox" name="custom_pub" value="{db_name}" {is_chk} class="big-chk">'

                # 4. FILTERS (–§–∏–ª—å—Ç—Ä—ã) - –ù–û–í–û–ï
                # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è (–ù–∞–∑–≤–∞–Ω–∏–µ, CAS) –æ–±—ã—á–Ω–æ –∏—â—É—Ç –ø–æ–∏—Å–∫–æ–º, –∞ –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–º, –Ω–æ —Ä–∞–∑—Ä–µ—à–∏–º –≤—Å—ë.
                is_chk = "checked" if db_name in curr_flt else ""
                flt_input = f'<input type="checkbox" name="custom_flt" value="{db_name}" {is_chk} class="big-chk">'

                # –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫–∏
                html.append(f'''
                <tr class="item-row" style="border-bottom:1px solid #eee;">
                    <td class="col-name" style="padding:8px; border-right:1px solid #eee;">
                        <div style="font-weight:500; font-size:13px;">{excel_name}</div>
                        <div style="font-size:10px; color:#999;">code: {db_name}</div>
                    </td>

                    <td class="col-check" style="background:#fff0f0; text-align:center; vertical-align:middle; border-right:1px solid #eee;">
                        {req_input}
                    </td>

                    <td class="col-check" style="background:#f0f8ff; text-align:center; vertical-align:middle; border-right:1px solid #eee;">
                        {vis_input}
                    </td>

                    <td class="col-check" style="background:#f0fff4; text-align:center; vertical-align:middle; border-right:1px solid #eee;">
                        {pub_input}
                    </td>

                    <td class="col-check" style="background:#fff9db; text-align:center; vertical-align:middle;">
                        {flt_input}
                    </td>
                </tr>
                ''')

        html.append('</tbody></table></div>')
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–º–Ω–æ–≥–æ CSS –ø—Ä—è–º–æ –∑–¥–µ—Å—å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
        html.append('''
            <style>
                .big-chk { transform: scale(1.5); cursor: pointer; }
                .matrix-table th, .matrix-table td { border-color: #e0e0e0; }
                .item-row:hover td { background-color: #f9f9f9 !important; }
            </style>
        ''')
        return mark_safe("".join(html))

# =========================================================
# 2. –§–û–†–ú–ê
# =========================================================
class RegistryConfigForm(forms.ModelForm):
    # –§–∏–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤–∏–¥–∂–µ—Ç–∞
    config_matrix = forms.CharField(required=False, label="")

    class Meta:
        model = RegistryConfig
        fields = '__all__'

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        # 1. –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        data = {
            'required': [],
            'template': [],
            'public': [],
            'filters': [] # <---
        }

        if self.instance and self.instance.pk:
            data['required'] = self.instance.required_fields or []
            data['template'] = self.instance.template_fields or []
            data['public'] = self.instance.public_list_fields or []
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ç—Ä–∏–±—É—Ç, —Ç.–∫. –æ–Ω –Ω–æ–≤—ã–π –∏ –º–æ–∂–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å—Ç–∞—Ä—ã—Ö –º–∏–≥—Ä–∞—Ü–∏—è—Ö –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
            data['filters'] = getattr(self.instance, 'filter_fields', []) or []

        # 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –í–∏–¥–∂–µ—Ç
        self.fields['config_matrix'].widget = MatrixConfigWidget(data_source=data)

    def save(self, commit=True):
        instance = super().save(commit=False)

        # 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ POST
        if self.data:
            r_list = self.data.getlist('custom_req')
            v_list = self.data.getlist('custom_vis')
            p_list = self.data.getlist('custom_pub')
            f_list = self.data.getlist('custom_flt') # <---

            # –°—Ç—Ä–∞—Ö–æ–≤–∫–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–æ–ª–µ–π
            for _, _, _, fields_list in SECTION_MAP:
                for _, db_name, is_sys in fields_list:
                    if is_sys:
                        if db_name not in r_list: r_list.append(db_name)
                        if db_name not in v_list: v_list.append(db_name)
                        if db_name not in p_list: p_list.append(db_name)

            instance.required_fields = r_list
            instance.template_fields = v_list
            instance.public_list_fields = p_list
            instance.filter_fields = f_list # <---

        if commit:
            instance.save()
        return instance

# =========================================================
# 3. –ê–î–ú–ò–ù–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò
# =========================================================
@admin.register(RegistryConfig)
class RegistryConfigAdmin(admin.ModelAdmin):
    form = RegistryConfigForm
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —à–∞–±–ª–æ–Ω –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
    change_form_template = 'admin/registry/registryconfig/custom_change_form.html'
    save_on_top = True

    fieldsets = (
        (None, {'classes': ('wide',), 'fields': ('config_matrix',)}),
    )

    def has_add_permission(self, request):
        # Singleton: –∑–∞–ø—Ä–µ—â–∞–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å, –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –∑–∞–ø–∏—Å—å
        return not RegistryConfig.objects.exists()

    def has_delete_permission(self, request, obj=None):
        return False

# =========================================================
# 4. –ê–î–ú–ò–ù–ö–ê –≠–õ–ï–ú–ï–ù–¢–û–í (–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è)
# =========================================================
class AttachmentsInline(admin.TabularInline):
    model = ElementAttachment
    extra = 1
    verbose_name_plural = "üìÇ –î–û–ö–£–ú–ï–ù–¢–´"
    fields = ('file_preview', 'file', 'doc_type', 'description', 'uploaded_at')
    readonly_fields = ('file_preview', 'uploaded_at')
    def file_preview(self, obj): return format_html('<a href="{}" target="_blank">üìÑ</a>', obj.file.url) if obj.file else "-"

def create_inline(model_class, title):
    class Inline(admin.StackedInline):
        model = model_class
        verbose_name_plural = title
        extra = 1; max_num = 1
    return Inline

@admin.register(ChemicalElement)
class ChemicalElementAdmin(SimpleHistoryAdmin):
    list_display = ('primary_name_ru', 'cas_number', 'status_badge', 'updated_at')
    search_fields = ('primary_name_ru', 'cas_number')
    list_filter = (
        'status',
        'created_at',
        'sec11_class__sanpin_class', # –§–∏–ª—å—Ç—Ä –ø–æ –∫–ª–∞—Å—Å—É –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        'sec2_physical__appearance', # –§–∏–ª—å—Ç—Ä –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é
    )
    save_on_top = True
    inlines = [create_inline(Sec1Identification, 'I. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è'), AttachmentsInline]

    from .models import Sec2Physical, Sec3ToxSanPin, Sec4ToxAir, Sec5ToxAcute, Sec6ToxRisks, Sec8EcoTox, Sec9Soil, Sec10Water, Sec11HazardClass, Sec12GHSClass, Sec13GHSLabel, Sec14Safety, Sec15Storage, Sec16Waste, Sec17Incidents, Sec18InternationalReg, Sec20Docs, Sec21Companies, Sec22Volumes, Sec23Extra

    section_models = [Sec2Physical, Sec3ToxSanPin, Sec4ToxAir, Sec5ToxAcute, Sec6ToxRisks, Sec8EcoTox, Sec9Soil, Sec10Water, Sec11HazardClass, Sec12GHSClass, Sec13GHSLabel, Sec14Safety, Sec15Storage, Sec16Waste, Sec17Incidents, Sec18InternationalReg, Sec20Docs, Sec21Companies, Sec22Volumes, Sec23Extra]
    for m in section_models:
        inlines.append(create_inline(m, m._meta.verbose_name))

    def save_model(self, request, obj, form, change):
        if not obj.pk and not obj.created_by_id: obj.created_by = request.user
        super().save_model(request, obj, form, change)

    def status_badge(self, obj): return obj.get_status_display()

==================================================
FILE: .\backend\registry\apps.py
==================================================
from django.apps import AppConfig

class RegistryConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'registry'

    # --- –í–û–¢ –≠–¢–û–ì–û –ú–ï–¢–û–î–ê –°–ö–û–†–ï–ï –í–°–ï–ì–û –ù–ï–¢ –ò–õ–ò –û–ù –ù–ï–ü–û–õ–ù–´–ô ---
    def ready(self):
        try:
            import registry.signals  # <--- –í–ê–ñ–ù–ï–ô–®–ê–Ø –°–¢–†–û–ö–ê
            print("--- Signals Loaded Successfully ---") # –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤ –ª–æ–≥–∞—Ö
        except ImportError:
            pass

==================================================
FILE: .\backend\registry\permissions.py
==================================================
from rest_framework import permissions

class IsOwnerOrReadOnly(permissions.BasePermission):
    """
    –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞:
    1. –ê–≤—Ç–æ—Ä—É (created_by)
    2. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º (is_staff)
    –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ.
    """
    def has_object_permission(self, request, view, obj):
            # –ß—Ç–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –≤—Å–µ–º (–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã: GET, HEAD, OPTIONS)
            if request.method in permissions.SAFE_METHODS:
                return True

            # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ª–∏–±–æ –≤–ª–∞–¥–µ–ª–µ—Ü, –ª–∏–±–æ –∞–¥–º–∏–Ω
            return (obj.created_by == request.user) or request.user.is_staff

class IsControllerOrAdmin(permissions.BasePermission):
    """
    –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –ê–¥–º–∏–Ω–æ–≤ –∏ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∏—Ö –æ—Ä–≥–∞–Ω–æ–≤
    """
    def has_permission(self, request, view):
        user = request.user
        return user.is_authenticated and (user.is_staff or user.role in ['ADMIN', 'CONTROLLER'])

==================================================
FILE: .\backend\registry\serializers.py
==================================================
from rest_framework import serializers
from .models import *

# ========================================================
# 1. –°–ï–†–ò–ê–õ–ê–ô–ó–ï–† –î–õ–Ø –§–ê–ô–õ–û–í
# ========================================================

class Sec1Serializer(serializers.ModelSerializer):
    class Meta:
        model = Sec1Identification
        fields = '__all__'
        extra_kwargs = {
            'element': {'read_only': True},
            'structure_image': {'read_only': True}  # <--- –í–û–¢ –≠–¢–û –ò–°–ü–†–ê–í–õ–Ø–ï–¢ –û–®–ò–ë–ö–£ 400
        }

class ElementAttachmentSerializer(serializers.ModelSerializer):
    class Meta:
        model = ElementAttachment
        fields = ['id', 'file', 'description', 'doc_type', 'uploaded_at']

# ========================================================
# 2. –°–ï–†–ò–ê–õ–ê–ô–ó–ï–†–´ –°–ï–ö–¶–ò–ô (–§–∞–±—Ä–∏–∫–∞ –∫–ª–∞—Å—Å–æ–≤)
# ========================================================
def create_sec_serializer(model_class):
    exclude_fields = ['element', 'id']
    try:
        model_class._meta.get_field('history')
        exclude_fields.append('history')
    except:
        pass

    class Meta:
        model = model_class
        exclude = tuple(exclude_fields)

    return type(f"{model_class.__name__}Serializer", (serializers.ModelSerializer,), {'Meta': Meta})

try:
    # Sec1Serializer = create_sec_serializer(Sec1Identification) <--- –≠–¢–£ –°–¢–†–û–ö–£ –£–î–ê–õ–ò–¢–¨ –ò–õ–ò –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–¢–¨
    Sec2Serializer = create_sec_serializer(Sec2Physical)
    Sec3Serializer = create_sec_serializer(Sec3ToxSanPin)
    Sec4Serializer = create_sec_serializer(Sec4ToxAir)
    Sec5Serializer = create_sec_serializer(Sec5ToxAcute)
    Sec6Serializer = create_sec_serializer(Sec6ToxRisks)
    Sec8Serializer = create_sec_serializer(Sec8EcoTox)
    Sec9Serializer = create_sec_serializer(Sec9Soil)
    Sec10Serializer = create_sec_serializer(Sec10Water)
    Sec11Serializer = create_sec_serializer(Sec11HazardClass)
    Sec12Serializer = create_sec_serializer(Sec12GHSClass)
    Sec13Serializer = create_sec_serializer(Sec13GHSLabel)
    Sec14Serializer = create_sec_serializer(Sec14Safety)
    Sec15Serializer = create_sec_serializer(Sec15Storage)
    Sec16Serializer = create_sec_serializer(Sec16Waste)
    Sec17Serializer = create_sec_serializer(Sec17Incidents)
    Sec18Serializer = create_sec_serializer(Sec18InternationalReg)
    Sec20Serializer = create_sec_serializer(Sec20Docs)
    Sec21Serializer = create_sec_serializer(Sec21Companies)
    Sec22Serializer = create_sec_serializer(Sec22Volumes)
    Sec23Serializer = create_sec_serializer(Sec23Extra)
except NameError as e:
    print(f"CRITICAL ERROR in serializers.py: {e}")

# ========================================================
# 3. –°–ü–ò–°–û–ö (List View)
# ========================================================
class ChemicalElementListSerializer(serializers.ModelSerializer):
    hazard_class = serializers.CharField(source='sec11_class.get_sanpin_class_display', read_only=True)
    author_name = serializers.SerializerMethodField()

    def get_author_name(self, obj):
        if not obj.created_by:
            return "–°–∏—Å—Ç–µ–º–∞"
        if hasattr(obj.created_by, 'company_profile'):
             return obj.created_by.company_profile.company_name
        return obj.created_by.username

    class Meta:
        model = ChemicalElement
        fields = ('id', 'cas_number', 'primary_name_ru', 'status', 'updated_at', 'hazard_class', 'author_name')

# ========================================================
# 4. –î–ï–¢–ê–õ–ò (Create/Update View)
# ========================================================
class ChemicalElementDetailSerializer(serializers.ModelSerializer):
    sec1_identification = Sec1Serializer(required=False)
    sec2_physical = Sec2Serializer(required=False)
    sec3_sanpin = Sec3Serializer(required=False)
    sec4_air = Sec4Serializer(required=False)
    sec5_acute = Sec5Serializer(required=False)
    sec6_risks = Sec6Serializer(required=False)
    sec8_ecotox = Sec8Serializer(required=False)
    sec9_soil = Sec9Serializer(required=False)
    sec10_water = Sec10Serializer(required=False)
    sec11_class = Sec11Serializer(required=False)
    sec12_ghs = Sec12Serializer(required=False)
    sec13_label = Sec13Serializer(required=False)
    sec14_safety = Sec14Serializer(required=False)
    sec15_storage = Sec15Serializer(required=False)
    sec16_waste = Sec16Serializer(required=False)
    sec17_incidents = Sec17Serializer(required=False)
    sec18_intl = Sec18Serializer(required=False)
    sec20_docs = Sec20Serializer(required=False)
    sec21_companies = Sec21Serializer(required=False)
    sec22_volumes = Sec22Serializer(required=False)
    sec23_extra = Sec23Serializer(required=False)

    attachments = ElementAttachmentSerializer(many=True, read_only=True)

    class Meta:
        model = ChemicalElement
        fields = '__all__'
        # –£–ë–†–ê–õ–ò 'status' –æ—Ç—Å—é–¥–∞! –¢–µ–ø–µ—Ä—å –æ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –≤ __init__
        read_only_fields = ('created_by', 'updated_at')

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        request = self.context.get('request')

        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–ª–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è
        self.fields['status'].read_only = True

        # –ï—Å–ª–∏ —ç—Ç–æ –∞–¥–º–∏–Ω –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª -> –æ—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
        if request and (request.user.is_staff or getattr(request.user, 'role', '') in ['ADMIN', 'CONTROLLER']):
             self.fields['status'].read_only = False

    def create(self, validated_data):
        sections_data = self._extract_section_data(validated_data)
        element = ChemicalElement.objects.create(**validated_data)
        self._update_sections(element, sections_data)
        self._ensure_sections_exist(element)
        return element

    def update(self, instance, validated_data):
        sections_data = self._extract_section_data(validated_data)
        super().update(instance, validated_data)
        self._update_sections(instance, sections_data)
        return instance

    def _extract_section_data(self, data):
        sections = {}
        for key in list(data.keys()):
            if key.startswith('sec'):
                sections[key] = data.pop(key)
        return sections

    def _update_sections(self, element, sections_data):
        for field_name, data in sections_data.items():
            if not data: continue
            field = getattr(ChemicalElement, field_name)
            RelatedModel = field.related.related_model
            RelatedModel.objects.update_or_create(element=element, defaults=data)

    def _ensure_sections_exist(self, element):
        for rel in element._meta.related_objects:
            if rel.one_to_one and rel.name.startswith('sec'):
                if not hasattr(element, rel.name):
                    rel.related_model.objects.create(element=element)

==================================================
FILE: .\backend\registry\services.py
==================================================
import pandas as pd
import re
from openpyxl import Workbook
from openpyxl.utils import get_column_letter
from openpyxl.worksheet.datavalidation import DataValidation
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from django.db import transaction

# –ò–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–µ–π
from registry.models import (
    ChemicalElement, RegistryConfig,
    Sec1Identification, Sec2Physical, Sec3ToxSanPin, Sec4ToxAir,
    Sec5ToxAcute, Sec6ToxRisks, Sec8EcoTox, Sec9Soil, Sec10Water,
    Sec11HazardClass, Sec12GHSClass, Sec13GHSLabel,
    Sec14Safety, Sec15Storage, Sec16Waste, Sec17Incidents,
    Sec18InternationalReg, Sec20Docs, Sec21Companies,
    Sec22Volumes, Sec23Extra
)

from .structures import SECTION_MAP

def get_field_info(model, field_name):
    try:
        return model._meta.get_field(field_name)
    except:
        return None

# =========================================================================
# 1. –ì–ï–ù–ï–†–ê–¶–ò–Ø –®–ê–ë–õ–û–ù–ê
# =========================================================================
def generate_excel_template():
    wb = Workbook()
    ws = wb.active
    ws.title = "–§–æ—Ä–º–∞ —Ä–µ–µ—Å—Ç—Ä–∞"
    ws.freeze_panes = "A2"

    config_obj = RegistryConfig.objects.first()
    required_in_db = config_obj.required_fields if config_obj else []
    visible_in_db = config_obj.template_fields if config_obj else []

    header_font = Font(bold=True, color="FFFFFF", size=10)
    center_align = Alignment(horizontal='center', vertical='center', wrap_text=True)
    border = Border(left=Side(style='thin'), right=Side(style='thin'))

    current_col = 1

    for section_name, hex_color, model_cls, fields in SECTION_MAP:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤ —Å–µ–∫—Ü–∏–∏ —Ö–æ—Ç—å –æ–¥–Ω–æ –ø–æ–ª–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å
        section_has_visible_fields = False
        for _, db_f, is_sys in fields:
            if is_sys or (not visible_in_db) or (db_f in visible_in_db):
                section_has_visible_fields = True
                break

        if not section_has_visible_fields:
            continue

        fill = PatternFill(start_color=hex_color, end_color=hex_color, fill_type="solid")

        for excel_header, db_field, is_system_required in fields:
            # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –≤–∏–¥–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
            if not is_system_required and visible_in_db and (db_field not in visible_in_db):
                continue

            is_mandatory = is_system_required or (db_field in required_in_db)
            final_header = excel_header + (" *" if is_mandatory else "")

            cell = ws.cell(row=1, column=current_col, value=final_header)
            cell.font = header_font
            cell.fill = fill
            cell.alignment = center_align
            cell.border = border

            col_letter = get_column_letter(current_col)
            ws.column_dimensions[col_letter].width = 25

            # –í—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ (Data Validation)
            field_obj = get_field_info(model_cls, db_field)
            if field_obj and field_obj.choices:
                # –°–æ–±–∏—Ä–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–±–æ—Ä–∞
                options = [str(c[1]).strip() for c in field_obj.choices]
                # Excel –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç 255 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Ñ–æ—Ä–º—É–ª—É —Å–ø–∏—Å–∫–∞ –≤–Ω—É—Ç—Ä–∏ —è—á–µ–π–∫–∏
                formula_str = ",".join(options).replace("\"", "").replace("'", "")

                if len(formula_str) < 255:
                    dv = DataValidation(type="list", formula1=f'"{formula_str}"', allow_blank=True)
                    ws.add_data_validation(dv)
                    dv.add(f"{col_letter}2:{col_letter}2000")

            current_col += 1

    return wb

# =========================================================================
# 2. –ò–ú–ü–û–†–¢
# =========================================================================
def parse_boolean(value):
    v = str(value).lower().strip()
    return v in ['+', '1', 'yes', '–¥–∞', 'true', '–µ—Å—Ç—å', 'y']

def process_excel_import(file, user):
    try:
        df = pd.read_excel(file)

        # === –£–õ–£–ß–®–ï–ù–ù–ê–Ø –û–ß–ò–°–¢–ö–ê –ó–ê–ì–û–õ–û–í–ö–û–í ===
        clean_cols = []
        for col in df.columns:
            # 1. –í —Å—Ç—Ä–æ–∫—É
            c = str(col).strip()
            # 2. –£–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
            if c.endswith("*"):
                c = c.replace("*", "").strip()
            # 3. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—Ä–æ–±–µ–ª—ã (–¥–≤–∞ –ø—Ä–æ–±–µ–ª–∞ -> –æ–¥–∏–Ω)
            c = re.sub(r'\s+', ' ', c)
            clean_cols.append(c)

        df.columns = clean_cols
        # –ó–∞–º–µ–Ω—è–µ–º NaN –Ω–∞ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É, —á—Ç–æ–±—ã –Ω–µ –ø–∞–¥–∞—Ç—å
        df = df.fillna("")

    except Exception as e:
        return {"success": 0, "errors": [f"–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel): {str(e)}"]}

    report = {"success": 0, "errors": []}

    # 1. –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—ã –º–∞–ø–ø–∏–Ω–≥–∞
    FLAT_MAP = {}      # –ó–∞–≥–æ–ª–æ–≤–æ–∫ Excel (—á–∏—Å—Ç—ã–π) -> (–ö–ª–∞—Å—Å–ú–æ–¥–µ–ª–∏, –ò–º—è–ü–æ–ª—è–ë–î)
    HUMAN_NAMES = {}   # –ò–º—è–ü–æ–ª—è–ë–î -> –ó–∞–≥–æ–ª–æ–≤–æ–∫ Excel (–¥–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö –æ—à–∏–±–æ–∫)

    for _, _, model, fields in SECTION_MAP:
        for ex_head, db_field, _ in fields:
            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∏ –∫–ª—é—á –º–∞–ø–ø–∏–Ω–≥–∞ —Ç–æ–∂–µ, —á—Ç–æ–±—ã —Å–æ–≤–ø–∞–¥–∞–ª–æ –Ω–∞–≤–µ—Ä–Ω—è–∫–∞
            clean_head = re.sub(r'\s+', ' ', ex_head.strip())
            FLAT_MAP[clean_head] = (model, db_field)
            HUMAN_NAMES[db_field] = ex_head

    # 2. –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–æ–∫–∞–º
    for index, row in df.iterrows():
        row_num = index + 2 # –í Excel —Å—Ç—Ä–æ–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 1, –ø–ª—é—Å –∑–∞–≥–æ–ª–æ–≤–æ–∫
        try:
            with transaction.atomic():
                extracted_data = {}

                # A. –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
                for col_name in df.columns:
                    col_name_clean = str(col_name).strip()

                    if col_name_clean not in FLAT_MAP:
                        continue # –ö–æ–ª–æ–Ω–∫–∞ –Ω–µ –∏–∑ –Ω–∞—à–µ–≥–æ —à–∞–±–ª–æ–Ω–∞

                    target_model, target_field = FLAT_MAP[col_name_clean]
                    raw_value = str(row[col_name]).strip()

                    if not raw_value:
                        continue

                    field_obj = get_field_info(target_model, target_field)
                    final_value = raw_value

                    # –ï—Å–ª–∏ –ø–æ–ª–µ —Å –≤—ã–±–æ—Ä–æ–º (choices), –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∫–ª—é—á –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
                    # (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ", –∞ –≤ –±–∞–∑—É –Ω–∞–¥–æ –ø–∏—Å–∞—Ç—å "SOLID")
                    if field_obj and field_obj.choices:
                        for k, label in field_obj.choices:
                            if raw_value.lower() == str(label).lower() or raw_value.lower() == str(k).lower():
                                final_value = k
                                break

                    # –ï—Å–ª–∏ –±—É–ª–µ–≤–æ –ø–æ–ª–µ
                    if field_obj and field_obj.get_internal_type() == 'BooleanField':
                        final_value = parse_boolean(raw_value)

                    # –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –º–æ–¥–µ–ª—è–º
                    if target_model not in extracted_data:
                        extracted_data[target_model] = {}
                    extracted_data[target_model][target_field] = final_value

                # –ë. –í–ê–õ–ò–î–ê–¶–ò–Ø (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è)
                config_obj = RegistryConfig.objects.first()
                required_list = config_obj.required_fields if config_obj else []

                if required_list:
                    for field_name in required_list:
                        # –ò—â–µ–º —ç—Ç–æ –ø–æ–ª–µ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                        found_val = False
                        for model_class, fields_dict in extracted_data.items():
                            if field_name in fields_dict:
                                val = fields_dict[field_name]
                                if val is not None and val != "":
                                    found_val = True
                                    break

                        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è
                        if not found_val:
                            human_name = HUMAN_NAMES.get(field_name, field_name)
                            raise ValueError(f"–ü–æ–ª–µ '{human_name}' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è.")

                # –í. –°–∏—Å—Ç–µ–º–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (–ì–ª–∞–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
                if ChemicalElement not in extracted_data or 'primary_name_ru' not in extracted_data[ChemicalElement]:
                     # –ï—Å–ª–∏ –≤—Å—è —Å—Ç—Ä–æ–∫–∞ –ø—É—Å—Ç–∞—è - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –º–æ–ª—á–∞
                     if not row.empty and any(str(x).strip() for x in row):
                        raise ValueError("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç '–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)'")
                     continue

                # –ì. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
                # –°–Ω–∞—á–∞–ª–∞ –≥–ª–∞–≤–Ω—É—é –º–æ–¥–µ–ª—å
                element = ChemicalElement.objects.create(
                    created_by=user,
                    status=ChemicalElement.Status.DRAFT,
                    **extracted_data[ChemicalElement]
                )

                # –ü–æ—Ç–æ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
                for model_cls, fields_dict in extracted_data.items():
                    if model_cls == ChemicalElement: continue
                    model_cls.objects.create(element=element, **fields_dict)

                # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—ã–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Å–µ–∫—Ü–∏–π (—á—Ç–æ–±—ã –∞–¥–º–∏–Ω–∫–∞ –Ω–µ –ø–∞–¥–∞–ª–∞)
                for rel_obj in ChemicalElement._meta.related_objects:
                    if rel_obj.one_to_one and rel_obj.name.startswith('sec'):
                        if not hasattr(element, rel_obj.name):
                            rel_obj.related_model.objects.create(element=element)

                report["success"] += 1

        except Exception as e:
            report["errors"].append(f"–°—Ç—Ä–æ–∫–∞ {row_num}: {str(e)}")

    return report

==================================================
FILE: .\backend\registry\signals.py
==================================================
from django.db.models.signals import pre_save
from django.dispatch import receiver
from django.db import transaction
from .models import ChemicalElement
from .tasks import send_status_email_task

@receiver(pre_save, sender=ChemicalElement)
def notify_status_change(sender, instance, **kwargs):
    # –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–æ–≤—ã–π (–µ—â–µ –Ω–µ—Ç PK), —Ç–æ –Ω–µ —Å —á–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å
    if not instance.pk:
        return

    try:
        # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∏–∑ –ë–î
        old_instance = ChemicalElement.objects.get(pk=instance.pk)
    except ChemicalElement.DoesNotExist:
        return

    # –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è
    if old_instance.status != instance.status:
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–º—É –∏ —Ç–µ–ª–æ –ø–∏—Å—å–º–∞
        subject = f"–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤–µ—â–µ—Å—Ç–≤–∞: {instance.primary_name_ru}"
        message = ""

        if instance.status == 'PUBLISHED':
            message = (
                f"–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {instance.created_by.username}!\n\n"
                f"–í–∞—à–µ –≤–µ—â–µ—Å—Ç–≤–æ '{instance.primary_name_ru}' (CAS: {instance.cas_number or '–ù–µ—Ç'}) "
                f"—É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–æ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –ø–æ–ª—É—á–∏–ª–æ —Å—Ç–∞—Ç—É—Å –û–ü–£–ë–õ–ò–ö–û–í–ê–ù–û.\n\n"
                f"–¢–µ–ø–µ—Ä—å –æ–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ."
            )
        elif instance.status == 'REJECTED':
            message = (
                f"–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {instance.created_by.username}.\n\n"
                f"–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –º–æ–¥–µ—Ä–∞—Ü–∏—è –≤–µ—â–µ—Å—Ç–≤–∞ '{instance.primary_name_ru}' –±—ã–ª–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.\n"
                f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
            )

        # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å email
        if message and instance.created_by.email:
            # –í–∞–∂–Ω–æ: –∏—Å–ø–æ–ª—å–∑—É–µ–º on_commit. –ó–∞–¥–∞—á–∞ —É–π–¥–µ—Ç –≤ Celery —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ë–î —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è.
            transaction.on_commit(
                lambda: send_status_email_task.delay(
                    instance.created_by.email,
                    subject,
                    message
                )
            )

==================================================
FILE: .\backend\registry\structures.py
==================================================
from registry.models import (
    ChemicalElement, Sec1Identification, Sec2Physical, Sec3ToxSanPin,
    Sec4ToxAir, Sec5ToxAcute, Sec6ToxRisks, Sec8EcoTox, Sec9Soil, Sec10Water,
    Sec11HazardClass, Sec12GHSClass, Sec13GHSLabel, Sec14Safety, Sec15Storage,
    Sec16Waste, Sec17Incidents, Sec18InternationalReg, Sec20Docs, Sec21Companies,
    Sec22Volumes, Sec23Extra
)

# –í–∞–∂–Ω–æ: –°—é–¥–∞ –º—ã –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ SECTION_MAP —Ü–µ–ª–∏–∫–æ–º –∏–∑ services.py
SECTION_MAP = [
    ("–ì–õ–ê–í–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø", "34495E", ChemicalElement, [
        ("–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)", "primary_name_ru", True),
        ("CAS –Ω–æ–º–µ—Ä",              "cas_number",      False),
    ]),
    ("I. –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø", "2980B9", Sec1Identification, [
        ("–°–∏–Ω–æ–Ω–∏–º—ã",               "synonyms",          False),
        ("–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞",   "molecular_formula", False),
        ("–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞",    "structural_formula",False),
        ("–ù–æ–º–µ—Ä –ï–°",               "ec_number",         False),
        ("IUPAC (RU)",             "iupac_name_ru",     False),
        ("–ö–æ–¥ –¢–ù –í–≠–î",             "tnved_code",        False),
    ]),
    ("II. –§–ò–ó–ò–ö–û-–•–ò–ú–ò–ß–ï–°–ö–ò–ï –°–í–û–ô–°–¢–í–ê", "16A085", Sec2Physical, [
        ("–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ",   "appearance",       False), # –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
        ("–ó–∞–ø–∞—Ö",                  "odor",             False), # –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
        ("–¶–≤–µ—Ç",                   "color",            False),
        ("pH",                     "ph",               False),
        ("–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞",     "mol_mass",         False),
        ("–¢. –ø–ª–∞–≤–ª–µ–Ω–∏—è (¬∞C)",      "melting_point",    False),
        ("–¢. –∫–∏–ø–µ–Ω–∏—è (¬∞C)",        "boiling_point",    False),
        ("–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–≥/—Å–º3)",      "density",          False),
        ("–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å –≤ –≤–æ–¥–µ",   "solubility_water", False),
    ]),
    ("III. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø (–°–∞–Ω–ü–∏–ù)", "C0392B", Sec3ToxSanPin, [
        ("–ü–î–ö —Ä–∞–±.–∑–æ–Ω—ã (–º–≥/–º3)",   "pdk_workzone",     False),
        ("–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ",    "state_in_air",     False), # –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
        ("LD50 –∂–µ–ª—É–¥–æ–∫",           "ld50_stomach",     False),
        ("LC50 –≤–æ–∑–¥—É—Ö",            "lc50_air",         False),
        ("–ó–æ–Ω–∞ –æ—Å—Ç—Ä–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è",  "zone_acute",       False),
        ("–ö–í–ò–û",                   "kvio",             False),
    ]),
    ("IV. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø (–ê–¢–ú–û–°–§–ï–†–ê)", "D35400", Sec4ToxAir, [
        ("–õ–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫",   "limit_sign",       False), # –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
        ("–ú–∞–∫—Å. —Ä–∞–∑–æ–≤–∞—è –ü–î–ö",      "pdk_max_single",   False),
        ("–°—Ä–µ–¥–Ω–µ—Å—É—Ç–æ—á–Ω–∞—è –ü–î–ö",     "pdk_daily_avg",    False),
    ]),
    ("V. –û–°–¢–†–ê–Ø –¢–û–ö–°–ò–ß–ù–û–°–¢–¨", "E67E22", Sec5ToxAcute, [
        ("–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç",   "inhalation_lc50_effect", False),
        ("–ó–Ω–∞—á–µ–Ω–∏–µ LC50 (–∏–Ω–≥–∞–ª)",  "inhalation_lc50_val",    False),
        ("–î–µ—Ä–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç",      "dermal_ld50_effect",     False),
        ("–ü–µ—Ä–æ—Ä–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç",     "oral_ld50_effect",       False),
    ]),
    ("VI. –†–ò–°–ö–ò (–°–ì–°)", "8E44AD", Sec6ToxRisks, [
        ("–†–∞–∑—ä–µ–¥–∞–Ω–∏–µ –∫–æ–∂–∏ (–ö–∞—Ç)",       "skin_corr",        False),
        ("–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–ª–∞–∑ (–ö–∞—Ç)",      "eye_dmg",          False),
        ("–°–µ–Ω—Å–∏–±–∏–ª–∏–∑–∞—Ü–∏—è (–ö–∞—Ç)",        "sensitization",    False),
        ("–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç)",       "carcinogenicity",  False),
        ("–†–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫—Å. (–ö–∞—Ç)",  "repro_tox",        False),
    ]),
    ("VIII. –≠–ö–û–õ–û–ì–ò–Ø", "27AE60", Sec8EcoTox, [
        ("LD50 –†—ã–±—ã",              "ld50_fish",        False),
        ("LD50 –ü—Ç–∏—Ü—ã",             "ld50_birds",       False),
        ("–ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è (+/-)",   "bioaccumulation",  False), # Boolean
        ("–§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (+/-)",  "phytotoxicity",    False), # Boolean
    ]),
    ("IX. –ü–û–ß–í–ê", "2ECC71", Sec9Soil, [
        ("–ü–î–ö –≤ –ø–æ—á–≤–µ",            "pdk_soil",         False),
        ("–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å",        "persistence",      False),
        ("–ú–∏–≥—Ä–∞—Ü–∏—è",               "migration",        False),
    ]),
    ("XI. –ö–õ–ê–°–°–´ –û–ü–ê–°–ù–û–°–¢–ò", "7F8C8D", Sec11HazardClass, [
        ("–ö–ª–∞—Å—Å (–°–∞–Ω–ü–∏–ù 0294-11)", "sanpin_class",     False),
        ("–ö–ª–∞—Å—Å (–ì–û–°–¢ 12.1.007)",  "gost_body_class",  False),
        ("–ö–ª–∞—Å—Å (–ì–û–°–¢ 32424)",     "gost_env_class",   False),
    ]),
    ("XII. –°–ì–° –ò–ù–§–û–†–ú–ê–¶–ò–Ø (–¢–µ–∫—Å—Ç)", "9B59B6", Sec12GHSClass, [
        ("–§–∏–∑. –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ç–µ–∫—Å—Ç)", "phys_hazard", False),
    ]),
    ("XIII. –ú–ê–†–ö–ò–†–û–í–ö–ê –°–ì–°", "9B59B6", Sec13GHSLabel, [
        ("–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ",       "signal_word",      False),
        ("–ö–æ–¥—ã –ø–∏–∫—Ç–æ–≥—Ä–∞–º–º",        "pictogram_code",   False),
        ("H-—Ñ—Ä–∞–∑—ã",                "h_phrases",        False),
        ("P-—Ñ—Ä–∞–∑—ã",                "p_phrases",        False),
    ]),
    ("XV. –•–†–ê–ù–ï–ù–ò–ï", "3498DB", Sec15Storage, [
        ("–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é",  "storage_reqs",     False),
        ("–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤-–≤–∞",     "incompatible",     False),
    ]),
    ("XVI. –û–¢–•–û–î–´", "95A5A6", Sec16Waste, [
        ("–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è",             "disposal",         False),
    ]),
    ("XVII. –ò–ù–¶–ò–î–ï–ù–¢–´", "E74C3C", Sec17Incidents, [
        ("–ò—Å—Ç–æ—Ä–∏—è –∞–≤–∞—Ä–∏–π",         "accident_history", False), # –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø–æ–ª–µ
    ]),
    ("XVIII. –†–ï–ì–£–õ–ò–†–û–í–ê–ù–ò–ï (+/-)", "34495E", Sec18InternationalReg, [
        ("–û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–µ",       "ozone_destroying", False),
        ("–°—Ç–æ–∫–≥–æ–ª—å–º (–°–û–ó)",        "pops",             False),
        ("–†–æ—Ç—Ç–µ—Ä–¥–∞–º (PIC)",        "pic",              False),
        ("–ú–∏–Ω–∞–º–∞—Ç–∞ (–†—Ç—É—Ç—å)",       "mercury",          False),
    ]),
    ("XX. –î–û–ö–£–ú–ï–ù–¢–´", "2C3E50", Sec20Docs, [
        ("–ì–û–°–¢—ã –∏ –ù–ü–ê",            "gost_standards",   False),
    ]),
    ("XXI. –ö–û–ú–ü–ê–ù–ò–ò", "2C3E50", Sec21Companies, [
        ("–£—á–∞—Å—Ç–Ω–∏–∫–∏ (–ò–Ω—Ñ–æ)",       "info",             False),
    ]),
]

==================================================
FILE: .\backend\registry\tasks.py
==================================================
import io
import os
from celery import shared_task
from django.contrib.auth import get_user_model
from django.core.files.storage import default_storage
from django.core.mail import send_mail
from django.conf import settings
from .services import process_excel_import

User = get_user_model()

@shared_task(bind=True)
def import_excel_task(self, file_path_key, user_id):
    try:
        user = User.objects.get(id=user_id)

        # –°—Ç–∞—Ç—É—Å: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
        self.update_state(state='PROGRESS', meta={'progress': 5, 'message': '–°–∫–∞—á–∏–≤–∞–Ω–∏–µ...'})

        if not default_storage.exists(file_path_key):
             return {"imported": 0, "errors": [f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {file_path_key}"]}

        # –°–∫–∞—á–∏–≤–∞–µ–º –∏–∑ S3/MinIO –≤ –ø–∞–º—è—Ç—å
        with default_storage.open(file_path_key, 'rb') as f:
            file_content = f.read()

        file_in_memory = io.BytesIO(file_content)

        # –°—Ç–∞—Ç—É—Å: –ü–∞—Ä—Å–∏–Ω–≥
        self.update_state(state='PROGRESS', meta={'progress': 10, 'message': '–ü–∞—Ä—Å–∏–Ω–≥ Excel...'})

        # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
        report = process_excel_import(file_in_memory, user)

        # –ß–∏—Å—Ç–∏–º –∑–∞ —Å–æ–±–æ–π (—É–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏–∑ S3)
        default_storage.delete(file_path_key)

        return {
            "status": "DONE",
            "imported": report.get('success', 0),
            "errors": report.get('errors', [])
        }

    except Exception as e:
        return {"imported": 0, "errors": [f"–°–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞: {str(e)}"]}


@shared_task
def send_status_email_task(user_email, subject, message):
    """
    –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ —á–µ—Ä–µ–∑ Celery.
    –ï—Å–ª–∏ SMTP –∑–∞–≤–∏—Å–Ω–µ—Ç, —ç—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –∞–¥–º–∏–Ω–∫–∏.
    """
    try:
        send_mail(
            subject=subject,
            message=message,
            from_email=settings.EMAIL_HOST_USER,
            recipient_list=[user_email],
            fail_silently=False,
        )
        return f"Email sent to {user_email}"
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –ø–∏—Å—å–º–æ –Ω–µ —É—à–ª–æ (–º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å logging)
        print(f"ERROR sending email to {user_email}: {e}")
        return f"Failed: {e}"

==================================================
FILE: .\backend\registry\tests.py
==================================================
from django.test import TestCase

# Create your tests here.


==================================================
FILE: .\backend\registry\urls.py
==================================================
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from .views import (
    DownloadTemplateView, ImportElementsView,
    ChemicalElementViewSet, StatisticsView, TaskStatusView, PublicConfigView
)

router = DefaultRouter()
router.register(r'elements', ChemicalElementViewSet, basename='element')

urlpatterns = [
    path('', include(router.urls)),

    # –ò–º–ø–æ—Ä—Ç –∏ —ç–∫—Å–ø–æ—Ä—Ç
    path('import/template/', DownloadTemplateView.as_view(), name='download-template'),
    path('import/upload/', ImportElementsView.as_view(), name='import-upload'),

    # –ù–æ–≤–æ–µ: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∏ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    path('tasks/<str:task_id>/', TaskStatusView.as_view(), name='task-status'),
    path('stats/', StatisticsView.as_view(), name='statistics'),
    path('tasks/<str:task_id>/', TaskStatusView.as_view(), name='task-status'),
    path('stats/', StatisticsView.as_view(), name='stats'),
    path('config/', PublicConfigView.as_view()),
]

==================================================
FILE: .\backend\registry\views.py
==================================================
import os
from django.conf import settings
from django.db.models import Count, TextField, Value, Q, F
from django.db.models.functions import Cast, Coalesce
from django.contrib.postgres.search import TrigramSimilarity
from django.template.loader import render_to_string
from django.http import HttpResponse
from django.core.files.storage import default_storage
from django.core.files.base import ContentFile
from django.utils.decorators import method_decorator
from django.views.decorators.cache import cache_page

from rest_framework import viewsets, filters, status
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework.parsers import MultiPartParser, FormParser
from rest_framework.permissions import IsAuthenticated, AllowAny
from rest_framework.decorators import action
from celery.result import AsyncResult
from weasyprint import HTML

from .models import ChemicalElement, RegistryConfig, ElementAttachment, Sec1Identification
from .permissions import IsOwnerOrReadOnly
from .serializers import (
    ChemicalElementDetailSerializer,
    ChemicalElementListSerializer,
    ElementAttachmentSerializer
)
from .services import generate_excel_template
from .tasks import import_excel_task
from .structures import SECTION_MAP


# 1. API –î–õ–Ø –ö–û–õ–û–ù–û–ö (–ö—ç—à–∏—Ä—É–µ–º –Ω–∞ 24 —á–∞—Å–∞, –º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∫–æ)
class PublicConfigView(APIView):
    permission_classes = [AllowAny]

    @method_decorator(cache_page(60 * 60 * 24))
    def get(self, request):
        config = RegistryConfig.objects.first()
        public_fields = []
        if config and hasattr(config, 'public_list_fields'):
             public_fields = config.public_list_fields or []

        if 'primary_name_ru' not in public_fields:
            public_fields.insert(0, 'primary_name_ru')

        columns = []
        LABELS = {}
        for _, _, _, fields_list in SECTION_MAP:
            for excel_name, db_name, _ in fields_list:
                LABELS[db_name] = excel_name

        for field in public_fields:
            columns.append({
                "field": field,
                "headerName": LABELS.get(field, field),
                "minWidth": 150
            })

        return Response(columns)


# 2. –°–¢–ê–¢–ò–°–¢–ò–ö–ê (–ö—ç—à 15 –º–∏–Ω—É—Ç)
class StatisticsView(APIView):
    permission_classes = [AllowAny]

    @method_decorator(cache_page(60 * 15))
    def get(self, request):
        qs = ChemicalElement.objects.filter(status='PUBLISHED')
        return Response({
            "total_elements": qs.count(),
            "hazard_distribution": qs.values('sec11_class__sanpin_class').annotate(count=Count('id'))
        })


class DownloadTemplateView(APIView):
    permission_classes = [AllowAny]

    def get(self, request):
        wb = generate_excel_template()
        response = HttpResponse(content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
        response['Content-Disposition'] = 'attachment; filename=tmpl.xlsx'
        wb.save(response)
        return response


class ImportElementsView(APIView):
    permission_classes = [IsAuthenticated]
    parser_classes = [MultiPartParser]

    def post(self, request):
        f = request.FILES.get('file')
        if not f: return Response({"error":"no file"}, 400)

        file_path = f"imports/{request.user.id}_{f.name}"
        saved_path = default_storage.save(file_path, ContentFile(f.read()))

        task = import_excel_task.delay(saved_path, request.user.id)
        return Response({"task_id": task.id}, 202)


class TaskStatusView(APIView):
    permission_classes = [IsAuthenticated]

    def get(self, req, task_id):
        res = AsyncResult(task_id)
        data = {'status': res.status}
        if res.ready():
            data['result'] = res.result
        return Response(data)


class ChemicalElementViewSet(viewsets.ModelViewSet):
    permission_classes = [IsOwnerOrReadOnly]
    parser_classes = [MultiPartParser, FormParser]

    def get_serializer_class(self):
        # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –î–ª—è —Å–ø–∏—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–µ–≥–∫–∏–π —Å–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä
        if self.action == 'list':
            return ChemicalElementListSerializer
        return ChemicalElementDetailSerializer

    def get_queryset(self):
        user = self.request.user
        qs = ChemicalElement.objects.all()

        # 1. –ì–õ–ê–í–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã N+1)
        # –ï—Å–ª–∏ –º—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç (retrieve) –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º -> –≥—Ä—É–∑–∏–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
        if self.action in ['retrieve', 'update', 'partial_update']:
            qs = qs.select_related(
                'sec1_identification', 'sec2_physical', 'sec3_sanpin', 'sec4_air',
                'sec5_acute', 'sec6_risks', 'sec8_ecotox', 'sec9_soil',
                'sec10_water', 'sec11_class', 'sec12_ghs', 'sec13_label',
                'sec14_safety', 'sec15_storage', 'sec16_waste', 'sec17_incidents',
                'sec18_intl', 'sec20_docs', 'sec21_companies', 'sec22_volumes',
                'sec23_extra',
                'created_by', 'created_by__company_profile'
            ).prefetch_related('attachments')
        else:
            # –î–ª—è —Å–ø–∏—Å–∫–∞ (list) –≥—Ä—É–∑–∏–º –¢–û–õ–¨–ö–û –∞–≤—Ç–æ—Ä–∞ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
            qs = qs.select_related('created_by', 'created_by__company_profile')
            # –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å hazard_class –≤ —Å–ø–∏—Å–∫–µ, –¥–∂–æ–π–Ω–∏–º —Ç–æ–ª—å–∫–æ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É
            qs = qs.select_related('sec11_class')

        # 2. PERMISSIONS
        if user.is_staff:
            pass
        elif user.is_authenticated:
            qs = qs.filter(Q(status='PUBLISHED') | Q(created_by=user))
        else:
            qs = qs.filter(status='PUBLISHED')

        # 3. SMART SEARCH (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô)
        q = self.request.query_params.get('search')
        if q:
            q = q.strip()
            # –ë–∞–∑–æ–≤—ã–π –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–µ–∫—Å—ã)
            base_search = Q(primary_name_ru__icontains=q) | Q(cas_number__icontains=q)

            # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –¥—Ä—É–≥–∏–º –ø–æ–ª—è–º (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
            config = RegistryConfig.objects.first()
            if config and config.public_list_fields:
                extra_search = Q()
                searchable_fields = set(config.public_list_fields)
                # –£–±–∏—Ä–∞–µ–º —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ base_search
                searchable_fields.discard('primary_name_ru')
                searchable_fields.discard('cas_number')

                for _, _, model_cls, fields_list in SECTION_MAP:
                    if model_cls == ChemicalElement: continue # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º, —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏

                    prefix = ""
                    try:
                        prefix = model_cls._meta.get_field('element').remote_field.name + "__"
                    except: continue

                    for _, db_field, _ in fields_list:
                        if db_field in searchable_fields:
                            extra_search |= Q(**{f"{prefix}{db_field}__icontains": q})

                qs = qs.filter(base_search | extra_search).distinct()
            else:
                # –ï—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –Ω–µ—Ç, –∏—â–µ–º —Ç–æ–ª—å–∫–æ –ø–æ –±–∞–∑–µ + —Å–∏–Ω–æ–Ω–∏–º–∞–º (—Å–∞–º–æ–µ —á–∞c—Ç–æ–µ)
                qs = qs.filter(
                    base_search |
                    Q(sec1_identification__synonyms__icontains=q) |
                    Q(sec1_identification__molecular_formula__icontains=q)
                ).distinct()

        # 4. –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ü–û –ü–û–õ–Ø–ú (FACETS)
        FIELD_LOOKUP_MAP = {}
        for _, _, model_cls, fields_list in SECTION_MAP:
            prefix = ""
            if model_cls != ChemicalElement:
                try:
                    prefix = model_cls._meta.get_field('element').remote_field.name + "__"
                except: continue

            for _, db_field, _ in fields_list:
                FIELD_LOOKUP_MAP[db_field] = prefix + db_field

        for param, value in self.request.query_params.items():
            if param in FIELD_LOOKUP_MAP and value:
                lookup = FIELD_LOOKUP_MAP[param]
                if str(value).lower() == 'true':
                    qs = qs.filter(**{lookup: True})
                elif str(value).lower() == 'false':
                    qs = qs.filter(**{lookup: False})
                else:
                    qs = qs.filter(**{lookup: value})

        return qs

    def perform_create(self, serializer):
        serializer.save(created_by=self.request.user)

    # === –ó–ê–ì–†–£–ó–ö–ê –°–¢–†–£–ö–¢–£–†–´ (–ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï) ===
    @action(detail=True, methods=['post'], parser_classes=[MultiPartParser, FormParser])
    def upload_structure(self, request, pk=None):
        element = self.get_object()
        sec1, _ = Sec1Identification.objects.get_or_create(element=element)

        file = request.FILES.get('image')
        if not file:
            return Response({"error": "–§–∞–π–ª –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω"}, status=400)

        sec1.structure_image = file
        sec1.save()
        return Response({"status": "updated", "url": sec1.structure_image.url})

    # === –ó–ê–ì–†–£–ó–ö–ê –í–õ–û–ñ–ï–ù–ò–ô (PDF –ò –¢.–î.) ===
    @action(detail=True, methods=['post'], parser_classes=[MultiPartParser, FormParser])
    def upload_attachment(self, request, pk=None):
        element = self.get_object()
        serializer = ElementAttachmentSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save(element=element)
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        else:
            return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    @action(detail=True, methods=['delete'], url_path='delete_attachment/(?P<attachment_id>\d+)')
    def delete_attachment(self, request, pk=None, attachment_id=None):
        try:
            att = ElementAttachment.objects.get(pk=attachment_id, element_id=pk)
            att.delete()
            return Response(status=status.HTTP_204_NO_CONTENT)
        except ElementAttachment.DoesNotExist:
            return Response({"error": "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"}, status=status.HTTP_404_NOT_FOUND)

    # === –ü–û–î–°–ö–ê–ó–ö–ò (AUTOCOMPLETE) ===
    @action(detail=False, methods=['get'], permission_classes=[AllowAny])
    def suggest(self, request):
        q = request.query_params.get('search', '').strip()
        if len(q) < 2: return Response([])

        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π QS, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª-–≤–æ
        qs = ChemicalElement.objects.filter(
            Q(primary_name_ru__icontains=q) |
            Q(cas_number__icontains=q) |
            Q(status='PUBLISHED')
        ).select_related('created_by')[:10]

        suggestions = []
        for elem in qs:
            if q.lower() in elem.primary_name_ru.lower():
                suggestions.append({"label": elem.primary_name_ru, "type": "–í–µ—â–µ—Å—Ç–≤–æ", "id": elem.id})
            elif elem.cas_number and q in elem.cas_number:
                suggestions.append({"label": f"{elem.cas_number} ({elem.primary_name_ru})", "type": "CAS", "id": elem.id})
            else:
                suggestions.append({"label": elem.primary_name_ru, "type": "–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ", "id": elem.id})

        # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏
        seen = set()
        unique = []
        for s in suggestions:
            if s['label'] not in seen:
                unique.append(s)
                seen.add(s['label'])
        return Response(unique[:10])

    # === –§–ê–°–ï–¢–´ (–°–ß–ï–¢–ß–ò–ö–ò –§–ò–õ–¨–¢–†–û–í) ===
    @action(detail=False, methods=['get'], permission_classes=[AllowAny])
    def facets(self, request):
        config = RegistryConfig.objects.first()
        if not config or not config.filter_fields:
            return Response({})

        filter_fields = config.filter_fields
        response_data = {}
        user = request.user
        qs = ChemicalElement.objects.all()

        if user.is_staff: pass
        elif user.is_authenticated: qs = qs.filter(Q(status='PUBLISHED') | Q(created_by=user))
        else: qs = qs.filter(status='PUBLISHED')

        q = request.query_params.get('search')
        if q:
            # –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–ª—è —Ñ–∞—Å–µ—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º –ø–æ–ª—è–º –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏)
            qs = qs.filter(
                Q(primary_name_ru__icontains=q) |
                Q(cas_number__icontains=q)
            )

        # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ–ª—è –∏ —Å—á–∏—Ç–∞–µ–º –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
        for _, _, model_cls, fields_list in SECTION_MAP:
            prefix = ""
            if model_cls != ChemicalElement:
                try: prefix = model_cls._meta.get_field('element').remote_field.name + "__"
                except: continue

            for human_name, db_field, _ in fields_list:
                if db_field in filter_fields:
                    full_field = prefix + db_field
                    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: values + annotate —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º loop
                    counts = qs.values(full_field).annotate(count=Count('id')).order_by('-count')

                    model_field = model_cls._meta.get_field(db_field)
                    choices_dict = dict(model_field.choices) if model_field.choices else {}

                    field_options = []
                    for item in counts:
                        val = item[full_field]
                        if val is None or val == "": continue

                        label = choices_dict.get(val, val)
                        if val is True: label = "–î–∞"
                        if val is False: label = "–ù–µ—Ç"

                        field_options.append({
                            "value": val,
                            "label": str(label),
                            "count": item['count']
                        })

                    if field_options:
                        response_data[db_field] = {
                            "title": human_name,
                            "options": field_options
                        }

        return Response(response_data)

    # === –ì–ï–ù–ï–†–ê–¶–ò–Ø PDF –ü–ê–°–ü–û–†–¢–ê ===
    @action(detail=True, methods=['get'], permission_classes=[AllowAny])
    def pdf(self, r, pk=None):
        # –î–ª—è PDF –Ω—É–∂–Ω–æ –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
        elem = ChemicalElement.objects.select_related(
            'sec1_identification', 'sec2_physical', 'sec3_sanpin', 'sec4_air',
            'sec5_acute', 'sec6_risks', 'sec8_ecotox', 'sec9_soil',
            'sec10_water', 'sec11_class', 'sec12_ghs', 'sec13_label',
            'sec14_safety', 'sec15_storage', 'sec16_waste', 'sec17_incidents',
            'sec18_intl', 'sec20_docs', 'sec21_companies', 'sec22_volumes',
            'sec23_extra'
        ).get(pk=pk)

        html = render_to_string('registry/passport_pdf.html', {'element': elem})
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º base_url —á—Ç–æ–±—ã weasyprint –º–æ–≥ –Ω–∞–π—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏/—à—Ä–∏—Ñ—Ç—ã
        pdf_file = HTML(string=html, base_url=r.build_absolute_uri('/')).write_pdf()

        response = HttpResponse(pdf_file, content_type='application/pdf')
        response['Content-Disposition'] = f'inline; filename="passport_{pk}.pdf"'
        return response

==================================================
FILE: .\backend\registry\__init__.py
==================================================


==================================================
FILE: .\backend\registry\migrations\0001_initial.py
==================================================
# Generated by Django 4.2.27 on 2025-12-05 19:06

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import simple_history.models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ChemicalElement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('DRAFT', '–ß–µ—Ä–Ω–æ–≤–∏–∫'), ('PENDING', '–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ'), ('PUBLISHED', '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ'), ('REJECTED', '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ')], default='DRAFT', max_length=20, verbose_name='–°—Ç–∞—Ç—É—Å')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è')),
                ('cas_number', models.CharField(blank=True, db_index=True, max_length=50, null=True, unique=True, verbose_name='–ù–æ–º–µ—Ä CAS')),
                ('primary_name_ru', models.CharField(db_index=True, max_length=500, verbose_name='–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='–ê–≤—Ç–æ—Ä')),
            ],
            options={
                'verbose_name': '–•–∏–º–∏—á–µ—Å–∫–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ',
                'verbose_name_plural': '–•–∏–º–∏—á–µ—Å–∫–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞',
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='RegistryConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('required_fields', models.JSONField(blank=True, default=list, verbose_name='–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫')),
            ],
            options={
                'verbose_name': '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ü–æ–ª–µ–π',
                'verbose_name_plural': '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ü–æ–ª–µ–π',
            },
        ),
        migrations.CreateModel(
            name='Sec9Soil',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('pdk_soil', models.CharField(blank=True, max_length=100, verbose_name='–ü–î–ö –≤ –ø–æ—á–≤–µ')),
                ('odk_soil', models.CharField(blank=True, max_length=100, verbose_name='–û–î–ö –≤ –ø–æ—á–≤–µ')),
                ('persistence', models.CharField(blank=True, choices=[('LOW', '–ú–∞–ª–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (<20 –¥–Ω–µ–π)'), ('MED', '–°—Ä–µ–¥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (20-90 –¥–Ω–µ–π)'), ('HIGH', '–£—Å—Ç–æ–π—á–∏–≤—ã–µ (>90 –¥–Ω–µ–π)')], max_length=50, verbose_name='–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å')),
                ('sorption', models.CharField(blank=True, choices=[('STR', '–°–∏–ª—å–Ω–∞—è'), ('WEAK', '–°–ª–∞–±–∞—è')], max_length=50, verbose_name='–°–æ—Ä–±—Ü–∏—è')),
                ('migration', models.CharField(blank=True, choices=[('MOB', '–ü–æ–¥–≤–∏–∂–µ–Ω'), ('IMM', '–ú–∞–ª–æ–ø–æ–¥–≤–∏–∂–µ–Ω')], max_length=50, verbose_name='–ú–∏–≥—Ä–∞—Ü–∏—è')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec9_soil', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'IX. –ü–æ—á–≤–∞',
            },
        ),
        migrations.CreateModel(
            name='Sec8EcoTox',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('ld50_mammals', models.CharField(blank=True, max_length=100, verbose_name='LD50 –ú–ª–µ–∫–æ–ø–∏—Ç–∞—é—â–∏–µ')),
                ('ld50_fish', models.CharField(blank=True, max_length=100, verbose_name='LD50 –†—ã–±—ã')),
                ('ld50_bees', models.CharField(blank=True, max_length=100, verbose_name='LD50 –ü—á–µ–ª—ã')),
                ('ld50_birds', models.CharField(blank=True, max_length=100, verbose_name='LD50 –ü—Ç–∏—Ü—ã')),
                ('bioaccumulation', models.BooleanField(default=False, verbose_name='–ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è (–ï—Å—Ç—å/–ù–µ—Ç)')),
                ('phytotoxicity', models.BooleanField(default=False, verbose_name='–§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (–ï—Å—Ç—å/–ù–µ—Ç)')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec8_ecotox', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'VIII. –≠–∫–æ-—Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è',
            },
        ),
        migrations.CreateModel(
            name='Sec6ToxRisks',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('skin_corr', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–†–∞–∑—ä–µ–¥–∞–Ω–∏–µ –∫–æ–∂–∏ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('eye_dmg', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–ª–∞–∑ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('sensitization', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–°–µ–Ω—Å–∏–±–∏–ª–∏–∑–∞—Ü–∏—è (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('mutagenicity', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ú—É—Ç–∞–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('carcinogenicity', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('repro_tox', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–†–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (–ö–∞—Ç.)')),
                ('aspiration_hazard', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ê—Å–ø–∏—Ä–∞—Ü–∏—è (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec6_risks', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'VI. –†–∏—Å–∫–∏ (–°–ì–°)',
            },
        ),
        migrations.CreateModel(
            name='Sec5ToxAcute',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('inhalation_lc50_effect', models.CharField(choices=[('YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π')], default='UNKNOWN', max_length=20, verbose_name='–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç')),
                ('inhalation_lc50_val', models.CharField(blank=True, max_length=100, verbose_name='–ó–Ω–∞—á–µ–Ω–∏–µ LC50 (–º–≥/–∫–≥)')),
                ('dermal_ld50_effect', models.CharField(choices=[('YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π')], default='UNKNOWN', max_length=20, verbose_name='–î–µ—Ä–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç')),
                ('dermal_ld50_val', models.CharField(blank=True, max_length=100, verbose_name='–ó–Ω–∞—á–µ–Ω–∏–µ LD50 (–º–≥/–∫–≥)')),
                ('oral_ld50_effect', models.CharField(choices=[('YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π')], default='UNKNOWN', max_length=20, verbose_name='–ü–µ—Ä–æ—Ä–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç')),
                ('oral_ld50_val', models.CharField(blank=True, max_length=100, verbose_name='–ó–Ω–∞—á–µ–Ω–∏–µ LD50 (–º–≥/–∫–≥)')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec5_acute', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'V. –û—Å—Ç—Ä–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å',
            },
        ),
        migrations.CreateModel(
            name='Sec4ToxAir',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('limit_sign', models.CharField(blank=True, choices=[('REFLEX', '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ–µ'), ('RESORPTIVE', '–†–µ–∑–æ—Ä–±—Ç–∏–≤–Ω–æ–µ'), ('REF_RES', '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ-—Ä–µ–∑–æ—Ä–±—Ç–∏–≤–Ω–æ–µ'), ('SANITARY', '–°–∞–Ω–∏—Ç–∞—Ä–Ω–æ-–±—ã—Ç–æ–≤–æ–µ')], max_length=20, verbose_name='–õ–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫')),
                ('pdk_max_single', models.CharField(blank=True, max_length=100, verbose_name='–ú–∞–∫—Å. —Ä–∞–∑–æ–≤–∞—è –ü–î–ö')),
                ('pdk_daily_avg', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–µ–¥–Ω–µ—Å—É—Ç–æ—á–Ω–∞—è –ü–î–ö')),
                ('pdk_month_avg', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –ü–î–ö')),
                ('pdk_year_avg', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –ü–î–ö')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec4_air', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'IV. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞)',
            },
        ),
        migrations.CreateModel(
            name='Sec3ToxSanPin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('state_in_air', models.CharField(blank=True, choices=[('P', '–ü–∞—Ä—ã (–ø)'), ('A', '–ê—ç—Ä–æ–∑–æ–ª—å (–∞)'), ('PA', '–°–º–µ—Å—å (–ø+–∞)')], max_length=10, verbose_name='–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ —Ä–∞–±. –∑–æ–Ω—ã')),
                ('pdk_workzone', models.CharField(blank=True, max_length=100, verbose_name='–ü–î–ö —Ä–∞–±. –∑–æ–Ω—ã (–º–≥/–º3)')),
                ('ld50_stomach', models.CharField(blank=True, max_length=100, verbose_name='LD50 –∂–µ–ª—É–¥–æ–∫')),
                ('ld50_skin', models.CharField(blank=True, max_length=100, verbose_name='LD50 –∫–æ–∂–∞')),
                ('lc50_air', models.CharField(blank=True, max_length=100, verbose_name='LC50 –≤–æ–∑–¥—É—Ö')),
                ('kvio', models.CharField(blank=True, max_length=100, verbose_name='–ö–í–ò–û')),
                ('zone_acute', models.CharField(blank=True, max_length=100, verbose_name='–ó–æ–Ω–∞ –æ—Å—Ç—Ä–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è')),
                ('zone_chronic', models.CharField(blank=True, max_length=100, verbose_name='–ó–æ–Ω–∞ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec3_sanpin', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'III. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–°–∞–Ω–ü–∏–ù)',
            },
        ),
        migrations.CreateModel(
            name='Sec2Physical',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('appearance', models.CharField(blank=True, choices=[('SOLID', '–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ'), ('LIQUID', '–ñ–∏–¥–∫–æ—Å—Ç—å'), ('GAS', '–ì–∞–∑'), ('VAPOR', '–ü–∞—Ä'), ('AEROSOL', '–ê—ç—Ä–æ–∑–æ–ª—å')], max_length=50, verbose_name='–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ')),
                ('odor', models.CharField(choices=[('NONE', '–ë–µ–∑ –∑–∞–ø–∞—Ö–∞'), ('SHARP', '–†–µ–∑–∫–∏–π'), ('SPECIFIC', '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π'), ('FRUIT', '–§—Ä—É–∫—Ç–æ–≤—ã–π'), ('OTHER', '–î—Ä—É–≥–æ–µ (—Å–º. –æ–ø–∏—Å–∞–Ω–∏–µ)')], default='OTHER', max_length=50, verbose_name='–ó–∞–ø–∞—Ö')),
                ('color', models.CharField(blank=True, max_length=100, verbose_name='–¶–≤–µ—Ç')),
                ('ph', models.CharField(blank=True, max_length=100, verbose_name='pH')),
                ('mol_mass', models.CharField(blank=True, max_length=100, verbose_name='–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞')),
                ('boiling_point', models.CharField(blank=True, max_length=100, verbose_name='–¢ –∫–∏–ø–µ–Ω–∏—è (¬∞C)')),
                ('melting_point', models.CharField(blank=True, max_length=100, verbose_name='–¢ –ø–ª–∞–≤–ª–µ–Ω–∏—è (¬∞C)')),
                ('auto_ignition', models.CharField(blank=True, max_length=100, verbose_name='–¢ —Å–∞–º–æ–≤–æ—Å–ø–ª–∞–º–µ–Ω–µ–Ω–∏—è (¬∞C)')),
                ('density', models.CharField(blank=True, max_length=100, verbose_name='–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–≥/—Å–º3)')),
                ('solubility_water', models.CharField(blank=True, max_length=255, verbose_name='–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å –≤ –≤–æ–¥–µ')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec2_physical', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'II. –§–∏–∑-—Ö–∏–º —Å–≤–æ–π—Å—Ç–≤–∞',
            },
        ),
        migrations.CreateModel(
            name='Sec23Extra',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('recommendations', models.TextField(blank=True, verbose_name='–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ / –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec23_extra', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XXIII. –î–æ–ø. –∏–Ω—Ñ–æ',
            },
        ),
        migrations.CreateModel(
            name='Sec22Volumes',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('vol_production', models.CharField(blank=True, max_length=100, verbose_name='–û–±—ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞')),
                ('vol_import', models.CharField(blank=True, max_length=100, verbose_name='–û–±—ä–µ–º –∏–º–ø–æ—Ä—Ç–∞')),
                ('vol_export', models.CharField(blank=True, max_length=100, verbose_name='–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec22_volumes', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XXII. –û–±—ä–µ–º—ã',
            },
        ),
        migrations.CreateModel(
            name='Sec21Companies',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('info', models.TextField(blank=True, verbose_name='–î–∞–Ω–Ω—ã–µ –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö (–ø—Ä–æ–∏–∑–≤./–∏–º–ø–æ—Ä—Ç.)')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec21_companies', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XXI. –ö–æ–º–ø–∞–Ω–∏–∏',
            },
        ),
        migrations.CreateModel(
            name='Sec20Docs',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('gost_standards', models.TextField(blank=True, verbose_name='–ì–û–°–¢—ã / –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã')),
                ('intl_docs', models.TextField(blank=True, verbose_name='–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec20_docs', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XX. –î–æ–∫—É–º–µ–Ω—Ç—ã',
            },
        ),
        migrations.CreateModel(
            name='Sec1Identification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('synonyms', models.TextField(blank=True, verbose_name='–°–∏–Ω–æ–Ω–∏–º—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)')),
                ('molecular_formula', models.CharField(blank=True, max_length=255, verbose_name='–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞')),
                ('structural_formula', models.TextField(blank=True, verbose_name='–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞')),
                ('ec_number', models.CharField(blank=True, max_length=50, verbose_name='–ù–æ–º–µ—Ä –ï–°')),
                ('iupac_name_ru', models.TextField(blank=True, verbose_name='IUPAC (RU)')),
                ('iupac_name_en', models.TextField(blank=True, verbose_name='IUPAC (EN)')),
                ('tnved_code', models.CharField(blank=True, max_length=50, verbose_name='–ö–æ–¥ –¢–ù –í–≠–î')),
                ('rtecs_link', models.CharField(blank=True, max_length=255, verbose_name='RTECS')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec1_identification', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'I. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è',
            },
        ),
        migrations.CreateModel(
            name='Sec18InternationalReg',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('ozone_destroying', models.BooleanField(default=False, verbose_name='–û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–µ (–ú–æ–Ω—Ä–µ–∞–ª—å)')),
                ('pops', models.BooleanField(default=False, verbose_name='–°–û–ó (–°—Ç–æ–∫–≥–æ–ª—å–º)')),
                ('pic', models.BooleanField(default=False, verbose_name='–ü—Ä–µ–¥–≤. —Å–æ–≥–ª–∞—Å–∏–µ (–†–æ—Ç—Ç–µ—Ä–¥–∞–º)')),
                ('mercury', models.BooleanField(default=False, verbose_name='–†—Ç—É—Ç—å (–ú–∏–Ω–∞–º–∞—Ç–∞)')),
                ('basel', models.BooleanField(default=False, verbose_name='–ë–∞–∑–µ–ª—å—Å–∫–∞—è –∫–æ–Ω–≤.')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec18_intl', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XVIII. –ú–µ–∂–¥. —Ä–µ–≥—É–ª—è—Ü–∏—è',
            },
        ),
        migrations.CreateModel(
            name='Sec17Incidents',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('accident_history', models.TextField(blank=True, verbose_name='–ò—Å—Ç–æ—Ä–∏—è –∞–≤–∞—Ä–∏–π / –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec17_incidents', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XVII. –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã',
            },
        ),
        migrations.CreateModel(
            name='Sec16Waste',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('collection', models.TextField(blank=True, verbose_name='–°–±–æ—Ä')),
                ('transport', models.TextField(blank=True, verbose_name='–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞')),
                ('disposal', models.TextField(blank=True, verbose_name='–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è')),
                ('burial', models.TextField(blank=True, verbose_name='–ó–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏–µ')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec16_waste', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XVI. –û—Ç—Ö–æ–¥—ã',
            },
        ),
        migrations.CreateModel(
            name='Sec15Storage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('temp_conditions', models.CharField(blank=True, max_length=100, verbose_name='–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞')),
                ('humidity', models.CharField(blank=True, max_length=100, verbose_name='–í–ª–∞–∂–Ω–æ—Å—Ç—å')),
                ('shelf_life', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è')),
                ('storage_reqs', models.TextField(blank=True, verbose_name='–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é')),
                ('incompatible', models.TextField(blank=True, verbose_name='–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤-–≤–∞')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec15_storage', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XV. –•—Ä–∞–Ω–µ–Ω–∏–µ',
            },
        ),
        migrations.CreateModel(
            name='Sec14Safety',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('prevent_health', models.TextField(blank=True, verbose_name='–ù–∞ –∑–¥–æ—Ä–æ–≤—å–µ (–°–ò–ó)')),
                ('first_aid', models.TextField(blank=True, verbose_name='–ü–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å')),
                ('prevent_env', models.TextField(blank=True, verbose_name='–ú–µ—Ä—ã –¥–ª—è —ç–∫–æ–ª–æ–≥–∏–∏')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec14_safety', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XIV. –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            },
        ),
        migrations.CreateModel(
            name='Sec13GHSLabel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('signal_word', models.CharField(choices=[('DANGER', '–û–ü–ê–°–ù–û (Danger)'), ('WARNING', '–û–°–¢–û–†–û–ñ–ù–û (Warning)'), ('NONE', '–ù–µ—Ç')], default='NONE', max_length=20, verbose_name='–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ')),
                ('pictogram_code', models.CharField(blank=True, help_text='–ù–∞–ø—Ä–∏–º–µ—Ä: GHS01, GHS02...', max_length=100, verbose_name='–ö–æ–¥—ã –ø–∏–∫—Ç–æ–≥—Ä–∞–º–º')),
                ('h_phrases', models.TextField(blank=True, verbose_name='H-—Ñ—Ä–∞–∑—ã')),
                ('p_phrases', models.TextField(blank=True, verbose_name='P-—Ñ—Ä–∞–∑—ã')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec13_label', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XIII. –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°',
            },
        ),
        migrations.CreateModel(
            name='Sec12GHSClass',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('phys_hazard', models.TextField(blank=True, verbose_name='–§–∏–∑–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏')),
                ('chem_hazard', models.TextField(blank=True, verbose_name='–•–∏–º–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏')),
                ('env_hazard', models.TextField(blank=True, verbose_name='–û–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–∫—Ä. —Å—Ä–µ–¥—ã')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec12_ghs', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XII. –ö–ª–∞—Å—Å—ã –°–ì–°',
            },
        ),
        migrations.CreateModel(
            name='Sec11HazardClass',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('sanpin_class', models.CharField(choices=[('1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'), ('3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=3, verbose_name='–ö–ª–∞—Å—Å (–°–∞–Ω–ü–∏–ù 0294-11)')),
                ('gost_body_class', models.CharField(choices=[('1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'), ('3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=3, verbose_name='–ö–ª–∞—Å—Å (–ì–û–°–¢ 12.1.007)')),
                ('gost_env_class', models.CharField(choices=[('1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'), ('3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=3, verbose_name='–ö–ª–∞—Å—Å (–ì–û–°–¢ 32424)')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec11_class', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'XI. –ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            },
        ),
        migrations.CreateModel(
            name='Sec10Water',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('acute_fish', models.CharField(blank=True, max_length=100, verbose_name='–û—Å—Ç—Ä–∞—è (–†—ã–±—ã LC50)')),
                ('acute_algae', models.CharField(blank=True, max_length=100, verbose_name='–û—Å—Ç—Ä–∞—è (–í–æ–¥–æ—Ä–æ—Å–ª–∏ LC50)')),
                ('chronic_fish', models.CharField(blank=True, max_length=100, verbose_name='–•—Ä–æ–Ω–∏—á. (–†—ã–±—ã)')),
                ('bioacc_logkow', models.CharField(blank=True, max_length=100, verbose_name='Potencial LogKow')),
                ('element', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sec10_water', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': 'X. –í–æ–¥–Ω–∞—è —Å—Ä–µ–¥–∞',
            },
        ),
        migrations.CreateModel(
            name='HistoricalSec9Soil',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('pdk_soil', models.CharField(blank=True, max_length=100, verbose_name='–ü–î–ö –≤ –ø–æ—á–≤–µ')),
                ('odk_soil', models.CharField(blank=True, max_length=100, verbose_name='–û–î–ö –≤ –ø–æ—á–≤–µ')),
                ('persistence', models.CharField(blank=True, choices=[('LOW', '–ú–∞–ª–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (<20 –¥–Ω–µ–π)'), ('MED', '–°—Ä–µ–¥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (20-90 –¥–Ω–µ–π)'), ('HIGH', '–£—Å—Ç–æ–π—á–∏–≤—ã–µ (>90 –¥–Ω–µ–π)')], max_length=50, verbose_name='–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å')),
                ('sorption', models.CharField(blank=True, choices=[('STR', '–°–∏–ª—å–Ω–∞—è'), ('WEAK', '–°–ª–∞–±–∞—è')], max_length=50, verbose_name='–°–æ—Ä–±—Ü–∏—è')),
                ('migration', models.CharField(blank=True, choices=[('MOB', '–ü–æ–¥–≤–∏–∂–µ–Ω'), ('IMM', '–ú–∞–ª–æ–ø–æ–¥–≤–∏–∂–µ–Ω')], max_length=50, verbose_name='–ú–∏–≥—Ä–∞—Ü–∏—è')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical IX. –ü–æ—á–≤–∞',
                'verbose_name_plural': 'historical IX. –ü–æ—á–≤–∞s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec8EcoTox',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('ld50_mammals', models.CharField(blank=True, max_length=100, verbose_name='LD50 –ú–ª–µ–∫–æ–ø–∏—Ç–∞—é—â–∏–µ')),
                ('ld50_fish', models.CharField(blank=True, max_length=100, verbose_name='LD50 –†—ã–±—ã')),
                ('ld50_bees', models.CharField(blank=True, max_length=100, verbose_name='LD50 –ü—á–µ–ª—ã')),
                ('ld50_birds', models.CharField(blank=True, max_length=100, verbose_name='LD50 –ü—Ç–∏—Ü—ã')),
                ('bioaccumulation', models.BooleanField(default=False, verbose_name='–ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è (–ï—Å—Ç—å/–ù–µ—Ç)')),
                ('phytotoxicity', models.BooleanField(default=False, verbose_name='–§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (–ï—Å—Ç—å/–ù–µ—Ç)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical VIII. –≠–∫–æ-—Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è',
                'verbose_name_plural': 'historical VIII. –≠–∫–æ-—Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—ès',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec6ToxRisks',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('skin_corr', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–†–∞–∑—ä–µ–¥–∞–Ω–∏–µ –∫–æ–∂–∏ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('eye_dmg', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–ª–∞–∑ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('sensitization', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–°–µ–Ω—Å–∏–±–∏–ª–∏–∑–∞—Ü–∏—è (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('mutagenicity', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ú—É—Ç–∞–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('carcinogenicity', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('repro_tox', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–†–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (–ö–∞—Ç.)')),
                ('aspiration_hazard', models.CharField(choices=[('1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'), ('1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'), ('1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'), ('2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'), ('3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=50, verbose_name='–ê—Å–ø–∏—Ä–∞—Ü–∏—è (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical VI. –†–∏—Å–∫–∏ (–°–ì–°)',
                'verbose_name_plural': 'historical VI. –†–∏—Å–∫–∏ (–°–ì–°)s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec5ToxAcute',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('inhalation_lc50_effect', models.CharField(choices=[('YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π')], default='UNKNOWN', max_length=20, verbose_name='–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç')),
                ('inhalation_lc50_val', models.CharField(blank=True, max_length=100, verbose_name='–ó–Ω–∞—á–µ–Ω–∏–µ LC50 (–º–≥/–∫–≥)')),
                ('dermal_ld50_effect', models.CharField(choices=[('YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π')], default='UNKNOWN', max_length=20, verbose_name='–î–µ—Ä–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç')),
                ('dermal_ld50_val', models.CharField(blank=True, max_length=100, verbose_name='–ó–Ω–∞—á–µ–Ω–∏–µ LD50 (–º–≥/–∫–≥)')),
                ('oral_ld50_effect', models.CharField(choices=[('YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'), ('UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π')], default='UNKNOWN', max_length=20, verbose_name='–ü–µ—Ä–æ—Ä–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç')),
                ('oral_ld50_val', models.CharField(blank=True, max_length=100, verbose_name='–ó–Ω–∞—á–µ–Ω–∏–µ LD50 (–º–≥/–∫–≥)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical V. –û—Å—Ç—Ä–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å',
                'verbose_name_plural': 'historical V. –û—Å—Ç—Ä–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—ås',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec4ToxAir',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('limit_sign', models.CharField(blank=True, choices=[('REFLEX', '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ–µ'), ('RESORPTIVE', '–†–µ–∑–æ—Ä–±—Ç–∏–≤–Ω–æ–µ'), ('REF_RES', '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ-—Ä–µ–∑–æ—Ä–±—Ç–∏–≤–Ω–æ–µ'), ('SANITARY', '–°–∞–Ω–∏—Ç–∞—Ä–Ω–æ-–±—ã—Ç–æ–≤–æ–µ')], max_length=20, verbose_name='–õ–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫')),
                ('pdk_max_single', models.CharField(blank=True, max_length=100, verbose_name='–ú–∞–∫—Å. —Ä–∞–∑–æ–≤–∞—è –ü–î–ö')),
                ('pdk_daily_avg', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–µ–¥–Ω–µ—Å—É—Ç–æ—á–Ω–∞—è –ü–î–ö')),
                ('pdk_month_avg', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –ü–î–ö')),
                ('pdk_year_avg', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –ü–î–ö')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical IV. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞)',
                'verbose_name_plural': 'historical IV. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞)s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec3ToxSanPin',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('state_in_air', models.CharField(blank=True, choices=[('P', '–ü–∞—Ä—ã (–ø)'), ('A', '–ê—ç—Ä–æ–∑–æ–ª—å (–∞)'), ('PA', '–°–º–µ—Å—å (–ø+–∞)')], max_length=10, verbose_name='–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ —Ä–∞–±. –∑–æ–Ω—ã')),
                ('pdk_workzone', models.CharField(blank=True, max_length=100, verbose_name='–ü–î–ö —Ä–∞–±. –∑–æ–Ω—ã (–º–≥/–º3)')),
                ('ld50_stomach', models.CharField(blank=True, max_length=100, verbose_name='LD50 –∂–µ–ª—É–¥–æ–∫')),
                ('ld50_skin', models.CharField(blank=True, max_length=100, verbose_name='LD50 –∫–æ–∂–∞')),
                ('lc50_air', models.CharField(blank=True, max_length=100, verbose_name='LC50 –≤–æ–∑–¥—É—Ö')),
                ('kvio', models.CharField(blank=True, max_length=100, verbose_name='–ö–í–ò–û')),
                ('zone_acute', models.CharField(blank=True, max_length=100, verbose_name='–ó–æ–Ω–∞ –æ—Å—Ç—Ä–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è')),
                ('zone_chronic', models.CharField(blank=True, max_length=100, verbose_name='–ó–æ–Ω–∞ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical III. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–°–∞–Ω–ü–∏–ù)',
                'verbose_name_plural': 'historical III. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–°–∞–Ω–ü–∏–ù)s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec2Physical',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('appearance', models.CharField(blank=True, choices=[('SOLID', '–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ'), ('LIQUID', '–ñ–∏–¥–∫–æ—Å—Ç—å'), ('GAS', '–ì–∞–∑'), ('VAPOR', '–ü–∞—Ä'), ('AEROSOL', '–ê—ç—Ä–æ–∑–æ–ª—å')], max_length=50, verbose_name='–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ')),
                ('odor', models.CharField(choices=[('NONE', '–ë–µ–∑ –∑–∞–ø–∞—Ö–∞'), ('SHARP', '–†–µ–∑–∫–∏–π'), ('SPECIFIC', '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π'), ('FRUIT', '–§—Ä—É–∫—Ç–æ–≤—ã–π'), ('OTHER', '–î—Ä—É–≥–æ–µ (—Å–º. –æ–ø–∏—Å–∞–Ω–∏–µ)')], default='OTHER', max_length=50, verbose_name='–ó–∞–ø–∞—Ö')),
                ('color', models.CharField(blank=True, max_length=100, verbose_name='–¶–≤–µ—Ç')),
                ('ph', models.CharField(blank=True, max_length=100, verbose_name='pH')),
                ('mol_mass', models.CharField(blank=True, max_length=100, verbose_name='–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞')),
                ('boiling_point', models.CharField(blank=True, max_length=100, verbose_name='–¢ –∫–∏–ø–µ–Ω–∏—è (¬∞C)')),
                ('melting_point', models.CharField(blank=True, max_length=100, verbose_name='–¢ –ø–ª–∞–≤–ª–µ–Ω–∏—è (¬∞C)')),
                ('auto_ignition', models.CharField(blank=True, max_length=100, verbose_name='–¢ —Å–∞–º–æ–≤–æ—Å–ø–ª–∞–º–µ–Ω–µ–Ω–∏—è (¬∞C)')),
                ('density', models.CharField(blank=True, max_length=100, verbose_name='–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–≥/—Å–º3)')),
                ('solubility_water', models.CharField(blank=True, max_length=255, verbose_name='–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å –≤ –≤–æ–¥–µ')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical II. –§–∏–∑-—Ö–∏–º —Å–≤–æ–π—Å—Ç–≤–∞',
                'verbose_name_plural': 'historical II. –§–∏–∑-—Ö–∏–º —Å–≤–æ–π—Å—Ç–≤–∞s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec23Extra',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('recommendations', models.TextField(blank=True, verbose_name='–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ / –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XXIII. –î–æ–ø. –∏–Ω—Ñ–æ',
                'verbose_name_plural': 'historical XXIII. –î–æ–ø. –∏–Ω—Ñ–æs',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec22Volumes',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('vol_production', models.CharField(blank=True, max_length=100, verbose_name='–û–±—ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞')),
                ('vol_import', models.CharField(blank=True, max_length=100, verbose_name='–û–±—ä–µ–º –∏–º–ø–æ—Ä—Ç–∞')),
                ('vol_export', models.CharField(blank=True, max_length=100, verbose_name='–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XXII. –û–±—ä–µ–º—ã',
                'verbose_name_plural': 'historical XXII. –û–±—ä–µ–º—ãs',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec21Companies',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('info', models.TextField(blank=True, verbose_name='–î–∞–Ω–Ω—ã–µ –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö (–ø—Ä–æ–∏–∑–≤./–∏–º–ø–æ—Ä—Ç.)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XXI. –ö–æ–º–ø–∞–Ω–∏–∏',
                'verbose_name_plural': 'historical XXI. –ö–æ–º–ø–∞–Ω–∏–∏s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec20Docs',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('gost_standards', models.TextField(blank=True, verbose_name='–ì–û–°–¢—ã / –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã')),
                ('intl_docs', models.TextField(blank=True, verbose_name='–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XX. –î–æ–∫—É–º–µ–Ω—Ç—ã',
                'verbose_name_plural': 'historical XX. –î–æ–∫—É–º–µ–Ω—Ç—ãs',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec1Identification',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('synonyms', models.TextField(blank=True, verbose_name='–°–∏–Ω–æ–Ω–∏–º—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)')),
                ('molecular_formula', models.CharField(blank=True, max_length=255, verbose_name='–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞')),
                ('structural_formula', models.TextField(blank=True, verbose_name='–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞')),
                ('ec_number', models.CharField(blank=True, max_length=50, verbose_name='–ù–æ–º–µ—Ä –ï–°')),
                ('iupac_name_ru', models.TextField(blank=True, verbose_name='IUPAC (RU)')),
                ('iupac_name_en', models.TextField(blank=True, verbose_name='IUPAC (EN)')),
                ('tnved_code', models.CharField(blank=True, max_length=50, verbose_name='–ö–æ–¥ –¢–ù –í–≠–î')),
                ('rtecs_link', models.CharField(blank=True, max_length=255, verbose_name='RTECS')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical I. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è',
                'verbose_name_plural': 'historical I. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ès',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec18InternationalReg',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('ozone_destroying', models.BooleanField(default=False, verbose_name='–û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–µ (–ú–æ–Ω—Ä–µ–∞–ª—å)')),
                ('pops', models.BooleanField(default=False, verbose_name='–°–û–ó (–°—Ç–æ–∫–≥–æ–ª—å–º)')),
                ('pic', models.BooleanField(default=False, verbose_name='–ü—Ä–µ–¥–≤. —Å–æ–≥–ª–∞—Å–∏–µ (–†–æ—Ç—Ç–µ—Ä–¥–∞–º)')),
                ('mercury', models.BooleanField(default=False, verbose_name='–†—Ç—É—Ç—å (–ú–∏–Ω–∞–º–∞—Ç–∞)')),
                ('basel', models.BooleanField(default=False, verbose_name='–ë–∞–∑–µ–ª—å—Å–∫–∞—è –∫–æ–Ω–≤.')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XVIII. –ú–µ–∂–¥. —Ä–µ–≥—É–ª—è—Ü–∏—è',
                'verbose_name_plural': 'historical XVIII. –ú–µ–∂–¥. —Ä–µ–≥—É–ª—è—Ü–∏—ès',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec17Incidents',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('accident_history', models.TextField(blank=True, verbose_name='–ò—Å—Ç–æ—Ä–∏—è –∞–≤–∞—Ä–∏–π / –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XVII. –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã',
                'verbose_name_plural': 'historical XVII. –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ãs',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec16Waste',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('collection', models.TextField(blank=True, verbose_name='–°–±–æ—Ä')),
                ('transport', models.TextField(blank=True, verbose_name='–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞')),
                ('disposal', models.TextField(blank=True, verbose_name='–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è')),
                ('burial', models.TextField(blank=True, verbose_name='–ó–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏–µ')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XVI. –û—Ç—Ö–æ–¥—ã',
                'verbose_name_plural': 'historical XVI. –û—Ç—Ö–æ–¥—ãs',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec15Storage',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('temp_conditions', models.CharField(blank=True, max_length=100, verbose_name='–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞')),
                ('humidity', models.CharField(blank=True, max_length=100, verbose_name='–í–ª–∞–∂–Ω–æ—Å—Ç—å')),
                ('shelf_life', models.CharField(blank=True, max_length=100, verbose_name='–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è')),
                ('storage_reqs', models.TextField(blank=True, verbose_name='–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é')),
                ('incompatible', models.TextField(blank=True, verbose_name='–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤-–≤–∞')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XV. –•—Ä–∞–Ω–µ–Ω–∏–µ',
                'verbose_name_plural': 'historical XV. –•—Ä–∞–Ω–µ–Ω–∏–µs',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec14Safety',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('prevent_health', models.TextField(blank=True, verbose_name='–ù–∞ –∑–¥–æ—Ä–æ–≤—å–µ (–°–ò–ó)')),
                ('first_aid', models.TextField(blank=True, verbose_name='–ü–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å')),
                ('prevent_env', models.TextField(blank=True, verbose_name='–ú–µ—Ä—ã –¥–ª—è —ç–∫–æ–ª–æ–≥–∏–∏')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XIV. –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                'verbose_name_plural': 'historical XIV. –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec13GHSLabel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('signal_word', models.CharField(choices=[('DANGER', '–û–ü–ê–°–ù–û (Danger)'), ('WARNING', '–û–°–¢–û–†–û–ñ–ù–û (Warning)'), ('NONE', '–ù–µ—Ç')], default='NONE', max_length=20, verbose_name='–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ')),
                ('pictogram_code', models.CharField(blank=True, help_text='–ù–∞–ø—Ä–∏–º–µ—Ä: GHS01, GHS02...', max_length=100, verbose_name='–ö–æ–¥—ã –ø–∏–∫—Ç–æ–≥—Ä–∞–º–º')),
                ('h_phrases', models.TextField(blank=True, verbose_name='H-—Ñ—Ä–∞–∑—ã')),
                ('p_phrases', models.TextField(blank=True, verbose_name='P-—Ñ—Ä–∞–∑—ã')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XIII. –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°',
                'verbose_name_plural': 'historical XIII. –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec12GHSClass',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('phys_hazard', models.TextField(blank=True, verbose_name='–§–∏–∑–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏')),
                ('chem_hazard', models.TextField(blank=True, verbose_name='–•–∏–º–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏')),
                ('env_hazard', models.TextField(blank=True, verbose_name='–û–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–∫—Ä. —Å—Ä–µ–¥—ã')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XII. –ö–ª–∞—Å—Å—ã –°–ì–°',
                'verbose_name_plural': 'historical XII. –ö–ª–∞—Å—Å—ã –°–ì–°s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec11HazardClass',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('sanpin_class', models.CharField(choices=[('1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'), ('3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=3, verbose_name='–ö–ª–∞—Å—Å (–°–∞–Ω–ü–∏–ù 0294-11)')),
                ('gost_body_class', models.CharField(choices=[('1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'), ('3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=3, verbose_name='–ö–ª–∞—Å—Å (–ì–û–°–¢ 12.1.007)')),
                ('gost_env_class', models.CharField(choices=[('1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'), ('3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'), ('4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'), ('NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è')], default='NC', max_length=3, verbose_name='–ö–ª–∞—Å—Å (–ì–û–°–¢ 32424)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical XI. –ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                'verbose_name_plural': 'historical XI. –ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSec10Water',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('acute_fish', models.CharField(blank=True, max_length=100, verbose_name='–û—Å—Ç—Ä–∞—è (–†—ã–±—ã LC50)')),
                ('acute_algae', models.CharField(blank=True, max_length=100, verbose_name='–û—Å—Ç—Ä–∞—è (–í–æ–¥–æ—Ä–æ—Å–ª–∏ LC50)')),
                ('chronic_fish', models.CharField(blank=True, max_length=100, verbose_name='–•—Ä–æ–Ω–∏—á. (–†—ã–±—ã)')),
                ('bioacc_logkow', models.CharField(blank=True, max_length=100, verbose_name='Potencial LogKow')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical X. –í–æ–¥–Ω–∞—è —Å—Ä–µ–¥–∞',
                'verbose_name_plural': 'historical X. –í–æ–¥–Ω–∞—è —Å—Ä–µ–¥–∞s',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalElementAttachment',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('file', models.TextField(max_length=100, verbose_name='–§–∞–π–ª')),
                ('description', models.CharField(blank=True, max_length=255, verbose_name='–û–ø–∏—Å–∞–Ω–∏–µ')),
                ('doc_type', models.CharField(choices=[('PASSPORT', '–ü–∞—Å–ø–æ—Ä—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (MSDS)'), ('CERTIFICATE', '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è'), ('LAB_PROTOCOL', '–ü—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø—ã—Ç–∞–Ω–∏–π'), ('DECLARATION', '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è'), ('OTHER', '–î—Ä—É–≥–æ–µ')], default='OTHER', max_length=50, verbose_name='–¢–∏–ø')),
                ('uploaded_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('element', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='registry.chemicalelement')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical –§–∞–π–ª',
                'verbose_name_plural': 'historical –§–∞–π–ª—ã',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalChemicalElement',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('status', models.CharField(choices=[('DRAFT', '–ß–µ—Ä–Ω–æ–≤–∏–∫'), ('PENDING', '–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ'), ('PUBLISHED', '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ'), ('REJECTED', '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ')], default='DRAFT', max_length=20, verbose_name='–°—Ç–∞—Ç—É—Å')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è')),
                ('cas_number', models.CharField(blank=True, db_index=True, max_length=50, null=True, verbose_name='–ù–æ–º–µ—Ä CAS')),
                ('primary_name_ru', models.CharField(db_index=True, max_length=500, verbose_name='–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='–ê–≤—Ç–æ—Ä')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical –•–∏–º–∏—á–µ—Å–∫–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ',
                'verbose_name_plural': 'historical –•–∏–º–∏—á–µ—Å–∫–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='ElementAttachment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file', models.FileField(upload_to='documents/%Y/%m/', verbose_name='–§–∞–π–ª')),
                ('description', models.CharField(blank=True, max_length=255, verbose_name='–û–ø–∏—Å–∞–Ω–∏–µ')),
                ('doc_type', models.CharField(choices=[('PASSPORT', '–ü–∞—Å–ø–æ—Ä—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (MSDS)'), ('CERTIFICATE', '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è'), ('LAB_PROTOCOL', '–ü—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø—ã—Ç–∞–Ω–∏–π'), ('DECLARATION', '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è'), ('OTHER', '–î—Ä—É–≥–æ–µ')], default='OTHER', max_length=50, verbose_name='–¢–∏–ø')),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('element', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attachments', to='registry.chemicalelement')),
            ],
            options={
                'verbose_name': '–§–∞–π–ª',
                'verbose_name_plural': '–§–∞–π–ª—ã',
            },
        ),
    ]


==================================================
FILE: .\backend\registry\migrations\0002_registryconfig_template_fields.py
==================================================
# Generated by Django 4.2.27 on 2025-12-05 20:03

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registry', '0001_initial'),
    ]

    operations = [
        migrations.AddField(
            model_name='registryconfig',
            name='template_fields',
            field=models.JSONField(blank=True, default=list, verbose_name='–ö–æ–ª–æ–Ω–∫–∏ –≤ —à–∞–±–ª–æ–Ω–µ Excel'),
        ),
    ]


==================================================
FILE: .\backend\registry\migrations\0003_trigger_trigram.py
==================================================
from django.db import migrations
from django.contrib.postgres.operations import TrigramExtension # <--- –í–ê–ñ–ù–´–ô –ò–ú–ü–û–†–¢

class Migration(migrations.Migration):

    dependencies = [
        ('registry', '0002_registryconfig_template_fields'), # –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–µ–π –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏
        # –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç 0001_initial, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏
    ]

    operations = [
        TrigramExtension(), # <--- –í–û–¢ –≠–¢–û –ì–õ–ê–í–ù–û–ï
    ]

==================================================
FILE: .\backend\registry\migrations\0004_registryconfig_public_list_fields.py
==================================================
# Generated by Django 4.2.27 on 2025-12-06 01:17

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registry', '0003_trigger_trigram'),
    ]

    operations = [
        migrations.AddField(
            model_name='registryconfig',
            name='public_list_fields',
            field=models.JSONField(blank=True, default=list, verbose_name='–ü–æ–ª—è –ü—É–±–ª–∏—á–Ω–æ–π –¢–∞–±–ª–∏—Ü—ã'),
        ),
    ]


==================================================
FILE: .\backend\registry\migrations\0005_registryconfig_filter_fields.py
==================================================
# Generated by Django 4.2.27 on 2025-12-08 19:06

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registry', '0004_registryconfig_public_list_fields'),
    ]

    operations = [
        migrations.AddField(
            model_name='registryconfig',
            name='filter_fields',
            field=models.JSONField(blank=True, default=list, verbose_name='–ü–æ–ª—è –¥–ª—è –§–∏–ª—å—Ç—Ä–æ–≤ (–°–∞–π–¥–±–∞—Ä)'),
        ),
    ]


==================================================
FILE: .\backend\registry\migrations\0006_historicalsec1identification_structure_image_and_more.py
==================================================
# Generated by Django 4.2.27 on 2025-12-08 20:50

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registry', '0005_registryconfig_filter_fields'),
    ]

    operations = [
        migrations.AddField(
            model_name='historicalsec1identification',
            name='structure_image',
            field=models.TextField(blank=True, max_length=100, null=True, verbose_name='–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã'),
        ),
        migrations.AddField(
            model_name='sec1identification',
            name='structure_image',
            field=models.ImageField(blank=True, null=True, upload_to='structures/', verbose_name='–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã'),
        ),
    ]


==================================================
FILE: .\backend\registry\migrations\0007_alter_chemicalelement_primary_name_ru_and_more.py
==================================================
# Generated by Django 4.2.27 on 2025-12-08 21:50

import django.contrib.postgres.indexes
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registry', '0006_historicalsec1identification_structure_image_and_more'),
    ]

    operations = [
        migrations.AlterField(
            model_name='chemicalelement',
            name='primary_name_ru',
            field=models.CharField(max_length=500, verbose_name='–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)'),
        ),
        migrations.AlterField(
            model_name='historicalchemicalelement',
            name='primary_name_ru',
            field=models.CharField(max_length=500, verbose_name='–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)'),
        ),
        migrations.AddIndex(
            model_name='chemicalelement',
            index=django.contrib.postgres.indexes.GinIndex(fields=['primary_name_ru'], name='chem_name_gin_idx', opclasses=['gin_trgm_ops']),
        ),
        migrations.AddIndex(
            model_name='chemicalelement',
            index=models.Index(fields=['status'], name='registry_ch_status_795b8c_idx'),
        ),
        migrations.AddIndex(
            model_name='chemicalelement',
            index=models.Index(fields=['created_by'], name='registry_ch_created_09a97a_idx'),
        ),
    ]


==================================================
FILE: .\backend\registry\migrations\__init__.py
==================================================


==================================================
FILE: .\backend\registry\models\common.py
==================================================
from django.db import models
from django.core.exceptions import ValidationError

class HazardClassChoices(models.TextChoices):
    CLASS_1 = '1', '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'
    CLASS_2 = '2', '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ'
    CLASS_3 = '3', '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ'
    CLASS_4 = '4', '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ'
    NC = 'NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è'  # <--- –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û –ó–î–ï–°–¨ (NOT_CLASSIFIED -> NC)

class YesNoUnknown(models.TextChoices):
    YES = 'YES', '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'
    NO = 'NO', '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç'
    UNKNOWN = 'UNKNOWN', '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π'

class CategoriesGHS(models.TextChoices):
    CAT_1 = '1', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1'
    CAT_1A = '1A', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A'
    CAT_1B = '1B', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B'
    CAT_2 = '2', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2'
    CAT_3 = '3', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3'
    NC = 'NC', '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è'


class RegistryConfig(models.Model):
    """
    –ú–æ–¥–µ–ª—å –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –†–µ–µ—Å—Ç—Ä–∞.
    –†–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Singleton (–≤—Å–µ–≥–¥–∞ —Ç–æ–ª—å–∫–æ 1 –∑–∞–ø–∏—Å—å).
    """
    # –ó–¥–µ—Å—å –º—ã –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∞–¥–º–∏–Ω –æ—Ç–º–µ—Ç–∏–ª –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
    # –ü—Ä–∏–º–µ—Ä: ["cas_number", "ph", "pdk_workzone"]
    required_fields = models.JSONField(default=list, blank=True, verbose_name="–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è")
    template_fields = models.JSONField(default=list, blank=True, verbose_name="–ö–æ–ª–æ–Ω–∫–∏ –≤ —à–∞–±–ª–æ–Ω–µ Excel")
    public_list_fields = models.JSONField(default=list, blank=True, verbose_name="–ü–æ–ª—è –ü—É–±–ª–∏—á–Ω–æ–π –¢–∞–±–ª–∏—Ü—ã")
    filter_fields = models.JSONField(default=list, blank=True, verbose_name="–ü–æ–ª—è –¥–ª—è –§–∏–ª—å—Ç—Ä–æ–≤ (–°–∞–π–¥–±–∞—Ä)")
    updated_at = models.DateTimeField(auto_now=True, verbose_name="–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫")

    def save(self, *args, **kwargs):
        # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∑–∞–ø–∏—Å—å –≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞ (ID=1)
        self.pk = 1
        super(RegistryConfig, self).save(*args, **kwargs)

    def __str__(self):
        return "–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"

    class Meta:
        verbose_name = "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ü–æ–ª–µ–π"
        verbose_name_plural = "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ü–æ–ª–µ–π"


class ConfigValidationMixin:
    """
    –ú–∏–∫—Å–∏–Ω, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
    –ü–æ–¥–∫–ª—é—á–∞–µ–º –µ–≥–æ –∫–æ –≤—Å–µ–º –º–æ–¥–µ–ª—è–º (–†–∞–∑–¥–µ–ª–∞–º –∏ –ì–ª–∞–≤–Ω–æ–π).
    """
    def clean(self):
        # 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–°–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫: ['cas_number', 'ph', ...])
        try:
            # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–ª—å—Ü–µ–≤—ã—Ö —Å—Å—ã–ª–æ–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Django
            from registry.models import RegistryConfig
            config = RegistryConfig.objects.first()
            if not config:
                super().clean()
                return
            required_list = config.required_fields
        except Exception:
            super().clean()
            return

        # 2. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–æ–ª—è –¢–ï–ö–£–©–ï–ô –º–æ–¥–µ–ª–∏
        # (–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ self —ç—Ç–æ Sec2Physical, —Ç—É—Ç –±—É–¥—É—Ç 'ph', 'odor' –∏ —Ç.–¥.)
        my_fields = [f.name for f in self._meta.get_fields()]

        # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º: –µ—Å—Ç—å –ª–∏ —Å—Ä–µ–¥–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—à–∏ –ø–æ–ª—è?
        for field_name in required_list:
            if field_name in my_fields:
                # –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
                value = getattr(self, field_name)

                # –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—É—Å—Ç–æ–µ (None, "", False)
                # –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è BooleanField False —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º, –Ω–æ –µ—Å–ª–∏ –≤–∞–º –Ω–∞–¥–æ
                # –∑–∞—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–º–µ—Ç–∏—Ç—å –≥–∞–ª–æ—á–∫—É "–î–∞", –ª–æ–≥–∏–∫—É –º–æ–∂–Ω–æ —É—Å–ª–æ–∂–Ω–∏—Ç—å.
                # –ü–æ–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø—É—Å—Ç–æ—Ç—É —Ç–µ–∫—Å—Ç–∞/–≤—ã–±–æ—Ä–∞.
                if value is None or value == "":
                    raise ValidationError({
                        field_name: "–≠—Ç–æ –ø–æ–ª–µ –æ—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–µ—Å—Ç—Ä–∞."
                    })

        super().clean()

==================================================
FILE: .\backend\registry\models\core.py
==================================================
from django.conf import settings
from simple_history.models import HistoricalRecords
from django.db import models
# –í–ê–ñ–ù–û: –ò–º–ø–æ—Ä—Ç GinIndex –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
from django.contrib.postgres.indexes import GinIndex
from .common import ConfigValidationMixin


class ChemicalElement(ConfigValidationMixin, models.Model):
    class Status(models.TextChoices):
        DRAFT = 'DRAFT', '–ß–µ—Ä–Ω–æ–≤–∏–∫'
        PENDING = 'PENDING', '–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ'
        PUBLISHED = 'PUBLISHED', '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ'
        REJECTED = 'REJECTED', '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ'

    created_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, verbose_name="–ê–≤—Ç–æ—Ä")
    status = models.CharField(max_length=20, choices=Status.choices, default=Status.DRAFT, verbose_name="–°—Ç–∞—Ç—É—Å")
    created_at = models.DateTimeField(auto_now_add=True, verbose_name="–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è")
    updated_at = models.DateTimeField(auto_now=True, verbose_name="–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è")

    # –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –ø–æ–ª—è
    cas_number = models.CharField(max_length=50, unique=True, null=True, blank=True, verbose_name="–ù–æ–º–µ—Ä CAS", db_index=True)
    primary_name_ru = models.CharField(max_length=500, verbose_name="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)")

    history = HistoricalRecords()

    def __str__(self):
        return f"{self.primary_name_ru} (CAS: {self.cas_number})"

    class Meta:
        verbose_name = "–•–∏–º–∏—á–µ—Å–∫–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ"
        verbose_name_plural = "–•–∏–º–∏—á–µ—Å–∫–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞"
        ordering = ['-updated_at']

        # === –ò–ù–î–ï–ö–°–´ –î–õ–Ø –£–°–ö–û–†–ï–ù–ò–Ø ===
        indexes = [
            # 1. GIN –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ pg_trgm)
            # –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –¥–µ–ª–∞—Ç—å ilike –∑–∞–ø—Ä–æ—Å—ã
            GinIndex(
                name='chem_name_gin_idx',
                fields=['primary_name_ru'],
                opclasses=['gin_trgm_ops']
            ),
            # 2. –ò–Ω–¥–µ–∫—Å –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ (—á–∞—Å—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
            models.Index(fields=['status']),
            # 3. –ò–Ω–¥–µ–∫—Å –¥–ª—è –∞–≤—Ç–æ—Ä–∞ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –∫–∞–±–∏–Ω–µ—Ç–µ)
            models.Index(fields=['created_by']),
        ]


class ElementAttachment(models.Model):
    class DocType(models.TextChoices):
        PASSPORT = 'PASSPORT', '–ü–∞—Å–ø–æ—Ä—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (MSDS)'
        CERTIFICATE = 'CERTIFICATE', '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è'
        LAB_PROTOCOL = 'LAB_PROTOCOL', '–ü—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø—ã—Ç–∞–Ω–∏–π'
        DECLARATION = 'DECLARATION', '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è'
        OTHER = 'OTHER', '–î—Ä—É–≥–æ–µ'

    element = models.ForeignKey(ChemicalElement, on_delete=models.CASCADE, related_name='attachments')
    file = models.FileField(upload_to='documents/%Y/%m/', verbose_name="–§–∞–π–ª")
    description = models.CharField(max_length=255, blank=True, verbose_name="–û–ø–∏—Å–∞–Ω–∏–µ")
    doc_type = models.CharField(max_length=50, choices=DocType.choices, default=DocType.OTHER, verbose_name="–¢–∏–ø")
    uploaded_at = models.DateTimeField(auto_now_add=True)

    history = HistoricalRecords()

    def __str__(self): return self.file.name

    class Meta:
        verbose_name = "–§–∞–π–ª"
        verbose_name_plural = "–§–∞–π–ª—ã"

==================================================
FILE: .\backend\registry\models\identification.py
==================================================
from .core import ChemicalElement
from django.db import models
from simple_history.models import HistoricalRecords
from .common import ConfigValidationMixin

class Sec1Identification(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec1_identification')

    structure_image = models.ImageField(upload_to='structures/', blank=True, null=True, verbose_name="–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã")
    synonyms = models.TextField(blank=True, verbose_name="–°–∏–Ω–æ–Ω–∏–º—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)")
    molecular_formula = models.CharField(max_length=255, blank=True, verbose_name="–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞")
    structural_formula = models.TextField(blank=True, verbose_name="–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞")
    ec_number = models.CharField(max_length=50, blank=True, verbose_name="–ù–æ–º–µ—Ä –ï–°")
    iupac_name_ru = models.TextField(blank=True, verbose_name="IUPAC (RU)")
    iupac_name_en = models.TextField(blank=True, verbose_name="IUPAC (EN)")
    tnved_code = models.CharField(max_length=50, blank=True, verbose_name="–ö–æ–¥ –¢–ù –í–≠–î")
    rtecs_link = models.CharField(max_length=255, blank=True, verbose_name="RTECS")
    history = HistoricalRecords()

    class Meta: verbose_name = "I. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è"

==================================================
FILE: .\backend\registry\models\physical.py
==================================================
from .core import *
from .common  import *
from simple_history.models import HistoricalRecords
from django.db import models
from .common import ConfigValidationMixin

class Sec2Physical(ConfigValidationMixin, models.Model):
    class Appearance(models.TextChoices):
        SOLID = 'SOLID', '–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ'
        LIQUID = 'LIQUID', '–ñ–∏–¥–∫–æ—Å—Ç—å'
        GAS = 'GAS', '–ì–∞–∑'
        VAPOR = 'VAPOR', '–ü–∞—Ä'
        AEROSOL = 'AEROSOL', '–ê—ç—Ä–æ–∑–æ–ª—å'

    class Odor(models.TextChoices):
        ODORLESS = 'NONE', '–ë–µ–∑ –∑–∞–ø–∞—Ö–∞'
        SHARP = 'SHARP', '–†–µ–∑–∫–∏–π'
        SPECIFIC = 'SPECIFIC', '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π'
        FRUIT = 'FRUIT', '–§—Ä—É–∫—Ç–æ–≤—ã–π'
        OTHER = 'OTHER', '–î—Ä—É–≥–æ–µ (—Å–º. –æ–ø–∏—Å–∞–Ω–∏–µ)'

    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec2_physical')

    appearance = models.CharField(max_length=50, choices=Appearance.choices, blank=True, verbose_name="–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ")
    odor = models.CharField(max_length=50, choices=Odor.choices, default=Odor.OTHER, verbose_name="–ó–∞–ø–∞—Ö")

    color = models.CharField(max_length=100, blank=True, verbose_name="–¶–≤–µ—Ç")
    ph = models.CharField(max_length=100, blank=True, verbose_name="pH")
    mol_mass = models.CharField(max_length=100, blank=True, verbose_name="–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞")

    boiling_point = models.CharField(max_length=100, blank=True, verbose_name="–¢ –∫–∏–ø–µ–Ω–∏—è (¬∞C)")
    melting_point = models.CharField(max_length=100, blank=True, verbose_name="–¢ –ø–ª–∞–≤–ª–µ–Ω–∏—è (¬∞C)")
    auto_ignition = models.CharField(max_length=100, blank=True, verbose_name="–¢ —Å–∞–º–æ–≤–æ—Å–ø–ª–∞–º–µ–Ω–µ–Ω–∏—è (¬∞C)")

    density = models.CharField(max_length=100, blank=True, verbose_name="–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–≥/—Å–º3)")
    solubility_water = models.CharField(max_length=255, blank=True, verbose_name="–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å –≤ –≤–æ–¥–µ")
    history = HistoricalRecords()

    class Meta: verbose_name = "II. –§–∏–∑-—Ö–∏–º —Å–≤–æ–π—Å—Ç–≤–∞"

==================================================
FILE: .\backend\registry\models\properties.py
==================================================
from simple_history.models import HistoricalRecords
from django.db import models
from .core import *
from .common import *
from django.utils.translation import gettext_lazy as _
from django.conf import settings
from .common import ConfigValidationMixin


class Sec3ToxSanPin(ConfigValidationMixin, models.Model):
    class StateAir(models.TextChoices):
        VAPOR = 'P', '–ü–∞—Ä—ã (–ø)'
        AEROSOL = 'A', '–ê—ç—Ä–æ–∑–æ–ª—å (–∞)'
        MIX = 'PA', '–°–º–µ—Å—å (–ø+–∞)'

    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec3_sanpin')

    state_in_air = models.CharField(max_length=10, choices=StateAir.choices, blank=True, verbose_name="–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ —Ä–∞–±. –∑–æ–Ω—ã")

    pdk_workzone = models.CharField(max_length=100, blank=True, verbose_name="–ü–î–ö —Ä–∞–±. –∑–æ–Ω—ã (–º–≥/–º3)")
    ld50_stomach = models.CharField(max_length=100, blank=True, verbose_name="LD50 –∂–µ–ª—É–¥–æ–∫")
    ld50_skin = models.CharField(max_length=100, blank=True, verbose_name="LD50 –∫–æ–∂–∞")
    lc50_air = models.CharField(max_length=100, blank=True, verbose_name="LC50 –≤–æ–∑–¥—É—Ö")
    kvio = models.CharField(max_length=100, blank=True, verbose_name="–ö–í–ò–û")
    zone_acute = models.CharField(max_length=100, blank=True, verbose_name="–ó–æ–Ω–∞ –æ—Å—Ç—Ä–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è")
    zone_chronic = models.CharField(max_length=100, blank=True, verbose_name="–ó–æ–Ω–∞ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è")
    history = HistoricalRecords()

    class Meta: verbose_name = "III. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–°–∞–Ω–ü–∏–ù)"

# ==========================================
# IV. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞
# ==========================================
class Sec4ToxAir(ConfigValidationMixin, models.Model):
    class LimitingSign(models.TextChoices):
        REFLEX = 'REFLEX', '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ–µ'
        RESORPTIVE = 'RESORPTIVE', '–†–µ–∑–æ—Ä–±—Ç–∏–≤–Ω–æ–µ'
        REFLEX_RESORPTIVE = 'REF_RES', '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ-—Ä–µ–∑–æ—Ä–±—Ç–∏–≤–Ω–æ–µ'
        SANITARY = 'SANITARY', '–°–∞–Ω–∏—Ç–∞—Ä–Ω–æ-–±—ã—Ç–æ–≤–æ–µ'

    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec4_air')

    limit_sign = models.CharField(max_length=20, choices=LimitingSign.choices, blank=True, verbose_name="–õ–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫")
    pdk_max_single = models.CharField(max_length=100, blank=True, verbose_name="–ú–∞–∫—Å. —Ä–∞–∑–æ–≤–∞—è –ü–î–ö")
    pdk_daily_avg = models.CharField(max_length=100, blank=True, verbose_name="–°—Ä–µ–¥–Ω–µ—Å—É—Ç–æ—á–Ω–∞—è –ü–î–ö")
    pdk_month_avg = models.CharField(max_length=100, blank=True, verbose_name="–°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –ü–î–ö")
    pdk_year_avg = models.CharField(max_length=100, blank=True, verbose_name="–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –ü–î–ö")
    history = HistoricalRecords()

    class Meta: verbose_name = "IV. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è (–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞)"

# ==========================================
# V. –û—Å—Ç—Ä–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å
# ==========================================
class Sec5ToxAcute(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec5_acute')

    inhalation_lc50_effect = models.CharField(max_length=20, choices=YesNoUnknown.choices, default=YesNoUnknown.UNKNOWN, verbose_name="–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç")
    inhalation_lc50_val = models.CharField(max_length=100, blank=True, verbose_name="–ó–Ω–∞—á–µ–Ω–∏–µ LC50 (–º–≥/–∫–≥)")

    dermal_ld50_effect = models.CharField(max_length=20, choices=YesNoUnknown.choices, default=YesNoUnknown.UNKNOWN, verbose_name="–î–µ—Ä–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç")
    dermal_ld50_val = models.CharField(max_length=100, blank=True, verbose_name="–ó–Ω–∞—á–µ–Ω–∏–µ LD50 (–º–≥/–∫–≥)")

    oral_ld50_effect = models.CharField(max_length=20, choices=YesNoUnknown.choices, default=YesNoUnknown.UNKNOWN, verbose_name="–ü–µ—Ä–æ—Ä–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç")
    oral_ld50_val = models.CharField(max_length=100, blank=True, verbose_name="–ó–Ω–∞—á–µ–Ω–∏–µ LD50 (–º–≥/–∫–≥)")
    history = HistoricalRecords()

    class Meta: verbose_name = "V. –û—Å—Ç—Ä–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å"

# ==========================================
# VI. –†–∏—Å–∫–∏ –°–ì–°
# ==========================================
class Sec6ToxRisks(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec6_risks')

    # –ú–µ–Ω—è–µ–º max_length=5 -> max_length=50 –≤–µ–∑–¥–µ
    skin_corr = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–†–∞–∑—ä–µ–¥–∞–Ω–∏–µ –∫–æ–∂–∏ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)")
    eye_dmg = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–ª–∞–∑ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)")
    sensitization = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–°–µ–Ω—Å–∏–±–∏–ª–∏–∑–∞—Ü–∏—è (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)")
    mutagenicity = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–ú—É—Ç–∞–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)")
    carcinogenicity = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)")
    repro_tox = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–†–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (–ö–∞—Ç.)")
    aspiration_hazard = models.CharField(max_length=50, choices=CategoriesGHS.choices, default=CategoriesGHS.NC, verbose_name="–ê—Å–ø–∏—Ä–∞—Ü–∏—è (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)")
    history = HistoricalRecords()

    class Meta: verbose_name = "VI. –†–∏—Å–∫–∏ (–°–ì–°)"

# ==========================================
# VIII. –≠–∫–æ-—Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è
# ==========================================
class Sec8EcoTox(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec8_ecotox')

    ld50_mammals = models.CharField(max_length=100, blank=True, verbose_name="LD50 –ú–ª–µ–∫–æ–ø–∏—Ç–∞—é—â–∏–µ")
    ld50_fish = models.CharField(max_length=100, blank=True, verbose_name="LD50 –†—ã–±—ã")
    ld50_bees = models.CharField(max_length=100, blank=True, verbose_name="LD50 –ü—á–µ–ª—ã")
    ld50_birds = models.CharField(max_length=100, blank=True, verbose_name="LD50 –ü—Ç–∏—Ü—ã")

    bioaccumulation = models.BooleanField(default=False, verbose_name="–ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è (–ï—Å—Ç—å/–ù–µ—Ç)")
    phytotoxicity = models.BooleanField(default=False, verbose_name="–§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å (–ï—Å—Ç—å/–ù–µ—Ç)")
    history = HistoricalRecords()

    class Meta: verbose_name = "VIII. –≠–∫–æ-—Ç–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è"

# ==========================================
# IX. –ü–æ—á–≤–∞
# ==========================================
class Sec9Soil(ConfigValidationMixin, models.Model):
    class Persistence(models.TextChoices):
        LOW = 'LOW', '–ú–∞–ª–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (<20 –¥–Ω–µ–π)'
        MEDIUM = 'MED', '–°—Ä–µ–¥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (20-90 –¥–Ω–µ–π)'
        HIGH = 'HIGH', '–£—Å—Ç–æ–π—á–∏–≤—ã–µ (>90 –¥–Ω–µ–π)'

    class Mobility(models.TextChoices):
        MOBILE = 'MOB', '–ü–æ–¥–≤–∏–∂–µ–Ω'
        IMMOBILE = 'IMM', '–ú–∞–ª–æ–ø–æ–¥–≤–∏–∂–µ–Ω'

    class Sorption(models.TextChoices):
        STRONG = 'STR', '–°–∏–ª—å–Ω–∞—è'
        WEAK = 'WEAK', '–°–ª–∞–±–∞—è'

    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec9_soil')

    pdk_soil = models.CharField(max_length=100, blank=True, verbose_name="–ü–î–ö –≤ –ø–æ—á–≤–µ")
    odk_soil = models.CharField(max_length=100, blank=True, verbose_name="–û–î–ö –≤ –ø–æ—á–≤–µ")

    # –ë—ã–ª–æ max_length=5, –º–µ–Ω—è–µ–º –Ω–∞ 50, —á—Ç–æ–±—ã —Å–ª–æ–≤–æ "–ù–∏–∑–∫–∞—è" (6 –±—É–∫–≤) –Ω–µ –ª–æ–º–∞–ª–æ –∏–º–ø–æ—Ä—Ç
    persistence = models.CharField(max_length=50, choices=Persistence.choices, blank=True, verbose_name="–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å")
    sorption = models.CharField(max_length=50, choices=Sorption.choices, blank=True, verbose_name="–°–æ—Ä–±—Ü–∏—è")
    migration = models.CharField(max_length=50, choices=Mobility.choices, blank=True, verbose_name="–ú–∏–≥—Ä–∞—Ü–∏—è")
    history = HistoricalRecords()

    class Meta: verbose_name = "IX. –ü–æ—á–≤–∞"

# ==========================================
# X. –í–æ–¥–Ω–∞—è —Å—Ä–µ–¥–∞
# ==========================================
class Sec10Water(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec10_water')
    acute_fish = models.CharField(max_length=100, blank=True, verbose_name="–û—Å—Ç—Ä–∞—è (–†—ã–±—ã LC50)")
    acute_algae = models.CharField(max_length=100, blank=True, verbose_name="–û—Å—Ç—Ä–∞—è (–í–æ–¥–æ—Ä–æ—Å–ª–∏ LC50)")
    chronic_fish = models.CharField(max_length=100, blank=True, verbose_name="–•—Ä–æ–Ω–∏—á. (–†—ã–±—ã)")
    bioacc_logkow = models.CharField(max_length=100, blank=True, verbose_name="Potencial LogKow")
    history = HistoricalRecords()

    class Meta: verbose_name = "X. –í–æ–¥–Ω–∞—è —Å—Ä–µ–¥–∞"

# ==========================================
# XI. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# ==========================================
class Sec11HazardClass(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec11_class')

    # –ò–°–ü–û–õ–¨–ó–£–ï–ú –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô HazardClassChoices.NC
    sanpin_class = models.CharField(max_length=3, choices=HazardClassChoices.choices, default=HazardClassChoices.NC, verbose_name="–ö–ª–∞—Å—Å (–°–∞–Ω–ü–∏–ù 0294-11)")
    gost_body_class = models.CharField(max_length=3, choices=HazardClassChoices.choices, default=HazardClassChoices.NC, verbose_name="–ö–ª–∞—Å—Å (–ì–û–°–¢ 12.1.007)")
    gost_env_class = models.CharField(max_length=3, choices=HazardClassChoices.choices, default=HazardClassChoices.NC, verbose_name="–ö–ª–∞—Å—Å (–ì–û–°–¢ 32424)")
    history = HistoricalRecords()

    class Meta: verbose_name = "XI. –ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏"

# ==========================================
# XII. –°–ì–° –ö–ª–∞—Å—Å—ã
# ==========================================
class Sec12GHSClass(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec12_ghs')
    phys_hazard = models.TextField(blank=True, verbose_name="–§–∏–∑–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
    chem_hazard = models.TextField(blank=True, verbose_name="–•–∏–º–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
    env_hazard = models.TextField(blank=True, verbose_name="–û–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–∫—Ä. —Å—Ä–µ–¥—ã")
    history = HistoricalRecords()

    class Meta: verbose_name = "XII. –ö–ª–∞—Å—Å—ã –°–ì–°"

# ==========================================
# XIII. –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°
# ==========================================
class Sec13GHSLabel(ConfigValidationMixin, models.Model):
    class SignalWord(models.TextChoices):
        DANGER = 'DANGER', '–û–ü–ê–°–ù–û (Danger)'
        WARNING = 'WARNING', '–û–°–¢–û–†–û–ñ–ù–û (Warning)'
        NONE = 'NONE', '–ù–µ—Ç'

    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec13_label')

    signal_word = models.CharField(max_length=20, choices=SignalWord.choices, default=SignalWord.NONE, verbose_name="–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ")
    pictogram_code = models.CharField(max_length=100, blank=True, help_text="–ù–∞–ø—Ä–∏–º–µ—Ä: GHS01, GHS02...", verbose_name="–ö–æ–¥—ã –ø–∏–∫—Ç–æ–≥—Ä–∞–º–º")
    h_phrases = models.TextField(blank=True, verbose_name="H-—Ñ—Ä–∞–∑—ã")
    p_phrases = models.TextField(blank=True, verbose_name="P-—Ñ—Ä–∞–∑—ã")
    history = HistoricalRecords()

    class Meta: verbose_name = "XIII. –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°"

# ==========================================
# –û–°–¢–ê–õ–¨–ù–´–ï –°–ï–ö–¶–ò–ò
# ==========================================
class Sec14Safety(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec14_safety')
    prevent_health = models.TextField(blank=True, verbose_name="–ù–∞ –∑–¥–æ—Ä–æ–≤—å–µ (–°–ò–ó)")
    first_aid = models.TextField(blank=True, verbose_name="–ü–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å")
    prevent_env = models.TextField(blank=True, verbose_name="–ú–µ—Ä—ã –¥–ª—è —ç–∫–æ–ª–æ–≥–∏–∏")
    history = HistoricalRecords()
    class Meta: verbose_name = "XIV. –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"

class Sec15Storage(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec15_storage')
    temp_conditions = models.CharField(max_length=100, blank=True, verbose_name="–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞")
    humidity = models.CharField(max_length=100, blank=True, verbose_name="–í–ª–∞–∂–Ω–æ—Å—Ç—å")
    shelf_life = models.CharField(max_length=100, blank=True, verbose_name="–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è")
    storage_reqs = models.TextField(blank=True, verbose_name="–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é")
    incompatible = models.TextField(blank=True, verbose_name="–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤-–≤–∞")
    history = HistoricalRecords()
    class Meta: verbose_name = "XV. –•—Ä–∞–Ω–µ–Ω–∏–µ"

class Sec16Waste(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec16_waste')
    collection = models.TextField(blank=True, verbose_name="–°–±–æ—Ä")
    transport = models.TextField(blank=True, verbose_name="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞")
    disposal = models.TextField(blank=True, verbose_name="–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è")
    burial = models.TextField(blank=True, verbose_name="–ó–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏–µ")
    history = HistoricalRecords()
    class Meta: verbose_name = "XVI. –û—Ç—Ö–æ–¥—ã"

class Sec17Incidents(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec17_incidents')

    accident_history = models.TextField(blank=True, verbose_name="–ò—Å—Ç–æ—Ä–∏—è –∞–≤–∞—Ä–∏–π / –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤")
    history = HistoricalRecords()
    class Meta: verbose_name = "XVII. –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã"

class Sec18InternationalReg(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec18_intl')
    ozone_destroying = models.BooleanField(default=False, verbose_name="–û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–µ (–ú–æ–Ω—Ä–µ–∞–ª—å)")
    pops = models.BooleanField(default=False, verbose_name="–°–û–ó (–°—Ç–æ–∫–≥–æ–ª—å–º)")
    pic = models.BooleanField(default=False, verbose_name="–ü—Ä–µ–¥–≤. —Å–æ–≥–ª–∞—Å–∏–µ (–†–æ—Ç—Ç–µ—Ä–¥–∞–º)")
    mercury = models.BooleanField(default=False, verbose_name="–†—Ç—É—Ç—å (–ú–∏–Ω–∞–º–∞—Ç–∞)")
    basel = models.BooleanField(default=False, verbose_name="–ë–∞–∑–µ–ª—å—Å–∫–∞—è –∫–æ–Ω–≤.")
    history = HistoricalRecords()
    class Meta: verbose_name = "XVIII. –ú–µ–∂–¥. —Ä–µ–≥—É–ª—è—Ü–∏—è"

class Sec20Docs(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec20_docs')
    gost_standards = models.TextField(blank=True, verbose_name="–ì–û–°–¢—ã / –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã")
    intl_docs = models.TextField(blank=True, verbose_name="–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã")
    history = HistoricalRecords()
    class Meta: verbose_name = "XX. –î–æ–∫—É–º–µ–Ω—Ç—ã"

class Sec21Companies(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec21_companies')
    info = models.TextField(blank=True, verbose_name="–î–∞–Ω–Ω—ã–µ –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö (–ø—Ä–æ–∏–∑–≤./–∏–º–ø–æ—Ä—Ç.)")
    history = HistoricalRecords()
    class Meta: verbose_name = "XXI. –ö–æ–º–ø–∞–Ω–∏–∏"

class Sec22Volumes(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec22_volumes')
    vol_production = models.CharField(max_length=100, blank=True, verbose_name="–û–±—ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞")
    vol_import = models.CharField(max_length=100, blank=True, verbose_name="–û–±—ä–µ–º –∏–º–ø–æ—Ä—Ç–∞")
    vol_export = models.CharField(max_length=100, blank=True, verbose_name="–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞")
    history = HistoricalRecords()
    class Meta: verbose_name = "XXII. –û–±—ä–µ–º—ã"

class Sec23Extra(ConfigValidationMixin, models.Model):
    element = models.OneToOneField(ChemicalElement, on_delete=models.CASCADE, related_name='sec23_extra')
    recommendations = models.TextField(blank=True, verbose_name="–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ / –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã")
    history = HistoricalRecords()
    class Meta: verbose_name = "XXIII. –î–æ–ø. –∏–Ω—Ñ–æ"

==================================================
FILE: .\backend\registry\models\__init__.py
==================================================
from .common import *
from .core import ChemicalElement, ElementAttachment
from .identification import Sec1Identification
from .physical import Sec2Physical
from .properties import (
    Sec3ToxSanPin, Sec4ToxAir, Sec5ToxAcute, Sec6ToxRisks,
    Sec8EcoTox, Sec9Soil, Sec10Water,
    Sec11HazardClass, Sec12GHSClass, Sec13GHSLabel,
    Sec14Safety, Sec15Storage, Sec16Waste, Sec17Incidents,
    Sec18InternationalReg, Sec20Docs, Sec21Companies, Sec22Volumes, Sec23Extra
)

==================================================
FILE: .\backend\registry\templates\admin\registry\chemicalelement\change_list.html
==================================================
{% extends "admin/change_list.html" %}
{% load i18n %}

{% block object-tools-items %}
{{ block.super }}
<li>
    <a href="/api/registry/import/template/" class="btn btn-high btn-success" style="background-color: #27ae60 !important; color:white;">
        <i class="fas fa-download"></i> –°–∫–∞—á–∞—Ç—å –®–∞–±–ª–æ–Ω Excel
    </a>
</li>
<li>
    <!-- –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä—è–º–æ –≤ –∞–¥–º–∏–Ω–∫–µ -->
    <form action="/api/registry/import/upload/" method="POST" enctype="multipart/form-data" style="display:inline-flex; align-items:center; margin-left:10px;">
        <!-- Django CSRF —Ç—É—Ç —Å–ª–æ–∂–µ–Ω —Ç.–∫. API endpoint, –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Token,
             –Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∫–æ—Ç–æ—Ä—ã–π –∑–∞–ª–æ–≥–∏–Ω–µ–Ω –≤ —Å–µ—Å—Å–∏–∏)
             —Å–¥–µ–ª–∞–µ–º –ø—Ä–æ—Å—Ç—É—é —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ iframe –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.
             –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è, –∞ –∑–∞–≥—Ä—É–∑–∫—É —á–µ—Ä–µ–∑ Swagger.
        -->
    </form>
    <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü—Ä–æ—Å—Ç–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ Swagger –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–º–ø–æ—Ä—Ç–∞ -->
    <a href="#" onclick="document.getElementById('file-upload').click();" class="btn btn-high btn-primary" style="background-color: #3498db !important; color:white;">
        <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç Excel
    </a>
    <input type="file" id="file-upload" style="display:none" onchange="uploadExcel(this)">
</li>

<script>
    function uploadExcel(input) {
        if (input.files && input.files[0]) {
            let formData = new FormData();
            formData.append('file', input.files[0]);

            // –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–º –Ω—É–∂–µ–Ω CSRF —Ç–æ–∫–µ–Ω, –µ—Å–ª–∏ –º—ã –≤ –∞–¥–º–∏–Ω–∫–µ
            const getCookie = (name) => {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }

            fetch('/api/registry/import/upload/', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message + "\n–£—Å–ø–µ—à–Ω–æ: " + data.created_count);
                    if(data.errors.length > 0) alert("–û—à–∏–±–∫–∏:\n" + data.errors.join("\n"));
                    location.reload();
                })
                .catch(error => {
                    console.error(error);
                    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å.');
                });
        }
    }
</script>
{% endblock %}

==================================================
FILE: .\backend\registry\templates\admin\registry\registryconfig\custom_change_form.html
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\backend\registry\templates\registry\passport_pdf.html
==================================================
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü–∞—Å–ø–æ—Ä—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ {{ element.primary_name_ru }}</title>
    <style>
        @page {
            size: A4;
            margin: 1cm;
            @top-center { content: "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –æ–ø–∞—Å–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –†–£–∑"; font-size: 9px; color: #555; font-family: sans-serif; }
            @bottom-right { content: "–°—Ç—Ä. " counter(page); font-size: 9px; font-family: sans-serif; }
        }
        body { font-family: "DejaVu Sans", sans-serif; font-size: 10px; line-height: 1.3; color: #2c3e50; }
        h1 { text-align: center; font-size: 14px; text-transform: uppercase; margin-bottom: 5px; color: #2c3e50; border-bottom: 2px solid #2c3e50; padding-bottom: 5px; }
        .meta-info { text-align: center; font-size: 10px; margin-bottom: 15px; color: #555; }

        .section-header {
            background-color: #ecf0f1;
            border-left: 5px solid #2980b9;
            color: #2c3e50;
            padding: 4px 10px;
            font-weight: bold;
            font-size: 11px;
            margin-top: 15px;
            margin-bottom: 5px;
            page-break-after: avoid;
        }

        table { width: 100%; border-collapse: collapse; margin-bottom: 5px; page-break-inside: avoid; }
        th, td { border: 1px solid #bdc3c7; padding: 4px 6px; vertical-align: top; }
        th { background-color: #fcfcfc; width: 35%; font-weight: bold; text-align: left; color: #34495e; }

        .bool-yes { color: red; font-weight: bold; }
        .bool-no { color: green; }
    </style>
</head>
<body>

<h1>–ü–∞—Å–ø–æ—Ä—Ç —Ö–∏–º–∏—á–µ—Å–∫–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞</h1>
<div class="meta-info">
    <b>{{ element.primary_name_ru }}</b><br>
    CAS: {{ element.cas_number|default:"-" }} | –°—Ç–∞—Ç—É—Å: {{ element.get_status_display }} | –û–±–Ω–æ–≤–ª–µ–Ω–æ: {{ element.updated_at|date:"d.m.Y" }}
</div>

<!-- I. –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø -->
<div class="section-header">I. –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –í–ï–©–ï–°–¢–í–ê</div>
{% with sec=element.sec1_identification %}
<table>
    <tr><th>–°–∏–Ω–æ–Ω–∏–º—ã</th><td>{{ sec.synonyms|default:"-" }}</td></tr>
    <tr><th>–§–æ—Ä–º—É–ª–∞ (–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è)</th><td>{{ sec.molecular_formula|default:"-" }}</td></tr>
    <tr><th>–§–æ—Ä–º—É–ª–∞ (–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è)</th><td>{{ sec.structural_formula|default:"-" }}</td></tr>
    <tr><th>–ù–æ–º–µ—Ä –ï–°</th><td>{{ sec.ec_number|default:"-" }}</td></tr>
    <tr><th>IUPAC (RU)</th><td>{{ sec.iupac_name_ru|default:"-" }}</td></tr>
    <tr><th>IUPAC (EN)</th><td>{{ sec.iupac_name_en|default:"-" }}</td></tr>
    <tr><th>–ö–æ–¥ –¢–ù –í–≠–î</th><td>{{ sec.tnved_code|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- II. –§–ò–ó–ò–ö–û-–•–ò–ú–ò–ß–ï–°–ö–ò–ï –°–í–û–ô–°–¢–í–ê -->
<div class="section-header">II. –§–ò–ó–ò–ö–û-–•–ò–ú–ò–ß–ï–°–ö–ò–ï –°–í–û–ô–°–¢–í–ê</div>
{% with sec=element.sec2_physical %}
<table>
    <tr><th>–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</th><td>{{ sec.get_appearance_display|default:"-" }}</td></tr>
    <tr><th>–ó–∞–ø–∞—Ö</th><td>{{ sec.get_odor_display|default:"-" }}</td></tr>
    <tr><th>–¶–≤–µ—Ç</th><td>{{ sec.color|default:"-" }}</td></tr>
    <tr><th>pH</th><td>{{ sec.ph|default:"-" }}</td></tr>
    <tr><th>–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞</th><td>{{ sec.mol_mass|default:"-" }}</td></tr>
    <tr><th>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (¬∞C)</th><td>–ü–ª–∞–≤–ª–µ–Ω–∏—è: {{ sec.melting_point|default:"-" }} <br> –ö–∏–ø–µ–Ω–∏—è: {{ sec.boiling_point|default:"-" }} <br> –°–∞–º–æ—Å–≤–æ—Å–ø–ª.: {{ sec.auto_ignition|default:"-" }}</td></tr>
    <tr><th>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–≥/—Å–º3)</th><td>{{ sec.density|default:"-" }}</td></tr>
    <tr><th>–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å (–≤–æ–¥–∞)</th><td>{{ sec.solubility_water|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- III. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø (–°–∞–Ω–ü–∏–ù) -->
<div class="section-header">III. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–ß–ï–°–ö–ò–ï –°–í–û–ô–°–¢–í–ê (–°–∞–Ω–ü–∏–ù)</div>
{% with sec=element.sec3_sanpin %}
<table>
    <tr><th>–ü–î–ö —Ä–∞–±. –∑–æ–Ω—ã</th><td>{{ sec.pdk_workzone|default:"-" }}</td></tr>
    <tr><th>–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ</th><td>{{ sec.get_state_in_air_display|default:"-" }}</td></tr>
    <tr><th>–õ–î50 (–ñ–µ–ª—É–¥–æ–∫/–ö–æ–∂–∞)</th><td>{{ sec.ld50_stomach|default:"-" }} / {{ sec.ld50_skin|default:"-" }}</td></tr>
    <tr><th>–õ–ö50 (–í–æ–∑–¥—É—Ö)</th><td>{{ sec.lc50_air|default:"-" }}</td></tr>
    <tr><th>–ö–í–ò–û / –ó–æ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—è</th><td>–ö–í–ò–û: {{ sec.kvio|default:"-" }} <br> –û—Å—Ç—Ä.: {{ sec.zone_acute|default:"-" }} / –•—Ä–æ–Ω.: {{ sec.zone_chronic|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- IV. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø (–ê–¢–ú–û–°–§–ï–†–ê) -->
<div class="section-header">IV. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø (–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π –≤–æ–∑–¥—É—Ö)</div>
{% with sec=element.sec4_air %}
<table>
    <tr><th>–õ–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫</th><td>{{ sec.get_limit_sign_display|default:"-" }}</td></tr>
    <tr><th>–ü–î–ö –ú–∞–∫—Å. —Ä–∞–∑–æ–≤–∞—è</th><td>{{ sec.pdk_max_single|default:"-" }}</td></tr>
    <tr><th>–ü–î–ö –°—Ä–µ–¥–Ω–µ—Å—É—Ç–æ—á–Ω–∞—è</th><td>{{ sec.pdk_daily_avg|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- V. –û–°–¢–†–ê–Ø –¢–û–ö–°–ò–ß–ù–û–°–¢–¨ -->
<div class="section-header">V. –û–°–¢–†–ê–Ø –¢–û–ö–°–ò–ß–ù–û–°–¢–¨ (–≠—Ñ—Ñ–µ–∫—Ç—ã)</div>
{% with sec=element.sec5_acute %}
<table>
    <tr><th>–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω—ã–π</th><td>{{ sec.get_inhalation_lc50_effect_display }} ({{ sec.inhalation_lc50_val|default:"-" }})</td></tr>
    <tr><th>–î–µ—Ä–º–∞–ª—å–Ω—ã–π</th><td>{{ sec.get_dermal_ld50_effect_display }} ({{ sec.dermal_ld50_val|default:"-" }})</td></tr>
    <tr><th>–ü–µ—Ä–æ—Ä–∞–ª—å–Ω—ã–π</th><td>{{ sec.get_oral_ld50_effect_display }} ({{ sec.oral_ld50_val|default:"-" }})</td></tr>
</table>
{% endwith %}

<!-- VI. –†–ò–°–ö–ò –ò –û–ü–ê–°–ù–û–°–¢–ò (–°–ì–°) -->
<div class="section-header">VI. –†–ò–°–ö–ò –î–õ–Ø –ó–î–û–†–û–í–¨–Ø (–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –°–ì–°)</div>
{% with sec=element.sec6_risks %}
<table>
    <tr><th>–†–∞–∑—ä–µ–¥–∞–Ω–∏–µ –∫–æ–∂–∏</th><td>{{ sec.get_skin_corr_display }}</td></tr>
    <tr><th>–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–ª–∞–∑</th><td>{{ sec.get_eye_dmg_display }}</td></tr>
    <tr><th>–°–µ–Ω—Å–∏–±–∏–ª–∏–∑–∞—Ü–∏—è</th><td>{{ sec.get_sensitization_display }}</td></tr>
    <tr><th>–ú—É—Ç–∞–≥–µ–Ω–Ω–æ—Å—Ç—å</th><td>{{ sec.get_mutagenicity_display }}</td></tr>
    <tr><th>–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å</th><td>{{ sec.get_carcinogenicity_display }}</td></tr>
    <tr><th>–†–µ–ø—Ä–æ–¥. —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å</th><td>{{ sec.get_repro_tox_display }}</td></tr>
    <tr><th>–ê—Å–ø–∏—Ä–∞—Ü–∏—è</th><td>{{ sec.get_aspiration_hazard_display }}</td></tr>
</table>
{% endwith %}

<!-- VIII. –≠–ö–û–õ–û–ì–ò–Ø -->
<div class="section-header">VIII. –≠–ö–û–õ–û–ì–û-–¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø</div>
{% with sec=element.sec8_ecotox %}
<table>
    <tr><th>–õ–î50 –ñ–∏–≤–æ—Ç–Ω—ã–µ</th><td>–ú–ª–µ–∫–æ–ø–∏—Ç.: {{ sec.ld50_mammals|default:"-" }} / –ü—Ç–∏—Ü—ã: {{ sec.ld50_birds|default:"-" }}</td></tr>
    <tr><th>–õ–î50 –í–æ–¥–Ω—ã–µ/–ù–∞—Å–µ–∫.</th><td>–†—ã–±—ã: {{ sec.ld50_fish|default:"-" }} / –ü—á–µ–ª—ã: {{ sec.ld50_bees|default:"-" }}</td></tr>
    <tr><th>–°–ø–µ—Ü–∏—Ñ. —ç—Ñ—Ñ–µ–∫—Ç—ã</th><td>
        –ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è: {% if sec.bioaccumulation %}<span class="bool-yes">–î–ê</span>{% else %}–ù–µ—Ç{% endif %} <br>
        –§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å: {% if sec.phytotoxicity %}<span class="bool-yes">–î–ê</span>{% else %}–ù–µ—Ç{% endif %}
    </td></tr>
</table>
{% endwith %}

<!-- IX. –ü–û–ß–í–ê -->
<div class="section-header">IX. –ü–û–í–ï–î–ï–ù–ò–ï –í –ü–û–ß–í–ï</div>
{% with sec=element.sec9_soil %}
<table>
    <tr><th>–ü–î–ö / –û–î–ö –≤ –ø–æ—á–≤–µ</th><td>{{ sec.pdk_soil|default:"-" }} / {{ sec.odk_soil|default:"-" }}</td></tr>
    <tr><th>–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å</th><td>{{ sec.get_persistence_display|default:"-" }}</td></tr>
    <tr><th>–ú–∏–≥—Ä–∞—Ü–∏—è</th><td>{{ sec.get_migration_display|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- X. –í–û–î–ù–ê–Ø –°–†–ï–î–ê -->
<div class="section-header">X. –í–û–î–ù–ê–Ø –°–†–ï–î–ê</div>
{% with sec=element.sec10_water %}
<table>
    <tr><th>–û—Å—Ç—Ä–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å</th><td>–†—ã–±—ã: {{ sec.acute_fish|default:"-" }} <br> –í–æ–¥–æ—Ä–æ—Å–ª–∏: {{ sec.acute_algae|default:"-" }}</td></tr>
    <tr><th>Bioaccumulation (LogKow)</th><td>{{ sec.bioacc_logkow|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- XI-XIII. –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø –ò –ú–ê–†–ö–ò–†–û–í–ö–ê -->
<div class="section-header">XI-XIII. –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø –ò –ú–ê–†–ö–ò–†–û–í–ö–ê</div>
{% with s11=element.sec11_class s12=element.sec12_ghs s13=element.sec13_label %}
<table>
    <tr>
        <th>–ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏</th>
        <td>
            –°–∞–Ω–ü–∏–ù 0294-11: <b>{{ s11.get_sanpin_class_display }}</b><br>
            –ì–û–°–¢ 12.1.007: {{ s11.get_gost_body_class_display }}<br>
            –ì–û–°–¢ 32424: {{ s11.get_gost_env_class_display }}
        </td>
    </tr>
    <tr>
        <th>–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°</th>
        <td>
            –°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ: <b>{{ s13.get_signal_word_display }}</b><br>
            –ü–∏–∫—Ç–æ–≥—Ä–∞–º–º—ã: {{ s13.pictogram_code|default:"-" }}<br>
            <b>H-—Ñ—Ä–∞–∑—ã:</b> {{ s13.h_phrases|default:"-" }}<br>
            <b>P-—Ñ—Ä–∞–∑—ã:</b> {{ s13.p_phrases|default:"-" }}
        </td>
    </tr>
    <tr>
        <th>–†–∏—Å–∫–∏ –°–ì–° (–û–ø–∏—Å–∞–Ω–∏–µ)</th>
        <td>{{ s12.phys_hazard|default:"" }} {{ s12.chem_hazard|default:"" }} {{ s12.env_hazard|default:"" }}</td>
    </tr>
</table>
{% endwith %}

<!-- XIV-XVI. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –£–¢–ò–õ–ò–ó–ê–¶–ò–Ø -->
<div class="section-header">XIV-XVI. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –£–¢–ò–õ–ò–ó–ê–¶–ò–Ø</div>
{% with s14=element.sec14_safety s15=element.sec15_storage s16=element.sec16_waste %}
<table>
    <tr><th>–ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã (–°–ò–ó)</th><td>{{ s14.prevent_health|default:"-" }}</td></tr>
    <tr><th>–ü–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å</th><td>{{ s14.first_aid|default:"-" }}</td></tr>
    <tr><th>–•—Ä–∞–Ω–µ–Ω–∏–µ</th><td>{{ s15.storage_reqs|default:"-" }} <br> (–°—Ä–æ–∫: {{ s15.shelf_life|default:"-" }})</td></tr>
    <tr><th>–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</th><td>{{ s15.incompatible|default:"-" }}</td></tr>
    <tr><th>–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è</th><td>{{ s16.disposal|default:"-" }}</td></tr>
</table>
{% endwith %}

<!-- XVII-XVIII. –ü–†–û–ß–ï–ï -->
<div class="section-header">XVII-XVIII. –†–ï–ì–£–õ–ò–†–û–í–ê–ù–ò–ï –ò –ò–°–¢–û–†–ò–Ø</div>
{% with s17=element.sec17_incidents s18=element.sec18_intl %}
<table>
    <tr><th>–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã/–ê–≤–∞—Ä–∏–∏</th><td>{{ s17.history|default:"-" }}</td></tr>
    <tr><th>–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –∫–æ–Ω–≤–µ–Ω—Ü–∏–∏</th><td>
        –û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–µ: {% if s18.ozone_destroying %}<b class="bool-yes">–î–ê</b>{% else %}–ù–µ—Ç{% endif %};
        –°–û–ó (–°—Ç–æ–∫–≥–æ–ª—å–º): {% if s18.pops %}<b class="bool-yes">–î–ê</b>{% else %}–ù–µ—Ç{% endif %};
        –†—Ç—É—Ç—å (–ú–∏–Ω–∞–º–∞—Ç–∞): {% if s18.mercury %}<b class="bool-yes">–î–ê</b>{% else %}–ù–µ—Ç{% endif %}.
    </td></tr>
</table>
{% endwith %}

<!-- XX-XXIII. –î–û–ü. –ò–ù–§–û -->
<div class="section-header">XX-XXIII. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø</div>
{% with s20=element.sec20_docs s21=element.sec21_companies s22=element.sec22_volumes s23=element.sec23_extra %}
<table>
    <tr><th>–†–µ–≥—É–ª–∏—Ä—É—é—â–∏–µ –¥–æ–∫-—Ç—ã</th><td>{{ s20.gost_standards|default:"-" }}</td></tr>
    <tr><th>–£—á–∞—Å—Ç–Ω–∏–∫–∏ (–ö–æ–º–ø–∞–Ω–∏–∏)</th><td>{{ s21.info|default:"-" }}</td></tr>
    <tr><th>–û–±—ä–µ–º—ã –æ–±–æ—Ä–æ—Ç–∞</th><td>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ: {{ s22.vol_production|default:"-" }} / –ò–º–ø–æ—Ä—Ç: {{ s22.vol_import|default:"-" }}</td></tr>
    <tr><th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</th><td>{{ s23.recommendations|default:"-" }}</td></tr>
</table>
{% endwith %}

</body>
</html>

==================================================
FILE: .\backend\support\admin.py
==================================================
from django.contrib import admin

# Register your models here.


==================================================
FILE: .\backend\support\apps.py
==================================================
from django.apps import AppConfig


class SupportConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'support'


==================================================
FILE: .\backend\support\models.py
==================================================
from django.db import models
from django.conf import settings

class SupportTicket(models.Model):
    # –ü–æ–ª–µ user –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True, verbose_name="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å")

    # –ü–æ–ª–µ contact_email –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –î–û–õ–ñ–ù–û –ë–´–¢–¨ –ó–î–ï–°–¨
    contact_email = models.EmailField(verbose_name="Email –¥–ª—è —Å–≤—è–∑–∏", blank=True, null=True)

    subject = models.CharField(max_length=255, verbose_name="–¢–µ–º–∞")
    message = models.TextField(verbose_name="–°–æ–æ–±—â–µ–Ω–∏–µ")
    file = models.FileField(upload_to='support/%Y/%m/', null=True, blank=True, verbose_name="–°–∫—Ä–∏–Ω—à–æ—Ç/–§–∞–π–ª")
    created_at = models.DateTimeField(auto_now_add=True, verbose_name="–°–æ–∑–¥–∞–Ω–æ")
    is_resolved = models.BooleanField(default=False, verbose_name="–†–µ—à–µ–Ω–æ")

    def __str__(self):
        return f"Ticket #{self.id} - {self.subject}"

    class Meta:
        verbose_name = "–û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É"
        verbose_name_plural = "–û–±—Ä–∞—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É"
        ordering = ['-created_at']

==================================================
FILE: .\backend\support\serializers.py
==================================================
from rest_framework import serializers
from .models import SupportTicket

class SupportTicketSerializer(serializers.ModelSerializer):
    class Meta:
        model = SupportTicket
        fields = ['id', 'subject', 'message', 'file', 'created_at', 'contact_email']
        read_only_fields = ['id', 'created_at']

    def create(self, validated_data):
        request = self.context.get('request')

        # 1. –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —é–∑–µ—Ä–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ (–µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å)
        if request and request.user and request.user.is_authenticated:
            validated_data['user'] = request.user
        else:
            validated_data['user'] = None

        # 2. –í–ê–ñ–ù–û: –ï—Å–ª–∏ email –Ω–µ –ø—Ä–∏—à–µ–ª –∏–∑ —Ñ–æ—Ä–º—ã, –ø—ã—Ç–∞–µ–º—Å—è –≤–∑—è—Ç—å –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è (–∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)
        # –ù–æ –µ—Å–ª–∏ –≤ —Ñ–æ—Ä–º–µ —á—Ç–æ-—Ç–æ –±—ã–ª–æ –Ω–∞–ø–∏—Å–∞–Ω–æ, –æ–Ω–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º.
        if not validated_data.get('contact_email'):
            if validated_data['user']:
                validated_data['contact_email'] = validated_data['user'].email

        return super().create(validated_data)

==================================================
FILE: .\backend\support\tasks.py
==================================================
import requests
from celery import shared_task
from django.core.mail import EmailMessage
from django.conf import settings
from .models import SupportTicket

@shared_task
def send_support_notification_task(ticket_id):
    try:
        # 1. –ë–µ—Ä–µ–º –∑–∞—è–≤–∫—É
        ticket = SupportTicket.objects.select_related('user').get(id=ticket_id)

        # 2. –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
        # –ì–ª–∞–≤–Ω–æ–µ - email –∏–∑ —Ñ–æ—Ä–º—ã
        contact_email = ticket.contact_email or "–ù–µ —É–∫–∞–∑–∞–Ω"

        # –î–æ–ø. –∏–Ω—Ñ–æ: –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –æ–Ω?
        if ticket.user:
            auth_info = f"(–ê–∫–∫–∞—É–Ω—Ç: {ticket.user.username})"
        else:
            auth_info = "(–ì–æ—Å—Ç—å / –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)"

        # –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        text = (
            f"üÜò <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ #{ticket.id}</b>\n\n"
            f"üìß <b>Email –¥–ª—è –æ—Ç–≤–µ—Ç–∞:</b> {contact_email}\n"
            f"üë§ <b>–°—Ç–∞—Ç—É—Å:</b> {auth_info}\n"
            f"üìå <b>–¢–µ–º–∞:</b> {ticket.subject}\n\n"
            f"üìù <b>–°–æ–æ–±—â–µ–Ω–∏–µ:</b>\n{ticket.message}"
        )

        # 3. –û–¢–ü–†–ê–í–ö–ê –í TELEGRAM
        bot_token = settings.TELEGRAM_BOT_TOKEN
        chat_id = settings.TELEGRAM_CHAT_ID

        if bot_token and chat_id:
            try:
                if ticket.file:
                    with ticket.file.open('rb') as f:
                        requests.post(
                            f"https://api.telegram.org/bot{bot_token}/sendDocument",
                            data={'chat_id': chat_id, 'caption': text, 'parse_mode': 'HTML'},
                            files={'document': f},
                            timeout=10
                        )
                else:
                    requests.post(
                        f"https://api.telegram.org/bot{bot_token}/sendMessage",
                        data={'chat_id': chat_id, 'text': text, 'parse_mode': 'HTML'},
                        timeout=10
                    )
            except Exception as e:
                print(f"TELEGRAM ERROR: {e}")

        # 4. –û–¢–ü–†–ê–í–ö–ê –ù–ê EMAIL (–ê–¥–º–∏–Ω—É)
        try:
            recipient = settings.SUPPORT_EMAIL
            email_body = text.replace('<b>', '').replace('</b>', '')

            email = EmailMessage(
                subject=f"[Support] {ticket.subject}",
                body=email_body,
                from_email=settings.EMAIL_HOST_USER,
                to=[recipient],
                reply_to=[contact_email] if ticket.contact_email else None # –ß—Ç–æ–±—ã –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–û—Ç–≤–µ—Ç–∏—Ç—å" –ø–æ–¥—Å—Ç–∞–≤–∏–ª—Å—è email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            )

            if ticket.file:
                with ticket.file.open('rb') as f:
                    email.attach(ticket.file.name, f.read())

            email.send()
        except Exception as e:
            print(f"EMAIL ERROR: {e}")

        return "Done"

    except SupportTicket.DoesNotExist:
        return "Ticket not found"

==================================================
FILE: .\backend\support\tests.py
==================================================
from django.test import TestCase

# Create your tests here.


==================================================
FILE: .\backend\support\urls.py
==================================================
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from .views import SupportViewSet

router = DefaultRouter()
router.register(r'tickets', SupportViewSet, basename='support')

urlpatterns = [
    path('', include(router.urls)),
]

==================================================
FILE: .\backend\support\views.py
==================================================
from rest_framework import viewsets, mixins
from rest_framework.permissions import AllowAny # <--- –í–ê–ñ–ù–û
from rest_framework.parsers import MultiPartParser, FormParser
from .models import SupportTicket
from .serializers import SupportTicketSerializer
from .tasks import send_support_notification_task

class SupportViewSet(mixins.CreateModelMixin, viewsets.GenericViewSet):
    queryset = SupportTicket.objects.all()
    serializer_class = SupportTicketSerializer
    permission_classes = [AllowAny] # <--- –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ–º
    parser_classes = [MultiPartParser, FormParser]

    def perform_create(self, serializer):
        ticket = serializer.save()
        send_support_notification_task.delay(ticket.id)

==================================================
FILE: .\backend\support\__init__.py
==================================================


==================================================
FILE: .\backend\support\migrations\0001_initial.py
==================================================
# Generated by Django 4.2.27 on 2025-12-08 22:03

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='SupportTicket',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('subject', models.CharField(max_length=255, verbose_name='–¢–µ–º–∞')),
                ('message', models.TextField(verbose_name='–°–æ–æ–±—â–µ–Ω–∏–µ')),
                ('file', models.FileField(blank=True, null=True, upload_to='support/%Y/%m/', verbose_name='–°–∫—Ä–∏–Ω—à–æ—Ç/–§–∞–π–ª')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='–°–æ–∑–¥–∞–Ω–æ')),
                ('is_resolved', models.BooleanField(default=False, verbose_name='–†–µ—à–µ–Ω–æ')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')),
            ],
            options={
                'verbose_name': '–û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É',
                'verbose_name_plural': '–û–±—Ä–∞—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É',
                'ordering': ['-created_at'],
            },
        ),
    ]


==================================================
FILE: .\backend\support\migrations\0002_supportticket_contact_email_alter_supportticket_user.py
==================================================
# Generated by Django 4.2.27 on 2025-12-09 18:20

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('support', '0001_initial'),
    ]

    operations = [
        migrations.AddField(
            model_name='supportticket',
            name='contact_email',
            field=models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email –¥–ª—è —Å–≤—è–∑–∏'),
        ),
        migrations.AlterField(
            model_name='supportticket',
            name='user',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'),
        ),
    ]


==================================================
FILE: .\backend\support\migrations\__init__.py
==================================================


==================================================
FILE: .\backend\tests\conftest.py
==================================================
import pytest
from rest_framework.test import APIClient
from django.contrib.auth import get_user_model
from users.models import CompanyProfile

User = get_user_model()

@pytest.fixture
def api_client():
    return APIClient()

# –ü–ï–†–ï–ò–ú–ï–ù–û–í–ê–õ–ò supplier_user -> supplier
@pytest.fixture
def supplier(db):
    """–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º –∫–æ–º–ø–∞–Ω–∏–∏"""
    user = User.objects.create_user(
        username='supplier',
        email='supplier@test.uz',
        password='password123',
        role='SUPPLIER'
    )
    CompanyProfile.objects.create(
        user=user,
        company_name='Test Factory LLC',
        inn='123456789',
        is_manufacturer=True
    )
    return user

@pytest.fixture
def auth_client(api_client, supplier):
    """–ö–ª–∏–µ–Ω—Ç, —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫"""
    api_client.force_authenticate(user=supplier)
    return api_client

@pytest.fixture
def admin_user(db):
    return User.objects.create_user(username='admin', password='password', is_staff=True, is_superuser=True)

==================================================
FILE: .\backend\tests\test_api.py
==================================================
import pytest
from registry.models import ChemicalElement, Sec2Physical

@pytest.mark.django_db
class TestRegistryAPI:

    def test_n_plus_one_problem(self, auth_client, django_assert_num_queries):
        for i in range(10):
            elem = ChemicalElement.objects.create(
                primary_name_ru=f"Elem {i}",
                created_by=auth_client.handler._force_user,
                status='PUBLISHED'
            )
            Sec2Physical.objects.create(element=elem, color="Red")

        with django_assert_num_queries(2):
            res = auth_client.get('/api/registry/elements/')
            assert res.status_code == 200
            assert len(res.data['results']) == 10

    def test_create_full_structure(self, auth_client):
        payload = {
            "primary_name_ru": "Complex Element",
            "cas_number": "111-22-33",
            "sec2_physical": {"color": "Green", "ph": "7.5"},
            "sec14_safety": {"first_aid": "Call doctor"}
        }
        res = auth_client.post('/api/registry/elements/', payload, format='json')
        assert res.status_code == 201

        elem_id = res.data['id']
        elem = ChemicalElement.objects.get(id=elem_id)
        assert elem.sec2_physical.color == "Green"
        assert hasattr(elem, 'sec17_incidents')

    # === –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: supplier_user -> supplier ===
    def test_permissions_isolation(self, api_client, supplier):
        ChemicalElement.objects.create(
            primary_name_ru="Secret Draft",
            created_by=supplier,
            status='DRAFT'
        )

        res = api_client.get('/api/registry/elements/')
        assert res.data['count'] == 0

        api_client.force_authenticate(user=supplier)
        res = api_client.get('/api/registry/elements/')
        assert res.data['count'] == 1

==================================================
FILE: .\backend\tests\test_api_complete.py
==================================================
import pytest
from unittest.mock import patch
from django.contrib.auth import get_user_model
from registry.models import ChemicalElement, Sec2Physical

User = get_user_model()

@pytest.mark.django_db
class TestAuthAPI:
    def test_registration(self, api_client):
        payload = {
            "username": "new_corp",
            "password": "StrongPassword123!",
            "email": "corp@test.uz",
            "company": {
                "company_name": "New Corp LLC",
                "inn": "998877665",
                "is_manufacturer": True
            }
        }
        response = api_client.post('/api/auth/register/', payload, format='json')
        assert response.status_code == 201
        assert User.objects.count() == 1
        assert User.objects.first().role == 'SUPPLIER'

    def test_login_and_me(self, api_client, supplier):
        # === –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∏–∫—Å—Ç—É—Ä—ã supplier ===
        response = api_client.post('/api/token/', {
            "username": "supplier", "password": "password123"
        })
        # ===========================================================
        assert response.status_code == 200
        token = response.data['access']

        api_client.credentials(HTTP_AUTHORIZATION=f'Bearer {token}')
        response = api_client.get('/api/auth/me/')
        assert response.status_code == 200
        assert response.data['company']['company_name'] == 'Test Factory LLC'


@pytest.mark.django_db
class TestRegistryCRUD:
    def test_create_element_manual(self, auth_client, supplier):
        payload = {
            "primary_name_ru": "–†—É—á–Ω–æ–µ –í–µ—â–µ—Å—Ç–≤–æ",
            "cas_number": "111-22-33",
            "sec1_identification": {"synonyms": "–¢–µ—Å—Ç —Å–∏–Ω–æ–Ω–∏–º"},
            "sec2_physical": {"ph": "7"}
        }
        response = auth_client.post('/api/registry/elements/', payload, format='json')
        assert response.status_code == 201

        elem = ChemicalElement.objects.get(cas_number="111-22-33")
        assert elem.created_by == supplier
        assert elem.status == "DRAFT"
        assert elem.sec2_physical.ph == "7"

    def test_update_element(self, auth_client, supplier):
        elem = ChemicalElement.objects.create(created_by=supplier, primary_name_ru="Old Name")
        payload = {"primary_name_ru": "New Name"}
        response = auth_client.patch(f'/api/registry/elements/{elem.id}/', payload)
        assert response.status_code == 200
        elem.refresh_from_db()
        assert elem.primary_name_ru == "New Name"

    def test_delete_permission(self, api_client, supplier):
        other_user = User.objects.create_user('hacker', 'pass')
        api_client.force_authenticate(user=other_user)
        elem = ChemicalElement.objects.create(created_by=supplier, primary_name_ru="My Tech")
        response = api_client.delete(f'/api/registry/elements/{elem.id}/')
        assert response.status_code in [403, 404]


@pytest.mark.django_db
class TestAdminActions:
    @patch('registry.tasks.send_status_email_task.delay')
    def test_admin_set_status(self, mock_task, api_client, supplier):
        admin = User.objects.create_user('admin', 'pass', is_staff=True)
        api_client.force_authenticate(user=admin)

        elem = ChemicalElement.objects.create(created_by=supplier, status='DRAFT', primary_name_ru="Test Element")

        response = api_client.patch(f'/api/registry/elements/{elem.id}/', {"status": "PUBLISHED"})

        assert response.status_code == 200
        elem.refresh_from_db()
        assert elem.status == 'PUBLISHED'

    @pytest.mark.skip(reason="–ü—Ä–æ–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ –Ω–µ—Ç —Ç—Ä–∏–≥—Ä–∞–º–º –≤ —Ç–µ—Å—Ç –ë–î")
    def test_smart_search(self, auth_client, supplier):
        ChemicalElement.objects.create(created_by=supplier, status='PUBLISHED', primary_name_ru="–ê–º–º–∏–∞–∫ –≤–æ–¥–Ω—ã–π")
        response = auth_client.get('/api/registry/elements/', {'search': '–ê–º–∏–∞–∫'})
        assert response.status_code == 200

    def test_pdf_generation(self, api_client, supplier):
        elem = ChemicalElement.objects.create(created_by=supplier, status='PUBLISHED', primary_name_ru="PDF Test")
        Sec2Physical.objects.create(element=elem)
        response = api_client.get(f'/api/registry/elements/{elem.id}/pdf/')
        assert response.status_code == 200
        assert response['Content-Type'] == 'application/pdf'

    def test_statistics(self, api_client, supplier):
        ChemicalElement.objects.create(created_by=supplier, status='PUBLISHED')
        ChemicalElement.objects.create(created_by=supplier, status='DRAFT')
        response = api_client.get('/api/registry/stats/')
        assert response.status_code == 200
        assert response.data['total_elements'] == 1

==================================================
FILE: .\backend\tests\test_registry_scenarios.py
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\backend\tests\test_services.py
==================================================
import pytest
import pandas as pd
import io
from registry.models import ChemicalElement, Sec2Physical, RegistryConfig
from registry.services import process_excel_import

@pytest.mark.django_db
class TestExcelImportService:

    def test_import_clean_headers(self, supplier):
        """
        –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
        1. –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ Excel.
        2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (—É–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ *).
        3. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (Sec2Physical).
        """
        # –°–æ–∑–¥–∞–µ–º DataFrame (—Å–∏–º—É–ª—è—Ü–∏—è Excel)
        data = {
            '–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU) *': ['–¢–µ—Å—Ç–æ–≤—ã–π –ê—Ü–µ—Ç–æ–Ω'],
            'CAS –Ω–æ–º–µ—Ä': ['67-64-1'],
            '–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ': ['–ñ–∏–¥–∫–æ—Å—Ç—å'], # –õ–∏—à–Ω–∏–π –ø—Ä–æ–±–µ–ª
            '  –¶–≤–µ—Ç': ['–ë–µ—Å—Ü–≤–µ—Ç–Ω—ã–π']              # –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ
        }
        df = pd.DataFrame(data)

        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –±–∞–π—Ç—ã
        output = io.BytesIO()
        df.to_excel(output, index=False)
        output.seek(0)

        # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Å—Ç—É—Ä—É supplier)
        report = process_excel_import(output, supplier)

        # –ü—Ä–æ–≤–µ—Ä–∫–∏
        assert report['success'] == 1
        assert len(report['errors']) == 0

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ë–î
        elem = ChemicalElement.objects.get(cas_number='67-64-1')
        assert elem.primary_name_ru == '–¢–µ—Å—Ç–æ–≤—ã–π –ê—Ü–µ—Ç–æ–Ω'

        # –ò–°–ü–†–ê–í–õ–ï–ù–û: supplier_user -> supplier
        assert elem.created_by == supplier

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å
        assert elem.sec2_physical.appearance == 'LIQUID'
        assert elem.sec2_physical.color == '–ë–µ—Å—Ü–≤–µ—Ç–Ω—ã–π'

    # –ò–°–ü–†–ê–í–õ–ï–ù–û: –∞—Ä–≥—É–º–µ–Ω—Ç supplier_user -> supplier
    def test_import_validation_error(self, supplier):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —á–µ—Ä–µ–∑ Config"""
        RegistryConfig.objects.create(required_fields=['cas_number'])

        # –§–∞–π–ª –±–µ–∑ CAS
        data = {
            '–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)': ['–ü–ª–æ—Ö–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ'],
        }
        df = pd.DataFrame(data)
        output = io.BytesIO()
        df.to_excel(output, index=False)
        output.seek(0)

        report = process_excel_import(output, supplier)

        # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞
        assert report['success'] == 0
        assert len(report['errors']) == 1
        assert "CAS –Ω–æ–º–µ—Ä" in report['errors'][0]

==================================================
FILE: .\backend\tests\test_signals.py
==================================================
import pytest
from unittest.mock import patch
from django.core import mail
from registry.models import ChemicalElement
from registry.tasks import send_status_email_task

@pytest.mark.django_db(transaction=True) # –í–∞–∂–Ω–æ: transaction=True –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è on_commit
class TestSignalsAndTasks:

    def test_signal_queues_email_on_publish(self, supplier, admin_user):
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PUBLISHED –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ Celery
        """
        elem = ChemicalElement.objects.create(
            primary_name_ru="Waiting Element",
            created_by=supplier,
            status='PENDING'
        )

        # –ú–æ–∫–∞–µ–º –∑–∞–¥–∞—á—É Celery, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ—ë —Ä–µ–∞–ª—å–Ω–æ, –∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–∑–æ–≤
        with patch('registry.tasks.send_status_email_task.delay') as mock_task:
            # –î–µ–π—Å—Ç–≤–∏–µ: –ê–¥–º–∏–Ω –ø—É–±–ª–∏–∫—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç
            elem.status = 'PUBLISHED'
            elem.save()

            # –ü—Ä–æ–≤–µ—Ä–∫–∞: –ó–∞–¥–∞—á–∞ –±—ã–ª–∞ –≤—ã–∑–≤–∞–Ω–∞
            mock_task.assert_called_once()
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã (email, subject, message)
            args = mock_task.call_args[0]
            assert args[0] == supplier.email
            assert "–û–ü–£–ë–õ–ò–ö–û–í–ê–ù–û" in args[2]

    def test_email_task_execution(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∞–º—É –∑–∞–¥–∞—á—É Celery (—á—Ç–æ –æ–Ω–∞ —Ä–µ–∞–ª—å–Ω–æ —à–ª–µ—Ç –ø–∏—Å—å–º–æ)"""
        subject = "Test Subject"
        msg = "Test Body"
        email = "test@example.com"

        # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–¥–∞—á–∏ –Ω–∞–ø—Ä—è–º—É—é (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
        result = send_status_email_task(email, subject, msg)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º outbox django
        assert len(mail.outbox) == 1
        assert mail.outbox[0].subject == subject
        assert mail.outbox[0].to == [email]
        assert "Email sent" in result

==================================================
FILE: .\backend\users\admin.py
==================================================
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.utils.translation import gettext_lazy as _
from .models import User, CompanyProfile

# 1. –ò–Ω–ª–∞–π–Ω –¥–ª—è –ö–æ–º–ø–∞–Ω–∏–∏
# –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ò–ù–ù –∏ –ê–¥—Ä–µ—Å –ø—Ä—è–º–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
class CompanyProfileInline(admin.StackedInline):
    model = CompanyProfile
    can_delete = False
    verbose_name_plural = '–ü—Ä–æ—Ñ–∏–ª—å –ö–æ–º–ø–∞–Ω–∏–∏ (–Æ—Ä. –õ–∏—Ü–æ)'
    fk_name = 'user'
    extra = 0  # –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å, –µ—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ—Ç (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤), –∏–ª–∏ 1 —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å

# 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ê–¥–º–∏–Ω–∫–∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
@admin.register(User)
class CustomUserAdmin(UserAdmin):
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—à –∏–Ω–ª–∞–π–Ω –≤–Ω—É—Ç—Ä—å
    inlines = [CompanyProfileInline]

    # –ö–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Å–ø–∏—Å–∫–µ
    list_display = ('username', 'email', 'role', 'get_company_name', 'is_staff', 'is_active')

    # –§–∏–ª—å—Ç—Ä—ã —Å–ø—Ä–∞–≤–∞
    list_filter = ('role', 'is_staff', 'is_active', 'company_profile__is_manufacturer')

    # –ü–æ–∏—Å–∫ (–ø–æ —é–∑–µ—Ä–Ω–µ–π–º—É, –ø–æ—á—Ç–µ –∏ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–æ–º–ø–∞–Ω–∏–∏)
    search_fields = ('username', 'email', 'company_profile__company_name', 'company_profile__inn')

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    # –ë–µ—Ä–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è UserAdmin (–ø–∞—Ä–æ–ª—å, –ø—Ä–∞–≤–∞) –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞—à–µ –ø–æ–ª–µ Role
    fieldsets = (
        (None, {'fields': ('username', 'password')}),
        (_('Personal info'), {'fields': ('first_name', 'last_name', 'email')}),
        (_('Permissions'), {
            'fields': ('is_active', 'is_staff', 'is_superuser', 'groups', 'user_permissions'),
        }),
        ('–†–æ–ª—å –≤ —Å–∏—Å—Ç–µ–º–µ', {'fields': ('role',)}), # <--- –ù–ê–®–ï –ü–û–õ–ï
        (_('Important dates'), {'fields': ('last_login', 'date_joined')}),
    )

    # –•–µ–ª–ø–µ—Ä, —á—Ç–æ–±—ã –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –≤ —Å–ø–∏—Å–∫–µ
    def get_company_name(self, obj):
        if hasattr(obj, 'company_profile'):
            return f"{obj.company_profile.company_name} (–ò–ù–ù: {obj.company_profile.inn})"
        return "-"
    get_company_name.short_description = "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è"

    # –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    add_fieldsets = UserAdmin.add_fieldsets + (
        (None, {
            'classes': ('wide',),
            'fields': ('role',),
        }),
    )

==================================================
FILE: .\backend\users\apps.py
==================================================
from django.apps import AppConfig


class UsersConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'users'


==================================================
FILE: .\backend\users\models.py
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\backend\users\serializers.py
==================================================
from rest_framework import serializers
from .models import User, CompanyProfile
from django.db import transaction

class CompanyProfileSerializer(serializers.ModelSerializer):
    class Meta:
        model = CompanyProfile
        fields = ['company_name', 'inn', 'address', 'phone', 'is_manufacturer', 'is_importer', 'is_exporter', 'logo']
        # logo –¥–æ–±–∞–≤–ª–µ–Ω–æ

class RegisterSupplierSerializer(serializers.ModelSerializer):
    company = CompanyProfileSerializer(write_only=True)
    password = serializers.CharField(write_only=True)

    class Meta:
        model = User
        fields = ['username', 'email', 'password', 'company']

    def create(self, validated_data):
        company_data = validated_data.pop('company')
        password = validated_data.pop('password')
        with transaction.atomic():
            user = User.objects.create(
                **validated_data,
                role=User.Roles.SUPPLIER
            )
            user.set_password(password)
            user.save()
            CompanyProfile.objects.create(user=user, **company_data)
        return user

class CurrentUserSerializer(serializers.ModelSerializer):
    # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º SerializerMethodField –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
    company = serializers.SerializerMethodField()

    class Meta:
        model = User
        fields = ['id', 'username', 'email', 'role', 'company']
        read_only_fields = ['id', 'username', 'role']

    def get_company(self, obj):
        # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç (–∫–∞–∫ —É –∞–¥–º–∏–Ω–∞) - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
        try:
            return CompanyProfileSerializer(obj.company_profile).data
        except CompanyProfile.DoesNotExist:
            return None

    def update(self, instance, validated_data):
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–∏–∑–º–µ–Ω–∏–º –ª–æ–≥–∏–∫—É –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞ request.data –≤–æ view –∏–ª–∏ —Ç—É—Ç)
        # DRF —Å–ª–æ–∂–Ω–æ –º–∞–ø–ø–∏—Ç –∑–∞–ø–∏—Å—å –≤ SerializerMethodField.
        # –ß—Ç–æ–±—ã –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å: –¥–ª—è UPDATE –º—ã –±–µ—Ä–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ initial_data

        instance.email = validated_data.get('email', instance.email)
        instance.save()

        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
        # –ú—ã –æ–∂–∏–¥–∞–µ–º, —á—Ç–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏—à–ª–µ—Ç JSON –≤–∏–¥–∞ { "company": { ... } } –∏–ª–∏ { "company_profile": ... }
        # –¢–∞–∫ –∫–∞–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º MethodField, –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –µ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç, –±–µ—Ä–µ–º –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        company_data = self.initial_data.get('company') or self.initial_data.get('company_profile')

        if company_data:
            # –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –∞–¥–º–∏–Ω —Ö–æ—á–µ—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å)
            profile, created = CompanyProfile.objects.get_or_create(user=instance)

            # –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—è
            for attr, value in company_data.items():
                if hasattr(profile, attr):
                    setattr(profile, attr, value)
            profile.save()

        return instance

==================================================
FILE: .\backend\users\tests.py
==================================================
from django.test import TestCase

# Create your tests here.


==================================================
FILE: .\backend\users\urls.py
==================================================
from django.urls import path
from .views import RegisterView, MeView

urlpatterns = [
    path('register/', RegisterView.as_view(), name='register'),
    path('me/', MeView.as_view(), name='users-me'),
]

==================================================
FILE: .\backend\users\views.py
==================================================
from rest_framework import generics, permissions
from .serializers import RegisterSupplierSerializer, CurrentUserSerializer
from .models import User

class RegisterView(generics.CreateAPIView):
    queryset = User.objects.all()
    permission_classes = [permissions.AllowAny] # –†–∞–∑—Ä–µ—à–µ–Ω–æ –≤—Å–µ–º
    serializer_class = RegisterSupplierSerializer

class MeView(generics.RetrieveUpdateAPIView):
    """–í–µ—Ä–Ω—É—Ç—å –∏–Ω—Ñ–æ –æ —Ç–µ–∫—É—â–µ–º –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω–æ–º —é–∑–µ—Ä–µ"""
    permission_classes = [permissions.IsAuthenticated]
    serializer_class = CurrentUserSerializer

    def get_object(self):
        return self.request.user

==================================================
FILE: .\backend\users\__init__.py
==================================================


==================================================
FILE: .\backend\users\migrations\0001_initial.py
==================================================
# Generated by Django 4.2.26 on 2025-12-01 20:49

import django.contrib.auth.models
import django.contrib.auth.validators
from django.db import migrations, models
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('username', models.CharField(error_messages={'unique': 'A user with that username already exists.'}, help_text='Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.', max_length=150, unique=True, validators=[django.contrib.auth.validators.UnicodeUsernameValidator()], verbose_name='username')),
                ('first_name', models.CharField(blank=True, max_length=150, verbose_name='first name')),
                ('last_name', models.CharField(blank=True, max_length=150, verbose_name='last name')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='email address')),
                ('is_staff', models.BooleanField(default=False, help_text='Designates whether the user can log into this admin site.', verbose_name='staff status')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this user should be treated as active. Unselect this instead of deleting accounts.', verbose_name='active')),
                ('date_joined', models.DateTimeField(default=django.utils.timezone.now, verbose_name='date joined')),
                ('role', models.CharField(choices=[('ADMIN', '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'), ('PRODUCER', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å'), ('IMPORTER', '–ò–º–ø–æ—Ä—Ç–µ—Ä'), ('EXPORTER', '–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä'), ('USER', '–ò—Å–ø–æ–ª—å–∑—É—é—â–∏–π'), ('CONTROLLER', '–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∏–π'), ('RESEARCHER', '–ù–∞—É—á–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫')], default='USER', max_length=50, verbose_name='–†–æ–ª—å')),
                ('inn', models.CharField(blank=True, max_length=20, null=True, verbose_name='–ò–ù–ù')),
                ('company_name', models.CharField(blank=True, max_length=255, null=True, verbose_name='–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è')),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'verbose_name': 'user',
                'verbose_name_plural': 'users',
                'abstract': False,
            },
            managers=[
                ('objects', django.contrib.auth.models.UserManager()),
            ],
        ),
    ]


==================================================
FILE: .\backend\users\migrations\0002_remove_user_company_name_remove_user_inn_and_more.py
==================================================
# Generated by Django 4.2.26 on 2025-12-03 17:30

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('users', '0001_initial'),
    ]

    operations = [
        migrations.RemoveField(
            model_name='user',
            name='company_name',
        ),
        migrations.RemoveField(
            model_name='user',
            name='inn',
        ),
        migrations.AlterField(
            model_name='user',
            name='role',
            field=models.CharField(choices=[('ADMIN', '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'), ('SUPPLIER', '–ü–æ—Å—Ç–∞–≤—â–∏–∫ (–Æ—Ä.–ª–∏—Ü–æ)'), ('USER', '–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')], default='USER', max_length=20, verbose_name='–†–æ–ª—å'),
        ),
        migrations.CreateModel(
            name='CompanyProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company_name', models.CharField(max_length=255, verbose_name='–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏')),
                ('inn', models.CharField(max_length=20, unique=True, verbose_name='–ò–ù–ù')),
                ('address', models.TextField(blank=True, verbose_name='–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å')),
                ('phone', models.CharField(blank=True, max_length=20, verbose_name='–¢–µ–ª–µ—Ñ–æ–Ω')),
                ('website', models.URLField(blank=True, verbose_name='–°–∞–π—Ç')),
                ('is_manufacturer', models.BooleanField(default=False, verbose_name='–ú—ã - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å')),
                ('is_importer', models.BooleanField(default=False, verbose_name='–ú—ã - –ò–º–ø–æ—Ä—Ç–µ—Ä')),
                ('is_exporter', models.BooleanField(default=False, verbose_name='–ú—ã - –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='company_profile', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]


==================================================
FILE: .\backend\users\migrations\0003_companyprofile_logo.py
==================================================
# Generated by Django 4.2.27 on 2025-12-08 20:50

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('users', '0002_remove_user_company_name_remove_user_inn_and_more'),
    ]

    operations = [
        migrations.AddField(
            model_name='companyprofile',
            name='logo',
            field=models.ImageField(blank=True, null=True, upload_to='company_logos/', verbose_name='–õ–æ–≥–æ—Ç–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'),
        ),
    ]


==================================================
FILE: .\backend\users\migrations\__init__.py
==================================================


==================================================
FILE: .\frontend\.gitignore
==================================================
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?


==================================================
FILE: .\frontend\Dockerfile
==================================================
FROM node:20-alpine

WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º package.json, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
COPY package*.json ./
RUN npm install

# –ö–æ–ø–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
COPY . .

# –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç
EXPOSE 5173

# –ó–∞–ø—É—Å–∫–∞–µ–º –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å —Ñ–ª–∞–≥–æ–º --host (–≤–∞–∂–Ω–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞)
CMD ["npm", "run", "dev", "--", "--host"]

==================================================
FILE: .\frontend\eslint.config.js
==================================================
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
  },
])


==================================================
FILE: .\frontend\index.html
==================================================
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>frontend</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>


==================================================
FILE: .\frontend\package.json
==================================================
{
  "name": "frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@emotion/react": "^11.14.0",
    "@emotion/styled": "^11.14.1",
    "@fontsource/roboto": "^5.2.9",
    "@mui/icons-material": "^7.3.6",
    "@mui/material": "^7.3.6",
    "@mui/x-data-grid": "^8.21.0",
    "@tanstack/react-query": "^5.90.12",
    "autosuggest-highlight": "^3.3.4",
    "axios": "^1.13.2",
    "formik": "^2.4.9",
    "jwt-decode": "^4.0.0",
    "notistack": "^3.0.2",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-pdf": "^10.2.0",
    "react-router-dom": "^7.10.1",
    "yup": "^1.7.1"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/node": "^24.10.1",
    "@types/react": "^19.2.5",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^5.1.1",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "typescript": "~5.9.3",
    "typescript-eslint": "^8.46.4",
    "vite": "^7.2.4"
  }
}


==================================================
FILE: .\frontend\README.md
==================================================
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...

      // Remove tseslint.configs.recommended and replace with this
      tseslint.configs.recommendedTypeChecked,
      // Alternatively, use this for stricter rules
      tseslint.configs.strictTypeChecked,
      // Optionally, add this for stylistic rules
      tseslint.configs.stylisticTypeChecked,

      // Other configs...
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...
      // Enable lint rules for React
      reactX.configs['recommended-typescript'],
      // Enable lint rules for React DOM
      reactDom.configs.recommended,
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```


==================================================
FILE: .\frontend\tsconfig.app.json
==================================================
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2022",
    "useDefineForClassFields": true,
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "types": ["vite/client"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}


==================================================
FILE: .\frontend\tsconfig.json
==================================================
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ]
}


==================================================
FILE: .\frontend\tsconfig.node.json
==================================================
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "types": ["node"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}


==================================================
FILE: .\frontend\vite.config.ts
==================================================
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  server: {
    host: true, // –ù—É–∂–µ–Ω –¥–ª—è Docker
    port: 5173,
    watch: {
      usePolling: true, // –ù—É–∂–µ–Ω –¥–ª—è Windows/Docker
    },
    proxy: {
      '/api': {
        target: 'http://api:8000', // –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ Django –∏–∑ docker-compose
        changeOrigin: true,
        secure: false,
      },
      // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
      '/media': {
        target: 'http://api:8000',
        changeOrigin: true,
      }
    }
  }
})

==================================================
FILE: .\frontend\public\vite.svg
==================================================
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>

==================================================
FILE: .\frontend\src\App.tsx
==================================================
import { Routes, Route, Navigate } from 'react-router-dom';
import { SnackbarProvider } from 'notistack';

// –°—Ç—Ä–∞–Ω–∏—Ü—ã
import HomePage from './pages/Public/HomePage'; // <--- –ù–û–í–´–ô –ò–ú–ü–û–†–¢
import LandingPage from './pages/Public/LandingPage'; // –≠—Ç–æ —Ç–µ–ø–µ—Ä—å —Å—Ç—Ä–∞–Ω–∏—Ü–∞ "–†–µ–µ—Å—Ç—Ä"
import LoginPage from './pages/Auth/LoginPage';
import RegisterPage from './pages/Auth/RegisterPage';
import PublicElementPage from './pages/Public/PublicElementPage';
import StatisticsPage from './pages/Public/StatisticsPage';

// Dashboard
import DashboardLayout from './components/Layout/DashboardLayout';
import SubstancesList from './pages/Dashboard/SubstancesList';
import ElementPage from './pages/Dashboard/ElementPage';
import ImportPage from './pages/Dashboard/ImportPage';
import OrganizationPage from './pages/Dashboard/OrganizationPage';

// Context
import { useAuth } from './context/AuthContext';

const PrivateRoute = ({ children }: { children: JSX.Element }) => {
    const { isAuthenticated } = useAuth();
    return isAuthenticated ? children : <Navigate to="/login" />;
};

function App() {
    return (
        <Routes>
            {/* 1. –ü–£–ë–õ–ò–ß–ù–´–ï –ú–ê–†–®–†–£–¢–´ */}
            <Route path="/" element={<HomePage />} />          {/* <--- –ì–õ–ê–í–ù–ê–Ø */}
            <Route path="/registry" element={<LandingPage />} /> {/* <--- –†–ï–ï–°–¢–† (–ë–´–í–®–ò–ô –õ–ï–ù–î–ò–ù–ì) */}

            <Route path="/statistics" element={<StatisticsPage />} />
            <Route path="/public/:id" element={<PublicElementPage />} />
            <Route path="/login" element={<LoginPage />} />
            <Route path="/register" element={<RegisterPage />} />

            {/* 2. –ö–ê–ë–ò–ù–ï–¢ */}
            <Route path="/dashboard" element={<PrivateRoute><DashboardLayout /></PrivateRoute>}>
                <Route index element={<Navigate to="elements" replace />} />
                <Route path="elements" element={<SubstancesList />} />
                <Route path="elements/new" element={<ElementPage />} />
                <Route path="elements/:id" element={<ElementPage />} />
                <Route path="import" element={<ImportPage />} />
                <Route path="profile" element={<OrganizationPage />} />
            </Route>

            <Route path="*" element={<Navigate to="/" />} />
        </Routes>
    );
}

export default App;

==================================================
FILE: .\frontend\src\index.css
==================================================
body { margin: 0; padding: 0; background-color: #F3F6F9; }

==================================================
FILE: .\frontend\src\main.tsx
==================================================
import React from 'react'
import ReactDOM from 'react-dom/client'
import { ThemeProvider, CssBaseline } from '@mui/material';
import { BrowserRouter } from 'react-router-dom';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { SnackbarProvider } from 'notistack';

// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à AuthProvider (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª context/AuthContext.tsx —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
import { AuthProvider } from './context/AuthContext';

import App from './App.tsx'
import theme from './theme';
// import './index.css' // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ, –µ—Å–ª–∏ —Ñ–∞–π–ª index.css —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

// –®—Ä–∏—Ñ—Ç—ã
import '@fontsource/roboto/300.css';
import '@fontsource/roboto/400.css';
import '@fontsource/roboto/500.css';
import '@fontsource/roboto/700.css';

// –ö–ª–∏–µ–Ω—Ç –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById('root')!).render(
    <React.StrictMode>
        <QueryClientProvider client={queryClient}>
            <AuthProvider> {/* –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */}
                <ThemeProvider theme={theme}> {/* –ü—Ä–æ–≤–∞–π–¥–µ—Ä —Ç–µ–º—ã */}
                    <CssBaseline />
                    {/* –ü—Ä–æ–≤–∞–π–¥–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - –±–µ–∑ —Ç—Ä–æ–µ—Ç–æ—á–∏—è, —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ */}
                    <SnackbarProvider maxSnack={3} anchorOrigin={{ vertical: 'top', horizontal: 'right' }}>
                        <BrowserRouter>
                            <App />
                        </BrowserRouter>
                    </SnackbarProvider>
                </ThemeProvider>
            </AuthProvider>
        </QueryClientProvider>
    </React.StrictMode>,
)

==================================================
FILE: .\frontend\src\theme.ts
==================================================
import { createTheme } from '@mui/material/styles';

// –ü–∞–ª–∏—Ç—Ä–∞ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ my.gov.uz / tax.uz)
const GOV_BLUE = '#2563EB'; // –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∏–Ω–∏–π
const GOV_DARK = '#1E3A8A'; // –¢–µ–º–Ω–æ-—Å–∏–Ω–∏–π –¥–ª—è —à–∞–ø–æ–∫
const GOV_GREEN = '#10B981'; // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Ñ–ª–∞–≥)

const theme = createTheme({
    palette: {
        primary: {
            main: GOV_BLUE,
            dark: GOV_DARK,
            contrastText: '#ffffff',
        },
        secondary: {
            main: GOV_GREEN,
        },
        background: {
            default: '#F3F6F9', // –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ñ–æ–Ω
            paper: '#FFFFFF',
        },
    },
    typography: {
        fontFamily: '"Roboto", "Helvetica", "Arial", sans-serif',
        h1: { fontSize: '2.5rem', fontWeight: 700, color: GOV_DARK },
        h2: { fontSize: '2rem', fontWeight: 600, color: GOV_DARK },
        button: { textTransform: 'none', fontWeight: 500 }, // –£–±–∏—Ä–∞–µ–º –∫–∞–ø—Å —É –∫–Ω–æ–ø–æ–∫
    },
    components: {
        MuiButton: {
            styleOverrides: {
                root: {
                    borderRadius: 8, // –°–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã
                    boxShadow: 'none',
                    '&:hover': { boxShadow: '0 2px 5px rgba(0,0,0,0.1)' },
                },
            },
        },
        MuiCard: {
            styleOverrides: {
                root: {
                    borderRadius: 12,
                    border: '1px solid #e0e0e0',
                    boxShadow: '0 2px 4px rgba(0,0,0,0.05)',
                },
            },
        },
        MuiAppBar: {
            styleOverrides: {
                root: {
                    background: `linear-gradient(90deg, ${GOV_DARK} 0%, ${GOV_BLUE} 100%)`,
                    boxShadow: '0 2px 10px rgba(0,0,0,0.1)',
                },
            },
        },
    },
});

export default theme;

==================================================
FILE: .\frontend\src\api\auth.ts
==================================================
import client from './client';

export interface CompanyData {
    company_name: string;
    inn: string;
    address: string;
    phone: string;
    is_manufacturer: boolean;
    is_importer: boolean;
    is_exporter: boolean;
}

export interface RegisterData {
    username: string;
    email: string;
    password: string;
    company: CompanyData;
}

export const registerUser = async (data: RegisterData) => {
    const response = await client.post('/auth/register/', data);
    return response.data;
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è (–ö—Ç–æ —è?)
export const getProfile = async () => {
    const response = await client.get<{username:string, role:string, company: CompanyData}>('/auth/me/');
    return response.data;
};
export const updateProfile = async (data: any) => {
    // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ–º —Ñ–∞–π–ª, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FormData
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç–∞–º —Ñ–∞–π–ª
    const isMultipart = data instanceof FormData;

    const response = await client.patch('/auth/me/', data, {
        headers: isMultipart ? { 'Content-Type': 'multipart/form-data' } : {}
    });
    return response.data;
};

==================================================
FILE: .\frontend\src\api\client.ts
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\frontend\src\api\registry.ts
==================================================
import client from './client';

// === 1. –¢–ò–ü–´ –î–ê–ù–ù–´–• (INTERFACES) ===

export interface ChemicalElement {
    id: number;
    cas_number: string | null;
    primary_name_ru: string;
    status: 'DRAFT' | 'PENDING' | 'PUBLISHED' | 'REJECTED';
    updated_at: string;
    hazard_class?: string;
}

export interface PaginatedResponse<T> {
    count: number;
    next: string | null;
    previous: string | null;
    results: T[];
}

export interface TaskResponse {
    task_id: string;
    status: 'PENDING' | 'PROGRESS' | 'SUCCESS' | 'DONE' | 'FAILURE' | 'ERROR';
    result?: {
        status?: string;
        imported?: number;
        errors?: string[];
    };
}

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–∏—Å–∫–∞
export interface SuggestionItem {
    label: string;
    type: string;
    id: number;
}

// === 2. API –§–£–ù–ö–¶–ò–ò ===

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤–µ—â–µ—Å—Ç–≤
export const getMyElements = async () => {
    const response = await client.get<PaginatedResponse<ChemicalElement>>('/registry/elements/');
    return response.data;
};

// –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞ (–ü–æ–¥—Å–∫–∞–∑–∫–∏)
export const getSuggestions = async (query: string) => {
    if (!query || query.length < 2) return [];
    const response = await client.get<SuggestionItem[]>('/registry/elements/suggest/', {
        params: { search: query }
    });
    return response.data;
};

// –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ Excel
export const downloadTemplate = async () => {
    const response = await client.get('/registry/import/template/', {
        responseType: 'blob', // –í–∞–∂–Ω–æ: –æ—Ç–≤–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–π
    });
    const url = window.URL.createObjectURL(new Blob([response.data]));
    const link = document.createElement('a');
    link.href = url;
    link.setAttribute('download', 'registry_template.xlsx');
    document.body.appendChild(link);
    link.click();
    link.parentNode?.removeChild(link);
};

// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ (–ù–∞—á–∞–ª–æ –∏–º–ø–æ—Ä—Ç–∞)
export const uploadFile = async (file: File) => {
    const formData = new FormData();
    formData.append('file', file);

    const response = await client.post<{task_id: string}>('/registry/import/upload/', formData, {
        headers: { 'Content-Type': 'multipart/form-data' }
    });
    return response.data;
};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏ (Polling)
export const checkTask = async (taskId: string) => {
    const response = await client.get<TaskResponse>(`/registry/tasks/${taskId}/`);
    return response.data;
};

export const getElementById = async (id: string | number) => {
    const response = await client.get<any>(`/registry/elements/${id}/`);
    return response.data;
};

// –°–∫–∞—á–∞—Ç—å –ü–∞—Å–ø–æ—Ä—Ç (PDF)
export const downloadPassport = async (id: number | string, filename?: string) => {
    const response = await client.get(`/registry/elements/${id}/pdf/`, {
        responseType: 'blob'
    });

    const url = window.URL.createObjectURL(new Blob([response.data]));
    const link = document.createElement('a');
    link.href = url;
    link.setAttribute('download', filename || `passport_${id}.pdf`);
    document.body.appendChild(link);
    link.click();

    link.parentNode?.removeChild(link);
    window.URL.revokeObjectURL(url);
};

// –û–±–Ω–æ–≤–∏—Ç—å (PATCH)
export const updateElement = async (id: string | number, data: any) => {
    const response = await client.patch(`/registry/elements/${id}/`, data);
    return response.data;
};

// –°–æ–∑–¥–∞—Ç—å (POST)
export const createElement = async (data: any) => {
    const response = await client.post('/registry/elements/', data);
    return response.data;
};

export const uploadElementFile = async (elementId: string | number, file: File, description: string, docType: string) => {
    const formData = new FormData();
    formData.append('file', file);
    formData.append('description', description);
    formData.append('doc_type', docType);

    const response = await client.post(`/registry/elements/${elementId}/upload_attachment/`, formData, {
        headers: { 'Content-Type': 'multipart/form-data' }
    });
    return response.data;
};

export const deleteElementFile = async (elementId: string | number, attachmentId: number) => {
    await client.delete(`/registry/elements/${elementId}/delete_attachment/${attachmentId}/`);
};

export const uploadStructureImage = async (elementId: string | number, file: File) => {
    const formData = new FormData();
    formData.append('image', file);
    const response = await client.post(`/registry/elements/${elementId}/upload_structure/`, formData, {
        headers: { 'Content-Type': 'multipart/form-data' }
    });
    return response.data;
};

// –í –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ frontend/src/api/registry.ts

export const getStatistics = async () => {
    const response = await client.get('/registry/stats/');
    return response.data;
};

==================================================
FILE: .\frontend\src\api\support.ts
==================================================
import client from './client';

export interface SupportTicketData {
    subject: string;
    message: string;
    contact_email?: string; // –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å email
    file: File | null;
}

export const sendSupportTicket = async (data: SupportTicketData) => {
    const formData = new FormData();
    formData.append('subject', data.subject);
    formData.append('message', data.message);
    if (data.contact_email) {
        formData.append('contact_email', data.contact_email);
    }
    if (data.file) {
        formData.append('file', data.file);
    }

    const response = await client.post('/support/tickets/', formData, {
        headers: { 'Content-Type': 'multipart/form-data' }
    });
    return response.data;
};

==================================================
FILE: .\frontend\src\assets\react.svg
==================================================
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>

==================================================
FILE: .\frontend\src\components\Layout\DashboardLayout.tsx
==================================================
import { useState } from 'react';
import { Outlet, useNavigate, useLocation } from 'react-router-dom';
import {
    Box, AppBar, Toolbar, Typography, IconButton, Drawer,
    List, ListItem, ListItemButton, ListItemIcon, ListItemText,
    Divider, Avatar, Menu, MenuItem, CircularProgress
} from '@mui/material';
import {
    Menu as MenuIcon,
    Science,
    CloudUpload,
    Dashboard,
    Business, // –ò–∫–æ–Ω–∫–∞ –û—Ñ–∏—Å–∞
    Logout,
    Person
} from '@mui/icons-material';
import { useAuth } from '../../context/AuthContext';
import { useQuery } from '@tanstack/react-query';
import { getProfile } from '../../api/auth';

const DRAWER_WIDTH = 280;

const DashboardLayout = () => {
    const [mobileOpen, setMobileOpen] = useState(false);
    const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);
    const { logout } = useAuth();
    const navigate = useNavigate();
    const location = useLocation();

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å
    const { data: userProfile, isLoading } = useQuery({
        queryKey: ['profile'],
        queryFn: getProfile,
        staleTime: 1000 * 60 * 5
    });

    const menuItems = [
        { text: '–ú–æ–∏ –í–µ—â–µ—Å—Ç–≤–∞', icon: <Science />, path: '/dashboard/elements' },
        { text: '–ò–º–ø–æ—Ä—Ç Excel', icon: <CloudUpload />, path: '/dashboard/import' },
        // –î–æ–±–∞–≤–ª–µ–Ω –ø—É–Ω–∫—Ç –ø—Ä–æ—Ñ–∏–ª—è
        { text: '–û–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', icon: <Business />, path: '/dashboard/profile' },
    ];

    const handleLogout = () => {
        logout();
        navigate('/login');
    };

    const formatRole = (user: any) => {
        if (!user?.company) return user?.role;
        const roles = [];
        if (user.company.is_manufacturer) roles.push('–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å');
        if (user.company.is_importer) roles.push('–ò–º–ø–æ—Ä—Ç–µ—Ä');
        if (roles.length === 0) return "–ü–æ—Å—Ç–∞–≤—â–∏–∫";
        return roles.join(' / ');
    };

    const drawerContent = (
        <div>
            <Toolbar sx={{ bgcolor: '#1e3a8a', color: 'white', display:'flex', gap:1 }}>
                <Dashboard />
                <Typography variant="subtitle1" fontWeight="bold">–ö–ê–ë–ò–ù–ï–¢</Typography>
            </Toolbar>
            <Divider />
            <List sx={{ pt: 2 }}>
                {menuItems.map((item) => (
                    <ListItem key={item.text} disablePadding sx={{ mb: 1 }}>
                        <ListItemButton
                            selected={location.pathname === item.path}
                            onClick={() => navigate(item.path)}
                            sx={{
                                borderRadius: '0 50px 50px 0',
                                mr: 2, pl: 3,
                                '&.Mui-selected': {
                                    bgcolor: '#e3f2fd', color: '#1565c0', borderLeft: '4px solid #1565c0',
                                    '& .MuiListItemIcon-root': { color: '#1565c0' }
                                }
                            }}
                        >
                            <ListItemIcon sx={{ minWidth: 40, color: location.pathname === item.path ? 'inherit' : 'grey.600' }}>
                                {item.icon}
                            </ListItemIcon>
                            <ListItemText primary={item.text} primaryTypographyProps={{ fontWeight: 500, fontSize: '0.95rem' }} />
                        </ListItemButton>
                    </ListItem>
                ))}
            </List>
        </div>
    );

    return (
        <Box sx={{ display: 'flex', minHeight: '100vh', bgcolor: '#f4f6f8' }}>
            {/* –•–µ–¥–µ—Ä */}
            <AppBar position="fixed" sx={{ zIndex: (theme) => theme.zIndex.drawer + 1, bgcolor: '#2563eb' }} elevation={0}>
                <Toolbar>
                    <IconButton color="inherit" edge="start" onClick={() => setMobileOpen(!mobileOpen)} sx={{ mr: 2, display: { sm: 'none' } }}>
                        <MenuIcon />
                    </IconButton>

                    <Typography variant="h6" noWrap component="div" sx={{ flexGrow: 1, fontWeight:'bold' }}>
                        –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –†–µ–µ—Å—Ç—Ä –û–•–í
                    </Typography>

                    {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å */}
                    <Box display="flex" alignItems="center" gap={2}>
                        {isLoading ? <CircularProgress size={24} color="inherit" /> : (
                            <Box sx={{ textAlign: 'right', display: { xs: 'none', md: 'block' } }}>
                                <Typography variant="body2" fontWeight="bold">
                                    {userProfile?.company?.company_name || userProfile?.username}
                                </Typography>
                                <Typography variant="caption" sx={{ bgcolor: 'rgba(255,255,255,0.2)', px: 1, borderRadius: 1 }}>
                                    {formatRole(userProfile)}
                                </Typography>
                            </Box>
                        )}

                        <IconButton onClick={(e) => setAnchorEl(e.currentTarget)} sx={{ p: 0 }}>
                            <Avatar sx={{ bgcolor: 'white', color: 'primary.main' }}>
                                <Person />
                            </Avatar>
                        </IconButton>
                    </Box>

                    <Menu anchorEl={anchorEl} open={Boolean(anchorEl)} onClose={() => setAnchorEl(null)}>
                        <MenuItem onClick={handleLogout}>
                            <ListItemIcon><Logout fontSize="small" /></ListItemIcon>
                            –í—ã–π—Ç–∏
                        </MenuItem>
                    </Menu>
                </Toolbar>
            </AppBar>

            {/* –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é */}
            <Box component="nav" sx={{ width: { sm: DRAWER_WIDTH }, flexShrink: { sm: 0 } }}>
                <Drawer
                    variant="temporary"
                    open={mobileOpen}
                    onClose={() => setMobileOpen(false)}
                    ModalProps={{ keepMounted: true }}
                    sx={{ display: { xs: 'block', sm: 'none' }, '& .MuiDrawer-paper': { boxSizing: 'border-box', width: DRAWER_WIDTH } }}
                >
                    {drawerContent}
                </Drawer>
                <Drawer
                    variant="permanent"
                    sx={{ display: { xs: 'none', sm: 'block' }, '& .MuiDrawer-paper': { boxSizing: 'border-box', width: DRAWER_WIDTH, borderRight: 'none' } }}
                    open
                >
                    {drawerContent}
                </Drawer>
            </Box>

            {/* –ö–æ–Ω—Ç–µ–Ω—Ç */}
            <Box component="main" sx={{ flexGrow: 1, p: 3, width: { sm: `calc(100% - ${DRAWER_WIDTH}px)` } }}>
                <Toolbar />
                <Outlet />
            </Box>
        </Box>
    );
};

export default DashboardLayout;

==================================================
FILE: .\frontend\src\constants\formOptions.ts
==================================================
export const FORM_OPTIONS = {
    appearance: [
        { value: 'SOLID', label: '–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ' },
        { value: 'LIQUID', label: '–ñ–∏–¥–∫–æ—Å—Ç—å' },
        { value: 'GAS', label: '–ì–∞–∑' },
        { value: 'VAPOR', label: '–ü–∞—Ä' },
        { value: 'AEROSOL', label: '–ê—ç—Ä–æ–∑–æ–ª—å' }
    ],
    odor: [
        { value: 'NONE', label: '–ë–µ–∑ –∑–∞–ø–∞—Ö–∞' },
        { value: 'SHARP', label: '–†–µ–∑–∫–∏–π' },
        { value: 'SPECIFIC', label: '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π' },
        { value: 'FRUIT', label: '–§—Ä—É–∫—Ç–æ–≤—ã–π' },
        { value: 'OTHER', label: '–î—Ä—É–≥–æ–µ' }
    ],
    state_in_air: [
        { value: 'P', label: '–ü–∞—Ä—ã (–ø)' },
        { value: 'A', label: '–ê—ç—Ä–æ–∑–æ–ª—å (–∞)' },
        { value: 'PA', label: '–°–º–µ—Å—å (–ø+–∞)' }
    ],
    limit_sign: [
        { value: 'REFLEX', label: '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω—ã–π' },
        { value: 'RESORPTIVE', label: '–†–µ–∑–æ—Ä–±—Ç–∏–≤–Ω—ã–π' },
        { value: 'REF_RES', label: '–†–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ-—Ä–µ–∑–æ—Ä–±—Ç–∏–≤–Ω—ã–π' },
        { value: 'SANITARY', label: '–°–∞–Ω–∏—Ç–∞—Ä–Ω–æ-–±—ã—Ç–æ–≤–æ–π' }
    ],
    yes_no_unknown: [
        { value: 'UNKNOWN', label: '–ù–µ—Ç —Å–≤–µ–¥–µ–Ω–∏–π' },
        { value: 'YES', label: '–î–∞ / –í–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç' },
        { value: 'NO', label: '–ù–µ—Ç / –ù–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç' }
    ],
    ghs_category: [
        { value: 'NC', label: '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è' },
        { value: '1', label: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1' },
        { value: '1A', label: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1A' },
        { value: '1B', label: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 1B' },
        { value: '2', label: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 2' },
        { value: '3', label: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è 3' }
    ],
    sanpin_class: [
        { value: 'NC', label: '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è' },
        { value: '1', label: '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ' },
        { value: '2', label: '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ' },
        { value: '3', label: '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ' },
        { value: '4', label: '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ' }
    ],
    persistence: [
        { value: '', label: '–ù–µ –≤—ã–±—Ä–∞–Ω–æ' },
        { value: 'LOW', label: '–ú–∞–ª–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (<20 –¥–Ω)' },
        { value: 'MED', label: '–°—Ä–µ–¥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã–µ (20-90 –¥–Ω)' },
        { value: 'HIGH', label: '–£—Å—Ç–æ–π—á–∏–≤—ã–µ (>90 –¥–Ω)' }
    ],
    migration: [
        { value: '', label: '–ù–µ –≤—ã–±—Ä–∞–Ω–æ' },
        { value: 'MOB', label: '–ü–æ–¥–≤–∏–∂–µ–Ω' },
        { value: 'IMM', label: '–ú–∞–ª–æ–ø–æ–¥–≤–∏–∂–µ–Ω' }
    ],
    sorption: [
        { value: '', label: '–ù–µ –≤—ã–±—Ä–∞–Ω–æ' },
        { value: 'STR', label: '–°–∏–ª—å–Ω–∞—è' },
        { value: 'WEAK', label: '–°–ª–∞–±–∞—è' }
    ],
    signal_word: [
        { value: 'NONE', label: '–ù–µ—Ç' },
        { value: 'DANGER', label: '–û–ü–ê–°–ù–û (Danger)' },
        { value: 'WARNING', label: '–û–°–¢–û–†–û–ñ–ù–û (Warning)' }
    ]
};

==================================================
FILE: .\frontend\src\context\AuthContext.tsx
==================================================
import React, { createContext, useContext, useState, useEffect } from 'react';
import client from '../api/client';
import { jwtDecode } from "jwt-decode"; // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∏–º–ø–æ—Ä—Ç jwt-decode (–æ–Ω –∫–∞–ø—Ä–∏–∑–Ω—ã–π)

interface AuthContextType {
    token: string | null;
    isAuthenticated: boolean;
    login: (token: string, refresh: string) => void;
    logout: () => void;
}

const AuthContext = createContext<AuthContextType | null>(null);

export const AuthProvider = ({ children }: { children: React.ReactNode }) => {
    const [token, setToken] = useState<string | null>(localStorage.getItem('access_token'));

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    const isAuthenticated = !!token;

    const login = (accessToken: string, refreshToken: string) => {
        localStorage.setItem('access_token', accessToken);
        localStorage.setItem('refresh_token', refreshToken);
        setToken(accessToken);
        // client.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`; // –ú–æ–∂–Ω–æ –∏ —Ç–∞–∫
    };

    const logout = () => {
        localStorage.removeItem('access_token');
        localStorage.removeItem('refresh_token');
        setToken(null);
    };

    return (
        <AuthContext.Provider value={{ token, isAuthenticated, login, logout }}>
            {children}
        </AuthContext.Provider>
    );
};

// –•—É–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
export const useAuth = () => {
    const context = useContext(AuthContext);
    if (!context) throw new Error("useAuth must be used within AuthProvider");
    return context;
};

==================================================
FILE: .\frontend\src\hooks\useDebounce.ts
==================================================
import { useState, useEffect } from 'react';

// –•—É–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ delay –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–≤–æ–¥–∞
export function useDebounce<T>(value: T, delay: number): T {
    const [debouncedValue, setDebouncedValue] = useState<T>(value);

    useEffect(() => {
        const handler = setTimeout(() => {
            setDebouncedValue(value);
        }, delay);

        return () => {
            clearTimeout(handler);
        };
    }, [value, delay]);

    return debouncedValue;
}

==================================================
FILE: .\frontend\src\pages\Auth\LoginPage.tsx
==================================================
import { useState } from 'react';
import { useFormik } from 'formik';
import * as Yup from 'yup';
import { Box, Button, TextField, Typography, Card, Container, Alert, LinearProgress } from '@mui/material';
import { useAuth } from '../../context/AuthContext';
import client from '../../api/client';
import { useNavigate, Link } from 'react-router-dom';


const LoginPage = () => {
    const { login } = useAuth();
    const navigate = useNavigate();
    const [errorMsg, setErrorMsg] = useState<string | null>(null);

    const formik = useFormik({
        initialValues: {
            username: '',
            password: '',
        },
        validationSchema: Yup.object({
            username: Yup.string().required('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω'),
            password: Yup.string().required('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å'),
        }),
        onSubmit: async (values, { setSubmitting }) => {
            setErrorMsg(null);
            try {
                // –ó–∞–ø—Ä–æ—Å –∫ Django
                const res = await client.post('/token/', values);

                // –ï—Å–ª–∏ —É—Å–ø–µ—Ö - —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã
                login(res.data.access, res.data.refresh);

                // –ò –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–∞–±–∏–Ω–µ—Ç
                navigate('/dashboard');
            } catch (err: any) {
                console.error(err);
                setErrorMsg('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            } finally {
                setSubmitting(false);
            }
        },
    });

    return (
        <Container maxWidth="xs" sx={{ height: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
            <Card sx={{ p: 4, width: '100%', display: 'flex', flexDirection: 'column', gap: 2 }}>
                <Box sx={{ mt: 2, textAlign: 'center' }}>
                    <Typography variant="body2" color="text.secondary">
                        –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?{' '}
                        <Link to="/register" style={{ fontWeight: 'bold', color: '#1976d2', textDecoration: 'none' }}>
                            –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                        </Link>
                    </Typography>
                </Box>
                <Box sx={{ textAlign: 'center', mb: 2 }}>
                    <Box sx={{ width: 60, height: 60, bgcolor: '#1E3A8A', color: 'white', borderRadius: '50%', margin: '0 auto', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 'bold', fontSize: 20 }}>
                        UZ
                    </Box>
                    <Typography variant="h5" sx={{ mt: 2, fontWeight: 700, color: '#1E3A8A' }}>
                        –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
                    </Typography>
                    <Typography variant="body2" color="text.secondary">
                        –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –û–•–í
                    </Typography>
                </Box>

                {formik.isSubmitting && <LinearProgress />}
                {errorMsg && <Alert severity="error">{errorMsg}</Alert>}

                <form onSubmit={formik.handleSubmit}>
                    <TextField
                        fullWidth
                        id="username"
                        name="username"
                        label="–õ–æ–≥–∏–Ω / –ò–ù–ù"
                        margin="normal"
                        value={formik.values.username}
                        onChange={formik.handleChange}
                        error={formik.touched.username && Boolean(formik.errors.username)}
                        helperText={formik.touched.username && formik.errors.username}
                    />
                    <TextField
                        fullWidth
                        id="password"
                        name="password"
                        label="–ü–∞—Ä–æ–ª—å"
                        type="password"
                        margin="normal"
                        value={formik.values.password}
                        onChange={formik.handleChange}
                        error={formik.touched.password && Boolean(formik.errors.password)}
                        helperText={formik.touched.password && formik.errors.password}
                    />

                    <Button
                        color="primary"
                        variant="contained"
                        fullWidth
                        type="submit"
                        sx={{ mt: 3, py: 1.5, fontSize: '1rem' }}
                        disabled={formik.isSubmitting}
                    >
                        –í–æ–π—Ç–∏
                    </Button>
                </form>
            </Card>
        </Container>
    );
};

export default LoginPage;

==================================================
FILE: .\frontend\src\pages\Auth\RegisterPage.tsx
==================================================
import { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { useFormik } from 'formik';
import * as Yup from 'yup';
import {
    Container, Card, Typography, Box, TextField, Button, Grid,
    Checkbox, FormControlLabel, Divider, Alert, CircularProgress
} from '@mui/material';
import { registerUser } from '../../api/auth'; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é
import { Business, Person } from '@mui/icons-material';

const RegisterPage = () => {
    const navigate = useNavigate();
    const [serverError, setServerError] = useState('');
    const [success, setSuccess] = useState(false);

    const formik = useFormik({
        initialValues: {
            username: '',
            email: '',
            password: '',
            // –î–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏
            company_name: '',
            inn: '',
            address: '',
            phone: '',
            // –†–æ–ª–∏
            is_manufacturer: false,
            is_importer: false,
            is_exporter: false
        },
        validationSchema: Yup.object({
            username: Yup.string().required('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'),
            email: Yup.string().email('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email').required('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'),
            password: Yup.string().min(6, '–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤').required('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'),
            company_name: Yup.string().required('–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'),
            inn: Yup.string().required('–ò–ù–ù –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω').length(9, '–ò–ù–ù –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 9 —Ü–∏—Ñ—Ä'), // –î–ª—è –ø—Ä–∏–º–µ—Ä–∞
        }),
        onSubmit: async (values, { setSubmitting }) => {
            try {
                setServerError('');
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø–ª–æ—Å–∫–∏–π –æ–±—ä–µ–∫—Ç –≤ –≤–ª–æ–∂–µ–Ω–Ω—ã–π –¥–ª—è API (–∫–∞–∫ –∂–¥–µ—Ç –±—ç–∫–µ–Ω–¥)
                const payload = {
                    username: values.username,
                    email: values.email,
                    password: values.password,
                    company: {
                        company_name: values.company_name,
                        inn: values.inn,
                        address: values.address,
                        phone: values.phone,
                        is_manufacturer: values.is_manufacturer,
                        is_importer: values.is_importer,
                        is_exporter: values.is_exporter
                    }
                };

                await registerUser(payload);
                setSuccess(true);
            } catch (err: any) {
                console.error(err);
                // –ü—ã—Ç–∞–µ–º—Å—è –¥–æ—Å—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏–∑ Django
                const msg = err.response?.data?.username ?
                    `–õ–æ–≥–∏–Ω –∑–∞–Ω—è—Ç` : (JSON.stringify(err.response?.data) || "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞");
                setServerError(msg);
            } finally {
                setSubmitting(false);
            }
        },
    });

    if (success) {
        return (
            <Container maxWidth="sm" sx={{ mt: 10 }}>
                <Card sx={{ p: 5, textAlign: 'center' }}>
                    <Box sx={{ color: 'success.main', mb: 2, fontSize: 60 }}>üéâ</Box>
                    <Typography variant="h4" gutterBottom>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!</Typography>
                    <Typography color="text.secondary" paragraph>
                        –í–∞—à –∞–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–¥ —Å–≤–æ–∏–º –ª–æ–≥–∏–Ω–æ–º.
                    </Typography>
                    <Button variant="contained" size="large" onClick={() => navigate('/login')}>
                        –ü–µ—Ä–µ–π—Ç–∏ –∫ –≤—Ö–æ–¥—É
                    </Button>
                </Card>
            </Container>
        )
    }

    return (
        <Container maxWidth="md" sx={{ py: 8 }}>
            <Box textAlign="center" mb={4}>
                <Typography variant="h4" fontWeight="bold" color="primary.main">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–æ—Å—Ç–∞–≤—â–∏–∫–∞</Typography>
                <Typography color="text.secondary">–ó–∞—è–≤–∫–∞ –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É —Ä–µ–µ—Å—Ç—Ä—É</Typography>
            </Box>

            <form onSubmit={formik.handleSubmit}>
                <Grid container spacing={3}>
                    {/* –ë–õ–û–ö 1: –î–ê–ù–ù–´–ï –í–•–û–î–ê */}
                    <Grid item xs={12} md={5}>
                        <Card sx={{ p: 3, height: '100%' }}>
                            <Box display="flex" alignItems="center" mb={2} gap={1} color="primary.dark">
                                <Person /> <Typography variant="h6">–£—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å</Typography>
                            </Box>

                            {serverError && <Alert severity="error" sx={{ mb: 2 }}>{serverError}</Alert>}

                            <TextField
                                fullWidth label="–õ–æ–≥–∏–Ω (–¥–ª—è –≤—Ö–æ–¥–∞)" name="username"
                                margin="normal"
                                value={formik.values.username} onChange={formik.handleChange}
                                error={Boolean(formik.errors.username)} helperText={formik.errors.username}
                            />
                            <TextField
                                fullWidth label="Email (–¥–ª—è –ø–∏—Å–µ–º)" name="email"
                                margin="normal"
                                value={formik.values.email} onChange={formik.handleChange}
                                error={Boolean(formik.errors.email)} helperText={formik.errors.email}
                            />
                            <TextField
                                fullWidth label="–ü–∞—Ä–æ–ª—å" name="password" type="password"
                                margin="normal"
                                value={formik.values.password} onChange={formik.handleChange}
                                error={Boolean(formik.errors.password)} helperText={formik.errors.password}
                            />
                            <Divider sx={{ my: 3 }} />
                            <Typography variant="body2">
                                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <Link to="/login">–í–æ–π—Ç–∏</Link>
                            </Typography>
                        </Card>
                    </Grid>

                    {/* –ë–õ–û–ö 2: –î–ê–ù–ù–´–ï –ö–û–ú–ü–ê–ù–ò–ò */}
                    <Grid item xs={12} md={7}>
                        <Card sx={{ p: 3, height: '100%' }}>
                            <Box display="flex" alignItems="center" mb={2} gap={1} color="primary.dark">
                                <Business /> <Typography variant="h6">–î–∞–Ω–Ω—ã–µ –Æ—Ä. –õ–∏—Ü–∞</Typography>
                            </Box>

                            <Grid container spacing={2}>
                                <Grid item xs={12}>
                                    <TextField
                                        fullWidth label="–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏" name="company_name"
                                        placeholder="–û–û–û 'Uzkimyosanoat'..."
                                        value={formik.values.company_name} onChange={formik.handleChange}
                                        error={Boolean(formik.errors.company_name)} helperText={formik.errors.company_name}
                                    />
                                </Grid>
                                <Grid item xs={6}>
                                    <TextField
                                        fullWidth label="–ò–ù–ù (STIR)" name="inn"
                                        value={formik.values.inn} onChange={formik.handleChange}
                                        error={Boolean(formik.errors.inn)} helperText={formik.errors.inn}
                                    />
                                </Grid>
                                <Grid item xs={6}>
                                    <TextField
                                        fullWidth label="–¢–µ–ª–µ—Ñ–æ–Ω" name="phone"
                                        value={formik.values.phone} onChange={formik.handleChange}
                                    />
                                </Grid>
                                <Grid item xs={12}>
                                    <TextField
                                        fullWidth label="–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –ê–¥—Ä–µ—Å" name="address"
                                        value={formik.values.address} onChange={formik.handleChange}
                                    />
                                </Grid>
                            </Grid>

                            <Box sx={{ mt: 3, bgcolor: '#f9fafb', p: 2, borderRadius: 2 }}>
                                <Typography variant="subtitle2" gutterBottom>–¢–∏–ø –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–æ—Ç–º–µ—Ç—å—Ç–µ –≤—Å–µ):</Typography>
                                <FormControlLabel
                                    control={<Checkbox name="is_manufacturer" checked={formik.values.is_manufacturer} onChange={formik.handleChange} />}
                                    label="–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å"
                                />
                                <FormControlLabel
                                    control={<Checkbox name="is_importer" checked={formik.values.is_importer} onChange={formik.handleChange} />}
                                    label="–ò–º–ø–æ—Ä—Ç–µ—Ä"
                                />
                                <FormControlLabel
                                    control={<Checkbox name="is_exporter" checked={formik.values.is_exporter} onChange={formik.handleChange} />}
                                    label="–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä"
                                />
                            </Box>

                            <Button
                                fullWidth
                                size="large"
                                variant="contained"
                                color="primary"
                                type="submit"
                                disabled={formik.isSubmitting}
                                sx={{ mt: 3 }}
                            >
                                {formik.isSubmitting ? <CircularProgress size={24}/> : "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"}
                            </Button>
                        </Card>
                    </Grid>
                </Grid>
            </form>
        </Container>
    );
};

export default RegisterPage;

==================================================
FILE: .\frontend\src\pages\Dashboard\ElementPage.tsx
==================================================
import { useState } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useFormik } from 'formik';
import * as Yup from 'yup';
import {
    Box, Button, Paper, Tabs, Tab, TextField, Grid,
    Typography, LinearProgress, MenuItem, Alert, Snackbar,
    FormControlLabel, Switch, Chip, IconButton, List, ListItem,
    ListItemText, ListItemIcon
} from '@mui/material';
import {
    Save, ArrowBack, PictureAsPdf,
    CloudUpload, Delete, InsertDriveFile
} from '@mui/icons-material';
import {
    getElementById, updateElement, createElement, downloadPassport,
    uploadElementFile, deleteElementFile
} from '../../api/registry';
import { uploadStructureImage } from '../../api/registry';
import { FORM_OPTIONS } from '../../constants/formOptions';



// === 1. –°–ü–†–ê–í–û–ß–ù–ò–ö–ò (–í–´–ü–ê–î–ê–Æ–©–ò–ï –°–ü–ò–°–ö–ò) ===


// === 2. –ù–ê–ß–ê–õ–¨–ù–´–ï –ó–ù–ê–ß–ï–ù–ò–Ø ===
const INITIAL_VALUES = {
    primary_name_ru: '',
    cas_number: '',
    sec1_identification: { synonyms: '', molecular_formula: '', structural_formula: '', ec_number: '', iupac_name_ru: '', iupac_name_en: '', tnved_code: '' },
    sec2_physical: { appearance: '', odor: 'OTHER', color: '', ph: '', mol_mass: '', melting_point: '', boiling_point: '', auto_ignition: '', density: '', solubility_water: '' },
    sec3_sanpin: { state_in_air: '', pdk_workzone: '', ld50_stomach: '', ld50_skin: '', lc50_air: '', kvio: '', zone_acute: '', zone_chronic: '' },
    sec4_air: { limit_sign: '', pdk_max_single: '', pdk_daily_avg: '', pdk_month_avg: '', pdk_year_avg: '' },
    sec5_acute: { inhalation_lc50_effect: 'UNKNOWN', inhalation_lc50_val: '', dermal_ld50_effect: 'UNKNOWN', dermal_ld50_val: '', oral_ld50_effect: 'UNKNOWN', oral_ld50_val: '' },
    sec6_risks: { skin_corr: 'NC', eye_dmg: 'NC', sensitization: 'NC', mutagenicity: 'NC', carcinogenicity: 'NC', repro_tox: 'NC', aspiration_hazard: 'NC' },
    sec8_ecotox: { ld50_mammals: '', ld50_fish: '', ld50_bees: '', ld50_birds: '', bioaccumulation: false, phytotoxicity: false },
    sec9_soil: { pdk_soil: '', odk_soil: '', persistence: '', sorption: '', migration: '' },
    sec10_water: { acute_fish: '', acute_algae: '', chronic_fish: '', bioacc_logkow: '' },
    sec11_class: { sanpin_class: 'NC', gost_body_class: 'NC', gost_env_class: 'NC' },
    sec12_ghs: { phys_hazard: '', chem_hazard: '', env_hazard: '' },
    sec13_label: { signal_word: 'NONE', pictogram_code: '', h_phrases: '', p_phrases: '' },
    sec14_safety: { prevent_health: '', first_aid: '', prevent_env: '' },
    sec15_storage: { temp_conditions: '', humidity: '', shelf_life: '', storage_reqs: '', incompatible: '' },
    sec16_waste: { collection: '', transport: '', disposal: '', burial: '' },
    sec17_incidents: { accident_history: '' },
    sec18_intl: { ozone_destroying: false, pops: false, pic: false, mercury: false, basel: false },
    sec20_docs: { gost_standards: '', intl_docs: '' },
    sec21_companies: { info: '' },
    sec22_volumes: { vol_production: '', vol_import: '', vol_export: '' },
    sec23_extra: { recommendations: '' }
};

const VALIDATION_SCHEMA = Yup.object({
    primary_name_ru: Yup.string().required('–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'),
});

// === UI –ö–û–ú–ü–û–ù–ï–ù–¢–´ ===
const FormSection = ({ title, children }: { title: string, children: React.ReactNode }) => (
    <Paper elevation={0} sx={{ p: 3, mb: 3, border: '1px solid #e0e0e0', borderRadius: 2 }}>
        <Typography variant="subtitle2" sx={{ textTransform: 'uppercase', color: 'primary.main', fontWeight: 700, mb: 2, letterSpacing: 0.5 }}>
            {title}
        </Typography>
        <Grid container spacing={3}>
            {children}
        </Grid>
    </Paper>
);

const Field = ({ children, xs = 12, md = 6, lg = 4 }: any) => (
    <Grid item xs={xs} md={md} lg={lg}>{children}</Grid>
);

function TabPanel(props: { children?: React.ReactNode; index: number; value: number }) {
    const { children, value, index, ...other } = props;
    return (
        <div role="tabpanel" hidden={value !== index} {...other} style={{ width: '100%' }}>
            {value === index && <Box sx={{ py: 3 }}>{children}</Box>}
        </div>
    );
}

// === –í–∫–ª–∞–¥–∫–∞ —Ñ–∞–π–ª–æ–≤ ===
const FilesTab = ({ elementId, attachments, onUpdate }: { elementId: string, attachments: any[], onUpdate: () => void }) => {
    const [file, setFile] = useState<File | null>(null);
    const [desc, setDesc] = useState('');
    const [type, setType] = useState('OTHER');
    const [uploading, setUploading] = useState(false);

    const handleUpload = async () => {
        if (!file) return;
        setUploading(true);
        try {
            await uploadElementFile(elementId, file, desc, type);
            onUpdate();
            setFile(null);
            setDesc('');
            setType('OTHER');
        } catch (e) {
            console.error(e);
            alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞');
        } finally {
            setUploading(false);
        }
    };

    const handleDelete = async (attId: number) => {
        if (!confirm("–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?")) return;
        try { await deleteElementFile(elementId, attId); onUpdate(); } catch (e) { console.error(e); }
    };

    return (
        <Grid container spacing={4}>
            <Grid item xs={12} md={5}>
                <Paper sx={{ p: 3, border: '1px dashed #2563eb', borderRadius: 2, bgcolor: '#f8fafc' }}>
                    <Typography variant="subtitle1" fontWeight="bold" gutterBottom>–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</Typography>
                    <Button variant="outlined" component="label" fullWidth startIcon={<CloudUpload />} sx={{ mb: 2, py: 1.5, borderStyle: 'dashed', bgcolor: 'white' }}>
                        {file ? file.name : "–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª..."}
                        <input type="file" hidden onChange={(e) => setFile(e.target.files?.[0] || null)} />
                    </Button>
                    <TextField select fullWidth size="small" label="–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞" value={type} onChange={(e) => setType(e.target.value)} sx={{ mb: 2, bgcolor: 'white' }}>
                        <MenuItem value="PASSPORT">–ü–∞—Å–ø–æ—Ä—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (MSDS)</MenuItem>
                        <MenuItem value="CERTIFICATE">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è</MenuItem>
                        <MenuItem value="LAB_PROTOCOL">–ü—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø—ã—Ç–∞–Ω–∏–π</MenuItem>
                        <MenuItem value="OTHER">–î—Ä—É–≥–æ–µ</MenuItem>
                    </TextField>
                    <TextField fullWidth size="small" label="–û–ø–∏—Å–∞–Ω–∏–µ" value={desc} onChange={(e) => setDesc(e.target.value)} sx={{ mb: 2, bgcolor: 'white' }} />
                    <Button variant="contained" fullWidth disabled={!file || uploading} onClick={handleUpload}>{uploading ? "–ó–∞–≥—Ä—É–∑–∫–∞..." : "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª"}</Button>
                </Paper>
            </Grid>
            <Grid item xs={12} md={7}>
                <Typography variant="subtitle1" fontWeight="bold" gutterBottom>–§–∞–π–ª—ã ({attachments.length})</Typography>
                {attachments.length === 0 ? <Alert severity="info">–ù–µ—Ç —Ñ–∞–π–ª–æ–≤.</Alert> : (
                    <List sx={{ bgcolor: '#fff', border: '1px solid #e0e0e0', borderRadius: 2 }}>
                        {attachments.map((att) => (
                            <ListItem key={att.id} divider secondaryAction={<IconButton edge="end" color="error" onClick={() => handleDelete(att.id)}><Delete /></IconButton>}>
                                <ListItemIcon><InsertDriveFile color="primary" /></ListItemIcon>
                                <ListItemText primary={att.description || "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"} secondary={`${att.doc_type} ‚Ä¢ ${new Date(att.uploaded_at).toLocaleDateString()}`} />
                                <Button size="small" href={att.file} target="_blank" sx={{ mr: 1 }}>–°–∫–∞—á–∞—Ç—å</Button>
                            </ListItem>
                        ))}
                    </List>
                )}
            </Grid>
        </Grid>
    );
};

// === –ì–õ–ê–í–ù–´–ô –ö–û–ú–ü–û–ù–ï–ù–¢ ===
const ElementPage = () => {
    const { id } = useParams();
    const isCreateMode = !id || id === 'new';
    const navigate = useNavigate();
    const queryClient = useQueryClient();

    const [tabValue, setTabValue] = useState(0);
    const [msg, setMsg] = useState<{type: 'success'|'error', text: string} | null>(null);

    const { data, isLoading } = useQuery({
        queryKey: ['element', id],
        queryFn: () => getElementById(id!),
        enabled: !!id && !isCreateMode,
        staleTime: 0
    });

    const mutation = useMutation({
        mutationFn: (values: any) => isCreateMode ? createElement(values) : updateElement(id!, values),
        onSuccess: (newData) => {
            setMsg({ type: 'success', text: '–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã' });
            queryClient.invalidateQueries({ queryKey: ['my-elements'] });
            if (isCreateMode) navigate(`/dashboard/elements/${newData.id}`, { replace: true });
            else queryClient.invalidateQueries({ queryKey: ['element', id] });
        },
        // === –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö ===
        onError: (err: any) => {
            console.error("Error:", err);
            // –ï—Å–ª–∏ –ø—Ä–∏—à–ª–∏ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª–µ–π (–æ–±—ä–µ–∫—Ç)
            if (err.response?.data && typeof err.response.data === 'object' && !Array.isArray(err.response.data)) {
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ–ª—è –∫—Ä–∞—Å–Ω—ã–º –≤ Formik
                formik.setErrors(err.response.data);

                // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                const errList = Object.entries(err.response.data)
                    .map(([k, v]) => `${k}: ${Array.isArray(v) ? v.join(', ') : v}`)
                    .join('\n');

                setMsg({ type: 'error', text: `–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –≤–≤–æ–¥–∞:\n${errList}` });
            } else {
                setMsg({ type: 'error', text: err.response?.data?.detail || "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" });
            }
        }
    });

    const formik = useFormik({
        initialValues: data || INITIAL_VALUES,
        enableReinitialize: true,
        validationSchema: VALIDATION_SCHEMA,
        onSubmit: (values) => {
            // === –í–ê–ñ–ù–û: –û–ß–ò–°–¢–ö–ê –î–ê–ù–ù–´–• ===
            // –ö–ª–æ–Ω–∏—Ä—É–µ–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å —Å—Ç–µ–π—Ç —Ñ–æ—Ä–º—ã –Ω–∞–ø—Ä—è–º—É—é
            const payload = JSON.parse(JSON.stringify(values));

            // –ï—Å–ª–∏ CAS –ø—É—Å—Ç–æ–π, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º null (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ unique)
            if (!payload.cas_number || payload.cas_number.trim() === '') {
                payload.cas_number = null;
            }
            mutation.mutate(payload);
        },
    });

    const handleStructureUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
        if (e.target.files && e.target.files[0] && id) {
            try {
                await uploadStructureImage(id, e.target.files[0]);
                queryClient.invalidateQueries({ queryKey: ['element', id] });
                setMsg({ type: 'success', text: '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞' });
            } catch (err) {
                setMsg({ type: 'error', text: '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è' });
            }
        }
    };

    if (isLoading) return <LinearProgress />;


    return (
        <form onSubmit={formik.handleSubmit}>
            <Snackbar open={!!msg} autoHideDuration={6000} onClose={() => setMsg(null)} anchorOrigin={{ vertical: 'top', horizontal: 'center' }}>
                <Alert severity={msg?.type} onClose={() => setMsg(null)} sx={{ width: '100%', whiteSpace: 'pre-line' }}>{msg?.text}</Alert>
            </Snackbar>

            <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 3 }}>
                <Box sx={{ display: 'flex', gap: 2, alignItems: 'center' }}>
                    <Button startIcon={<ArrowBack />} onClick={() => navigate('/dashboard/elements')} color="inherit">–ù–∞–∑–∞–¥</Button>
                    <Typography variant="h5" fontWeight="800" color="#1e293b">{isCreateMode ? "–°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞" : formik.values.primary_name_ru}</Typography>
                </Box>
                <Box sx={{ display: 'flex', gap: 2 }}>
                    {!isCreateMode && <Button variant="outlined" startIcon={<PictureAsPdf />} onClick={() => downloadPassport(id!)}>–ü–∞—Å–ø–æ—Ä—Ç</Button>}
                    <Button variant="contained" color="success" startIcon={<Save />} type="submit" disabled={mutation.isPending}>{isCreateMode ? "–°–æ–∑–¥–∞—Ç—å" : "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"}</Button>
                </Box>
            </Box>

            <Paper elevation={0} sx={{ width: '100%', borderRadius: 3, border: '1px solid #e2e8f0', overflow: 'hidden' }}>
                <Tabs value={tabValue} onChange={(_, v) => setTabValue(v)} variant="scrollable" scrollButtons="auto" sx={{ borderBottom: 1, borderColor: 'divider', bgcolor: '#f8fafc', '& .MuiTab-root': { fontWeight: 600 } }}>
                    <Tab label="1. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è" />
                    <Tab label="2. –§–∏–∑–∏–∫–∞" />
                    <Tab label="3. –¢–æ–∫—Å–∏–∫–æ–ª–æ–≥–∏—è" />
                    <Tab label="4. –≠–∫–æ–ª–æ–≥–∏—è –∏ –ü–æ—á–≤–∞" />
                    <Tab label="5. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è" />
                    <Tab label="6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" />
                    <Tab label="7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" />
                    <Tab label="8. –î–æ–∫—É–º–µ–Ω—Ç—ã" />
                </Tabs>

                <Box sx={{ px: 3, bgcolor: '#fff', minHeight: 500 }}>
                    {/* 1. –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø */}
                    <TabPanel value={tabValue} index={0}>
                        <FormSection title="–û—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è">
                            <Field md={8}>
                                <TextField fullWidth required label="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)" name="primary_name_ru"
                                           value={formik.values.primary_name_ru} onChange={formik.handleChange}
                                           error={formik.touched.primary_name_ru && Boolean(formik.errors.primary_name_ru)}
                                           helperText={formik.touched.primary_name_ru && formik.errors.primary_name_ru}
                                />
                            </Field>
                            <Field md={4}>
                                <TextField fullWidth label="CAS –ù–æ–º–µ—Ä" name="cas_number"
                                           value={formik.values.cas_number || ''} onChange={formik.handleChange}
                                           error={Boolean(formik.errors.cas_number)}
                                           helperText={formik.errors.cas_number}
                                           placeholder="00-00-0"
                                />
                            </Field>
                            <Field xs={12}><TextField fullWidth multiline label="–°–∏–Ω–æ–Ω–∏–º—ã" name="sec1_identification.synonyms" value={formik.values.sec1_identification?.synonyms || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                        <FormSection title="–ö–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã">
                            <Field><TextField fullWidth label="–•–∏–º. –§–æ—Ä–º—É–ª–∞" name="sec1_identification.molecular_formula" value={formik.values.sec1_identification?.molecular_formula || ''} onChange={formik.handleChange} /></Field>
                            <Field><TextField fullWidth label="EC –ù–æ–º–µ—Ä" name="sec1_identification.ec_number" value={formik.values.sec1_identification?.ec_number || ''} onChange={formik.handleChange} /></Field>
                            <Field><TextField fullWidth label="–ö–æ–¥ –¢–ù –í–≠–î" name="sec1_identification.tnved_code" value={formik.values.sec1_identification?.tnved_code || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                        {/* –°–ï–ö–¶–ò–Ø –°–¢–†–£–ö–¢–£–†–´ */}
                        <FormSection title="–•–∏–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞">
                            <Grid item xs={12} display="flex" gap={4} alignItems="flex-start">
                                {/* –ü—Ä–µ–≤—å—é */}
                                <Box
                                    sx={{
                                        width: 200, height: 200,
                                        border: '2px dashed #e0e0e0', borderRadius: 2,
                                        display: 'flex', alignItems: 'center', justifyContent: 'center',
                                        overflow: 'hidden', bgcolor: '#fafafa', position: 'relative'
                                    }}
                                >
                                    {data?.sec1_identification?.structure_image ? (
                                        <img
                                            src={data.sec1_identification.structure_image}
                                            alt="Structure"
                                            style={{ width: '100%', height: '100%', objectFit: 'contain' }}
                                        />
                                    ) : (
                                        <Typography variant="caption" color="text.disabled">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</Typography>
                                    )}
                                </Box>

                                {/* –ö–Ω–æ–ø–∫–∞ */}
                                <Box>
                                    <Typography variant="body2" paragraph>
                                        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã (PNG, JPG).
                                    </Typography>
                                    {!isCreateMode ? (
                                        <Button variant="outlined" component="label" startIcon={<CloudUpload />}>
                                            –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
                                            <input type="file" hidden accept="image/*" onChange={handleStructureUpload} />
                                        </Button>
                                    ) : (
                                        <Alert severity="info" sx={{ py: 0 }}>–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É</Alert>
                                    )}
                                </Box>
                            </Grid>
                        </FormSection>
                    </TabPanel>

                    {/* 2. –§–ò–ó–ò–ö–ê */}
                    <TabPanel value={tabValue} index={1}>
                        <FormSection title="–°–≤–æ–π—Å—Ç–≤–∞">
                            <Field>
                                <TextField select fullWidth label="–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ" name="sec2_physical.appearance" value={formik.values.sec2_physical?.appearance || ''} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.appearance.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field>
                                <TextField select fullWidth label="–ó–∞–ø–∞—Ö" name="sec2_physical.odor" value={formik.values.sec2_physical?.odor || 'OTHER'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.odor.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field><TextField fullWidth label="–¶–≤–µ—Ç" name="sec2_physical.color" value={formik.values.sec2_physical?.color || ''} onChange={formik.handleChange} /></Field>
                            <Field md={3}><TextField fullWidth label="–¢. –ø–ª–∞–≤–ª–µ–Ω–∏—è" name="sec2_physical.melting_point" value={formik.values.sec2_physical?.melting_point || ''} onChange={formik.handleChange} /></Field>
                            <Field md={3}><TextField fullWidth label="–¢. –∫–∏–ø–µ–Ω–∏—è" name="sec2_physical.boiling_point" value={formik.values.sec2_physical?.boiling_point || ''} onChange={formik.handleChange} /></Field>
                            <Field md={3}><TextField fullWidth label="–ü–ª–æ—Ç–Ω–æ—Å—Ç—å" name="sec2_physical.density" value={formik.values.sec2_physical?.density || ''} onChange={formik.handleChange} /></Field>
                            <Field md={3}><TextField fullWidth label="pH" name="sec2_physical.ph" value={formik.values.sec2_physical?.ph || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                    </TabPanel>

                    {/* 3. –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø */}
                    <TabPanel value={tabValue} index={2}>
                        <FormSection title="–ü–∞—Ä–∞–º–µ—Ç—Ä—ã">
                            <Field>
                                <TextField select fullWidth label="–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ" name="sec3_sanpin.state_in_air" value={formik.values.sec3_sanpin?.state_in_air || ''} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.state_in_air.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field><TextField fullWidth label="–ü–î–ö –†–∞–±.–∑–æ–Ω—ã" name="sec3_sanpin.pdk_workzone" value={formik.values.sec3_sanpin?.pdk_workzone || ''} onChange={formik.handleChange} /></Field>
                            <Field><TextField fullWidth label="–ö–í–ò–û" name="sec3_sanpin.kvio" value={formik.values.sec3_sanpin?.kvio || ''} onChange={formik.handleChange} /></Field>
                            <Field>
                                <TextField select fullWidth label="–õ–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫" name="sec4_air.limit_sign" value={formik.values.sec4_air?.limit_sign || ''} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.limit_sign.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                        </FormSection>
                        <FormSection title="–≠—Ñ—Ñ–µ–∫—Ç—ã –æ—Å—Ç—Ä–æ–π —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏">
                            <Field>
                                <TextField select fullWidth label="–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω–æ (–í–¥—ã—Ö–∞–Ω–∏–µ)" name="sec5_acute.inhalation_lc50_effect" value={formik.values.sec5_acute?.inhalation_lc50_effect || 'UNKNOWN'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.yes_no_unknown.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field>
                                <TextField select fullWidth label="–î–µ—Ä–º–∞–ª—å–Ω–æ (–ö–æ–∂–∞)" name="sec5_acute.dermal_ld50_effect" value={formik.values.sec5_acute?.dermal_ld50_effect || 'UNKNOWN'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.yes_no_unknown.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field>
                                <TextField select fullWidth label="–ü–µ—Ä–æ—Ä–∞–ª—å–Ω–æ (–†–æ—Ç)" name="sec5_acute.oral_ld50_effect" value={formik.values.sec5_acute?.oral_ld50_effect || 'UNKNOWN'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.yes_no_unknown.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                        </FormSection>
                        <FormSection title="–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–°–ì–°)">
                            <Field><TextField select fullWidth label="–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å" name="sec6_risks.carcinogenicity" value={formik.values.sec6_risks?.carcinogenicity || 'NC'} onChange={formik.handleChange}>{FORM_OPTIONS.ghs_category.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}</TextField></Field>
                            <Field><TextField select fullWidth label="–ú—É—Ç–∞–≥–µ–Ω–Ω–æ—Å—Ç—å" name="sec6_risks.mutagenicity" value={formik.values.sec6_risks?.mutagenicity || 'NC'} onChange={formik.handleChange}>{FORM_OPTIONS.ghs_category.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}</TextField></Field>
                            <Field><TextField select fullWidth label="–†–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫—Å." name="sec6_risks.repro_tox" value={formik.values.sec6_risks?.repro_tox || 'NC'} onChange={formik.handleChange}>{FORM_OPTIONS.ghs_category.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}</TextField></Field>
                        </FormSection>
                    </TabPanel>

                    {/* 4. –≠–ö–û–õ–û–ì–ò–Ø –ò –ü–û–ß–í–ê */}
                    <TabPanel value={tabValue} index={3}>
                        <FormSection title="–≠–∫–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å">
                            <Field><TextField fullWidth label="LD50 –†—ã–±—ã" name="sec8_ecotox.ld50_fish" value={formik.values.sec8_ecotox?.ld50_fish || ''} onChange={formik.handleChange} /></Field>
                            <Field>
                                <FormControlLabel control={<Switch checked={formik.values.sec8_ecotox?.bioaccumulation || false} onChange={formik.handleChange} name="sec8_ecotox.bioaccumulation" />} label="–ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è" />
                                <FormControlLabel control={<Switch checked={formik.values.sec8_ecotox?.phytotoxicity || false} onChange={formik.handleChange} name="sec8_ecotox.phytotoxicity" />} label="–§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å" />
                            </Field>
                        </FormSection>
                        <FormSection title="–ü–æ—á–≤–∞">
                            <Field>
                                <TextField select fullWidth label="–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å" name="sec9_soil.persistence" value={formik.values.sec9_soil?.persistence || ''} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.persistence.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field>
                                <TextField select fullWidth label="–ú–∏–≥—Ä–∞—Ü–∏—è" name="sec9_soil.migration" value={formik.values.sec9_soil?.migration || ''} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.migration.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field>
                                <TextField select fullWidth label="–°–æ—Ä–±—Ü–∏—è" name="sec9_soil.sorption" value={formik.values.sec9_soil?.sorption || ''} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.sorption.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                        </FormSection>
                    </TabPanel>

                    {/* 5. –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø */}
                    <TabPanel value={tabValue} index={4}>
                        <FormSection title="–ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏">
                            <Field>
                                <TextField select fullWidth label="–ö–ª–∞—Å—Å (–°–∞–Ω–ü–∏–ù)" name="sec11_class.sanpin_class" value={formik.values.sec11_class?.sanpin_class || 'NC'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.sanpin_class.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field>
                                <TextField select fullWidth label="–ì–û–°–¢ 12.1.007" name="sec11_class.gost_body_class" value={formik.values.sec11_class?.gost_body_class || 'NC'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.sanpin_class.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                        </FormSection>
                        <FormSection title="–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –°–ì–°">
                            <Field md={3}>
                                <TextField select fullWidth label="–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ" name="sec13_label.signal_word" value={formik.values.sec13_label?.signal_word || 'NONE'} onChange={formik.handleChange}>
                                    {FORM_OPTIONS.signal_word.map(o => <MenuItem key={o.value} value={o.value}>{o.label}</MenuItem>)}
                                </TextField>
                            </Field>
                            <Field md={9}><TextField fullWidth label="–ü–∏–∫—Ç–æ–≥—Ä–∞–º–º—ã (–∫–æ–¥—ã)" name="sec13_label.pictogram_code" value={formik.values.sec13_label?.pictogram_code || ''} onChange={formik.handleChange} /></Field>
                            <Field xs={12}><TextField fullWidth multiline rows={2} label="H-—Ñ—Ä–∞–∑—ã (–û–ø–∞—Å–Ω–æ—Å—Ç–∏)" name="sec13_label.h_phrases" value={formik.values.sec13_label?.h_phrases || ''} onChange={formik.handleChange} /></Field>
                            <Field xs={12}><TextField fullWidth multiline rows={2} label="P-—Ñ—Ä–∞–∑—ã (–ú–µ—Ä—ã)" name="sec13_label.p_phrases" value={formik.values.sec13_label?.p_phrases || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                    </TabPanel>

                    {/* 6. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ */}
                    <TabPanel value={tabValue} index={5}>
                        <FormSection title="–ú–µ—Ä—ã –ø–æ–º–æ—â–∏">
                            <Field xs={12}><TextField fullWidth multiline rows={3} label="–ü–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å" name="sec14_safety.first_aid" value={formik.values.sec14_safety?.first_aid || ''} onChange={formik.handleChange} /></Field>
                            <Field xs={12}><TextField fullWidth multiline rows={3} label="–°–ò–ó (–ó–∞—â–∏—Ç–∞)" name="sec14_safety.prevent_health" value={formik.values.sec14_safety?.prevent_health || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                        <FormSection title="–•—Ä–∞–Ω–µ–Ω–∏–µ">
                            <Field><TextField fullWidth label="–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è" name="sec15_storage.storage_reqs" value={formik.values.sec15_storage?.storage_reqs || ''} onChange={formik.handleChange} /></Field>
                            <Field><TextField fullWidth label="–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å" name="sec15_storage.incompatible" value={formik.values.sec15_storage?.incompatible || ''} onChange={formik.handleChange} /></Field>
                            <Field><TextField fullWidth label="–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è" name="sec16_waste.disposal" value={formik.values.sec16_waste?.disposal || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                    </TabPanel>

                    {/* 7. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û */}
                    <TabPanel value={tabValue} index={6}>
                        <FormSection title="–ö–æ–Ω–≤–µ–Ω—Ü–∏–∏">
                            <Grid item xs={12}>
                                <FormControlLabel control={<Switch checked={formik.values.sec18_intl?.ozone_destroying || false} onChange={formik.handleChange} name="sec18_intl.ozone_destroying" />} label="–ú–æ–Ω—Ä–µ–∞–ª—å (–û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–∏–µ)" />
                                <FormControlLabel control={<Switch checked={formik.values.sec18_intl?.pops || false} onChange={formik.handleChange} name="sec18_intl.pops" />} label="–°—Ç–æ–∫–≥–æ–ª—å–º (–°–û–ó)" />
                                <FormControlLabel control={<Switch checked={formik.values.sec18_intl?.pic || false} onChange={formik.handleChange} name="sec18_intl.pic" />} label="–†–æ—Ç—Ç–µ—Ä–¥–∞–º" />
                                <FormControlLabel control={<Switch checked={formik.values.sec18_intl?.mercury || false} onChange={formik.handleChange} name="sec18_intl.mercury" />} label="–ú–∏–Ω–∞–º–∞—Ç–∞ (–†—Ç—É—Ç—å)" />
                            </Grid>
                        </FormSection>
                        <FormSection title="–ò–Ω—Ñ–æ">
                            <Field><TextField fullWidth label="–û–±—ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞" name="sec22_volumes.vol_production" value={formik.values.sec22_volumes?.vol_production || ''} onChange={formik.handleChange} /></Field>
                            <Field xs={12}><TextField fullWidth multiline label="–£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ü–µ–ø–∏ –ø–æ—Å—Ç–∞–≤–æ–∫" name="sec21_companies.info" value={formik.values.sec21_companies?.info || ''} onChange={formik.handleChange} /></Field>
                        </FormSection>
                    </TabPanel>

                    {/* 8. –î–û–ö–£–ú–ï–ù–¢–´ */}
                    <TabPanel value={tabValue} index={7}>
                        {isCreateMode ? <Alert severity="info" variant="outlined">–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π —Ñ–∞–π–ª–æ–≤.</Alert> : <FilesTab elementId={id!} attachments={data?.attachments || []} onUpdate={() => queryClient.invalidateQueries({ queryKey: ['element', id] })} />}
                    </TabPanel>

                </Box>
            </Paper>
        </form>
    );
};

export default ElementPage;

==================================================
FILE: .\frontend\src\pages\Dashboard\ImportPage.tsx
==================================================
import { useState, useRef, useEffect } from 'react';
import {
    Paper, Typography, Box, Button, LinearProgress, Alert,
    List, ListItem, ListItemIcon, ListItemText, Divider
} from '@mui/material';
import {
    CloudUpload, Download, InsertDriveFile, CheckCircle, Error as ErrorIcon
} from '@mui/icons-material';
import { downloadTemplate, uploadFile, checkTask, type TaskResponse } from '../../api/registry';
import { useSnackbar } from 'notistack';

const ImportPage = () => {
    const { enqueueSnackbar } = useSnackbar();

    // –°–æ—Å—Ç–æ—è–Ω–∏—è
    const [selectedFile, setSelectedFile] = useState<File | null>(null);
    const [uploading, setUploading] = useState(false);
    const [taskId, setTaskId] = useState<string | null>(null);
    const [taskData, setTaskData] = useState<TaskResponse | null>(null);

    const fileInputRef = useRef<HTMLInputElement>(null);

    // === 1. –õ–æ–≥–∏–∫–∞ –ø–æ–ª–ª–∏–Ω–≥–∞ (–æ–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞) ===
    useEffect(() => {
        let intervalId: any;

        if (taskId && uploading) {
            intervalId = setInterval(async () => {
                try {
                    const data = await checkTask(taskId);
                    setTaskData(data);

                    // –ï—Å–ª–∏ –≥–æ—Ç–æ–≤–æ - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
                    if (['SUCCESS', 'DONE', 'FAILURE', 'ERROR'].includes(data.status)) {
                        setUploading(false);
                        if (data.result?.errors && data.result.errors.length === 0) {
                            enqueueSnackbar('–ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!', { variant: 'success' });
                        } else {
                            enqueueSnackbar('–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —Å –∑–∞–º–µ—á–∞–Ω–∏—è–º–∏', { variant: 'warning' });
                        }
                    }
                } catch (e) {
                    console.error(e);
                    setUploading(false);
                    enqueueSnackbar('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞', { variant: 'error' });
                }
            }, 2000); // –°–ø—Ä–∞—à–∏–≤–∞–µ–º –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
        }

        return () => clearInterval(intervalId); // –ß–∏—Å—Ç–∏–º –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
    }, [taskId, uploading]);

    // === 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ ===
    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        if (e.target.files && e.target.files.length > 0) {
            setSelectedFile(e.target.files[0]);
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            setTaskId(null);
            setTaskData(null);
        }
    };

    const handleStartUpload = async () => {
        if (!selectedFile) return;
        setUploading(true);
        try {
            const res = await uploadFile(selectedFile);
            setTaskId(res.task_id);
        } catch (e) {
            setUploading(false);
            enqueueSnackbar('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞', { variant: 'error' });
        }
    };

    return (
        <Box maxWidth="800px" mx="auto">
            <Typography variant="h5" sx={{ mb: 3, fontWeight: 'bold' }}>
                –ú–∞—Å—Ç–µ—Ä –ò–º–ø–æ—Ä—Ç–∞ –î–∞–Ω–Ω—ã—Ö
            </Typography>

            {/* –®–ê–ì 1: –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ò –®–ê–ë–õ–û–ù */}
            <Paper sx={{ p: 3, mb: 3 }}>
                <Typography variant="h6" gutterBottom>1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞</Typography>
                <Typography variant="body2" color="text.secondary" paragraph>
                    –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω Excel. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –∫–æ–ª–æ–Ω–∫–∏ —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π (*) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∫ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é.
                    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ –≤ —è—á–µ–π–∫–∞—Ö –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ö–ª–∞—Å—Å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏).
                </Typography>
                <Button
                    variant="outlined"
                    startIcon={<Download />}
                    onClick={downloadTemplate}
                >
                    –°–∫–∞—á–∞—Ç—å –®–∞–±–ª–æ–Ω.xlsx
                </Button>
            </Paper>

            {/* –®–ê–ì 2: –ó–ê–ì–†–£–ó–ö–ê */}
            <Paper sx={{ p: 3, mb: 3 }}>
                <Typography variant="h6" gutterBottom>2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</Typography>

                <Box
                    sx={{
                        border: '2px dashed #ccc',
                        borderRadius: 2,
                        p: 4,
                        textAlign: 'center',
                        bgcolor: '#fafafa',
                        cursor: 'pointer',
                        '&:hover': { bgcolor: '#f0f0f0', borderColor: 'primary.main' }
                    }}
                    onClick={() => fileInputRef.current?.click()}
                >
                    <input
                        type="file"
                        accept=".xlsx"
                        hidden
                        ref={fileInputRef}
                        onChange={handleFileChange}
                    />

                    {selectedFile ? (
                        <Box sx={{ display:'flex', alignItems:'center', justifyContent:'center', gap:1 }}>
                            <InsertDriveFile color="primary" sx={{ fontSize: 40 }} />
                            <Typography variant="h6">{selectedFile.name}</Typography>
                        </Box>
                    ) : (
                        <>
                            <CloudUpload color="action" sx={{ fontSize: 48, mb: 1 }} />
                            <Typography>–ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</Typography>
                            <Typography variant="caption" color="text.secondary">–¢–æ–ª—å–∫–æ .xlsx —Ñ–∞–π–ª—ã</Typography>
                        </>
                    )}
                </Box>

                <Box sx={{ mt: 3, display:'flex', justifyContent:'flex-end' }}>
                    <Button
                        variant="contained"
                        size="large"
                        disabled={!selectedFile || uploading}
                        onClick={handleStartUpload}
                        startIcon={uploading && <CircularProgress size={20} color="inherit"/>}
                    >
                        {uploading ? '–û–±—Ä–∞–±–æ—Ç–∫–∞...' : '–ù–∞—á–∞—Ç—å –ò–º–ø–æ—Ä—Ç'}
                    </Button>
                </Box>

                {/* –ü–†–û–ì–†–ï–°–° –ë–ê–† */}
                {uploading && (
                    <Box sx={{ mt: 3 }}>
                        <Typography variant="body2" gutterBottom>–°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª...</Typography>
                        <LinearProgress variant="indeterminate" />
                    </Box>
                )}
            </Paper>

            {/* –®–ê–ì 3: –†–ï–ó–£–õ–¨–¢–ê–¢–´ */}
            {taskData && ['DONE', 'SUCCESS', 'FINISHED'].includes(taskData.status) && taskData.result && (
                <Paper sx={{ p: 3, borderLeft: '6px solid', borderColor: (taskData.result.imported || 0) > 0 ? 'success.main' : 'warning.main' }}>
                    <Box sx={{ display:'flex', alignItems:'center', gap: 2, mb: 2 }}>
                        {(taskData.result.imported || 0) > 0
                            ? <CheckCircle color="success" sx={{ fontSize: 40 }} />
                            : <ErrorIcon color="warning" sx={{ fontSize: 40 }} />
                        }
                        <Box>
                            <Typography variant="h6">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</Typography>
                            <Typography variant="body2">
                                –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ: <b>{taskData.result.imported ?? 0}</b> —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
                            </Typography>
                        </Box>
                    </Box>

                    {/* –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ */}
                    {taskData.result.errors && taskData.result.errors.length > 0 ? (
                        <Box sx={{ mt: 2, bgcolor: '#fff5f5', p: 2, borderRadius: 2 }}>
                            <Typography variant="subtitle2" color="error" gutterBottom sx={{ fontWeight: 'bold' }}>
                                –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∑–∞–º–µ—á–∞–Ω–∏—è ({taskData.result.errors.length}):
                            </Typography>
                            <List dense disablePadding>
                                {taskData.result.errors.map((err, idx) => (
                                    <ListItem key={idx} disablePadding sx={{ alignItems: 'flex-start', py: 0.5 }}>
                                        <ListItemIcon sx={{ minWidth: 30, mt: 0.5 }}><ErrorIcon fontSize="small" color="error"/></ListItemIcon>
                                        <ListItemText
                                            primary={err}
                                            primaryTypographyProps={{ fontSize: 13, color: 'text.primary', style: { wordBreak: 'break-word' } }}
                                        />
                                    </ListItem>
                                ))}
                            </List>
                        </Box>
                    ) : null}
                </Paper>
            )}
        </Box>
    );
};
import { CircularProgress } from '@mui/material'; // –ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–æ-–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ

export default ImportPage;

==================================================
FILE: .\frontend\src\pages\Dashboard\OrganizationPage.tsx
==================================================
import { useEffect, useState } from 'react';
import { useFormik } from 'formik';
import * as Yup from 'yup';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import {
    Box, Typography, Paper, Grid, TextField, Button, LinearProgress, Divider,
    Avatar, IconButton, Badge
} from '@mui/material';
import { Save, Business, PhotoCamera } from '@mui/icons-material';
import { useSnackbar } from 'notistack';
import { getProfile, updateProfile } from '../../api/auth';

const OrganizationPage = () => {
    const { enqueueSnackbar } = useSnackbar();
    const queryClient = useQueryClient();

    // –•—Ä–∞–Ω–∏–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –¥–ª—è –ø—Ä–µ–≤—å—é
    const [logoFile, setLogoFile] = useState<File | null>(null);
    const [previewUrl, setPreviewUrl] = useState<string | null>(null);

    // 1. –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ü–†–û–§–ò–õ–Ø
    const { data, isLoading } = useQuery({
        queryKey: ['profile'],
        queryFn: getProfile,
    });

    // 2. –°–û–•–†–ê–ù–ï–ù–ò–ï (–ú–£–¢–ê–¶–ò–Ø)
    const mutation = useMutation({
        mutationFn: updateProfile,
        onSuccess: () => {
            enqueueSnackbar('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', { variant: 'success' });
            queryClient.invalidateQueries({ queryKey: ['profile'] }); // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ö–µ–¥–µ—Ä–µ
            setLogoFile(null); // –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∞–π–ª –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
        },
        onError: (err: any) => {
            console.error(err);
            enqueueSnackbar('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö', { variant: 'error' });
        }
    });

    const formik = useFormik({
        initialValues: {
            email: '',
            company: {
                company_name: '',
                inn: '',
                address: '',
                phone: '',
                website: '',
                // logo –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫–æ–π (URL) —Å –±—ç–∫–∞, –Ω–æ –º—ã –µ–≥–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ —Ç–µ–∫—Å—Ç–æ–º
            }
        },
        enableReinitialize: true,
        validationSchema: Yup.object({
            company: Yup.object({
                company_name: Yup.string().required('–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'),
                inn: Yup.string().required('–ò–ù–ù –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω'),
                phone: Yup.string().required('–¢–µ–ª–µ—Ñ–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω'),
            })
        }),
        onSubmit: (values) => {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º FormData –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ + —Ç–µ–∫—Å—Ç–∞
            const formData = new FormData();

            // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è —é–∑–µ—Ä–∞
            formData.append('email', values.email);

            // –í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∫–æ–º–ø–∞–Ω–∏–∏
            // DRF —Å WritableNestedSerializer —É–º–µ–µ—Ç –ø–æ–Ω–∏–º–∞—Ç—å —Ç–æ—á–∫–∏: 'company.field_name'
            formData.append('company.company_name', values.company.company_name);
            formData.append('company.inn', values.company.inn);
            formData.append('company.address', values.company.address || '');
            formData.append('company.phone', values.company.phone || '');
            formData.append('company.website', values.company.website || '');

            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–ª–∏ –Ω–æ–≤—ã–π –ª–æ–≥–æ—Ç–∏–ø - –¥–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª
            if (logoFile) {
                formData.append('company.logo', logoFile);
            }

            mutation.mutate(formData);
        }
    });

    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
    useEffect(() => {
        if (data) {
            formik.setValues({
                email: data.email,
                company: data.company || {}
            });
            // –ï—Å–ª–∏ –µ—Å—Ç—å –ª–æ–≥–æ—Ç–∏–ø —Å —Å–µ—Ä–≤–µ—Ä–∞, —Å—Ç–∞–≤–∏–º –µ–≥–æ –∫–∞–∫ –ø—Ä–µ–≤—å—é (–µ—Å–ª–∏ –º—ã –µ—â–µ –Ω–µ –≤—ã–±—Ä–∞–ª–∏ –Ω–æ–≤—ã–π)
            if (data.company?.logo && !logoFile) {
                setPreviewUrl(data.company.logo);
            }
        }
    }, [data]);

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
    const handleLogoChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        if (e.target.files && e.target.files[0]) {
            const file = e.target.files[0];
            setLogoFile(file);
            setPreviewUrl(URL.createObjectURL(file)); // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è –ø–æ–∫–∞–∑–∞
        }
    };

    if (isLoading) return <LinearProgress />;

    return (
        <Box maxWidth="md" sx={{ mx: "auto" }}>
            <Typography variant="h5" fontWeight="bold" sx={{ mb: 3, display:'flex', alignItems:'center', gap:1 }}>
                <Business /> –ö–∞—Ä—Ç–æ—á–∫–∞ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
            </Typography>

            <form onSubmit={formik.handleSubmit}>
                <Paper sx={{ p: 4, borderRadius: 3, border: '1px solid #e0e0e0' }} elevation={0}>

                    {/* –°–ï–ö–¶–ò–Ø –õ–û–ì–û–¢–ò–ü–ê */}
                    <Box display="flex" flexDirection="column" alignItems="center" mb={4}>
                        <Badge
                            overlap="circular"
                            anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}
                            badgeContent={
                                <IconButton
                                    color="primary"
                                    component="label"
                                    sx={{
                                        bgcolor: 'white',
                                        boxShadow: 2,
                                        width: 32, height: 32,
                                        '&:hover': { bgcolor: '#f5f5f5' }
                                    }}
                                >
                                    <input hidden accept="image/*" type="file" onChange={handleLogoChange} />
                                    <PhotoCamera sx={{ fontSize: 20 }} />
                                </IconButton>
                            }
                        >
                            <Avatar
                                src={previewUrl || undefined}
                                sx={{
                                    width: 100, height: 100,
                                    bgcolor: '#e3f2fd', color: '#1976d2',
                                    fontSize: 40, fontWeight: 'bold',
                                    border: '1px solid #e0e0e0'
                                }}
                            >
                                {/* –ï—Å–ª–∏ –Ω–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –±—É–∫–≤—É –Ω–∞–∑–≤–∞–Ω–∏—è */}
                                {!previewUrl && formik.values.company.company_name?.[0]?.toUpperCase()}
                            </Avatar>
                        </Badge>
                        <Typography variant="caption" color="text.secondary" mt={1}>
                            –õ–æ–≥–æ—Ç–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
                        </Typography>
                    </Box>

                    <Divider sx={{ mb: 3 }} />

                    <Grid container spacing={3}>
                        <Grid item xs={12} md={8}>
                            <TextField
                                fullWidth
                                label="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏"
                                name="company.company_name"
                                value={formik.values.company.company_name}
                                onChange={formik.handleChange}
                                error={Boolean(formik.errors.company?.company_name)}
                                helperText={formik.errors.company?.company_name}
                            />
                        </Grid>
                        <Grid item xs={12} md={4}>
                            <TextField
                                fullWidth
                                label="–ò–ù–ù (STIR)"
                                name="company.inn"
                                value={formik.values.company.inn}
                                onChange={formik.handleChange}
                                error={Boolean(formik.errors.company?.inn)}
                                helperText={formik.errors.company?.inn}
                            />
                        </Grid>

                        <Grid item xs={12}>
                            <TextField
                                fullWidth
                                label="–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –ê–¥—Ä–µ—Å"
                                name="company.address"
                                multiline
                                value={formik.values.company.address}
                                onChange={formik.handleChange}
                            />
                        </Grid>

                        <Grid item xs={12} md={6}>
                            <TextField
                                fullWidth
                                label="–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω"
                                name="company.phone"
                                value={formik.values.company.phone}
                                onChange={formik.handleChange}
                                error={Boolean(formik.errors.company?.phone)}
                                helperText={formik.errors.company?.phone}
                            />
                        </Grid>
                        <Grid item xs={12} md={6}>
                            <TextField
                                fullWidth
                                label="–í–µ–±-—Å–∞–π—Ç"
                                name="company.website"
                                placeholder="https://"
                                value={formik.values.company.website}
                                onChange={formik.handleChange}
                            />
                        </Grid>

                        <Grid item xs={12}>
                            <TextField
                                fullWidth
                                label="Email —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ (–õ–æ–≥–∏–Ω)"
                                disabled
                                value={formik.values.email}
                                helperText="–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É"
                                InputProps={{ readOnly: true, sx: { bgcolor: '#f8f9fa' } }}
                            />
                        </Grid>
                    </Grid>

                    <Box sx={{ mt: 4, display:'flex', justifyContent:'flex-end' }}>
                        <Button
                            type="submit"
                            variant="contained"
                            size="large"
                            startIcon={<Save />}
                            disabled={mutation.isPending}
                            sx={{ borderRadius: 2, px: 4 }}
                        >
                            {mutation.isPending ? "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..." : "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è"}
                        </Button>
                    </Box>

                </Paper>
            </form>
        </Box>
    );
};

export default OrganizationPage;

==================================================
FILE: .\frontend\src\pages\Dashboard\SubstancesList.tsx
==================================================
import { useQuery } from '@tanstack/react-query';
import { DataGrid, type GridColDef, type GridRenderCellParams } from '@mui/x-data-grid';
import {
    Paper, Typography, Box, Chip, Button, CircularProgress,
    Alert, IconButton, Tooltip, Stack, Divider
} from '@mui/material';
import {
    Add, Edit, CloudUpload, Science, Warning, CheckCircle,
    Cancel, Schedule, Drafts
} from '@mui/icons-material';
import { getMyElements } from '../../api/registry';
import { useNavigate } from 'react-router-dom';

const SubstancesList = () => {
    const navigate = useNavigate();

    // –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
    const { data, isLoading, error } = useQuery({
        queryKey: ['my-elements'],
        queryFn: getMyElements,
    });

    // --- –ö–û–õ–û–ù–ö–ò –¢–ê–ë–õ–ò–¶–´ ---
    const columns: GridColDef[] = [
        {
            field: 'id',
            headerName: 'ID',
            width: 70,
            headerAlign: 'center',
            align: 'center',
            renderCell: (params) => <Typography variant="caption" color="text.secondary">#{params.value}</Typography>
        },
        {
            field: 'primary_name_ru',
            headerName: '–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞',
            flex: 2, // –ë–µ—Ä–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞
            minWidth: 250,
            renderCell: (params: GridRenderCellParams) => (
                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1.5 }}>
                    <Box sx={{
                        p: 0.5, borderRadius: 1, bgcolor: '#e3f2fd', color: '#1976d2',
                        display: 'flex', alignItems: 'center', justifyContent: 'center'
                    }}>
                        <Science fontSize="small" />
                    </Box>
                    <Box>
                        <Typography variant="body2" fontWeight="600" lineHeight={1.2}>
                            {params.value}
                        </Typography>
                        {/* –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∏–Ω–æ–Ω–∏–º—ã –∏–ª–∏ –∞–Ω–≥–ª –Ω–∞–∑–≤–∞–Ω–∏–µ, –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Ç—É—Ç –º–µ–ª–∫–∏–º —à—Ä–∏—Ñ—Ç–æ–º */}
                    </Box>
                </Box>
            )
        },
        {
            field: 'cas_number',
            headerName: 'CAS –ù–æ–º–µ—Ä',
            width: 140,
            renderCell: (params) => (
                <Typography variant="body2" sx={{ fontFamily: 'monospace', fontWeight: 500, bgcolor: '#f8f9fa', px: 1, borderRadius: 1 }}>
                    {params.value || '‚Äî'}
                </Typography>
            )
        },
        // –ù–û–í–ê–Ø –ö–û–õ–û–ù–ö–ê
        {
            field: 'hazard_class',
            headerName: '–ö–ª–∞—Å—Å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            width: 160,
            renderCell: (params) => {
                if (!params.value || params.value === '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è') return <Typography variant="caption" color="text.disabled">‚Äî</Typography>;
                return (
                    <Chip
                        label={params.value}
                        size="small"
                        sx={{
                            height: 24,
                            fontSize: '0.75rem',
                            bgcolor: '#fff3e0', color: '#e65100', fontWeight: 600
                        }}
                    />
                );
            }
        },
        {
            field: 'updated_at',
            headerName: '–û–±–Ω–æ–≤–ª–µ–Ω–æ',
            width: 140,
            valueFormatter: (params) => params.value ? new Date(params.value).toLocaleDateString() : '‚Äî'
        },
        {
            field: 'status',
            headerName: '–°—Ç–∞—Ç—É—Å',
            width: 160,
            renderCell: (params: GridRenderCellParams) => {
                let color = "#e0e0e0";
                let bg = "#f5f5f5";
                let icon = <Drafts style={{fontSize: 16}} />;
                let label = "–ß–µ—Ä–Ω–æ–≤–∏–∫";

                switch (params.value) {
                    case 'DRAFT':
                        label="–ß–µ—Ä–Ω–æ–≤–∏–∫"; color="#64748b"; bg="#f1f5f9"; icon=<Drafts style={{fontSize: 14}}/>;
                        break;
                    case 'PENDING':
                        label="–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ"; color="#d97706"; bg="#fffbeb"; icon=<Schedule style={{fontSize: 14}}/>;
                        break;
                    case 'PUBLISHED':
                        label="–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ"; color="#059669"; bg="#ecfdf5"; icon=<CheckCircle style={{fontSize: 14}}/>;
                        break;
                    case 'REJECTED':
                        label="–û—Ç–∫–ª–æ–Ω–µ–Ω–æ"; color="#dc2626"; bg="#fef2f2"; icon=<Cancel style={{fontSize: 14}}/>;
                        break;
                }

                return (
                    <Chip
                        icon={icon}
                        label={label}
                        size="small"
                        sx={{
                            bgcolor: bg, color: color, fontWeight: 700, border: '1px solid', borderColor: 'transparent',
                            '& .MuiChip-icon': { color: 'inherit' }
                        }}
                    />
                );
            },
        },
        {
            field: 'actions',
            headerName: '',
            width: 60,
            align: 'right',
            sortable: false,
            renderCell: (params: GridRenderCellParams) => (
                <Tooltip title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                    <IconButton
                        size="small"
                        onClick={(e) => { e.stopPropagation(); navigate(`/dashboard/elements/${params.row.id}`); }}
                        sx={{ color: '#94a3b8', '&:hover': { color: '#2563eb', bgcolor: '#eff6ff' } }}
                    >
                        <Edit fontSize="small" />
                    </IconButton>
                </Tooltip>
            ),
        },
    ];

    if (isLoading) return <Box sx={{ display:'flex', justifyContent:'center', mt:10 }}><CircularProgress /></Box>;
    if (error) return <Alert severity="error">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤–µ—â–µ—Å—Ç–≤.</Alert>;

    return (
        <Box>
            {/* --- –ó–ê–ì–û–õ–û–í–û–ö –°–¢–†–ê–ù–ò–¶–´ --- */}
            <Paper
                elevation={0}
                sx={{
                    p: 3, mb: 3, borderRadius: 3,
                    border: '1px solid #e2e8f0',
                    display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: 2,
                    background: 'linear-gradient(to right, #ffffff, #f8fafc)'
                }}
            >
                <Box>
                    <Typography variant="h5" sx={{ fontWeight: 800, color: '#1e293b', mb: 0.5 }}>
                        –ú–æ–∏ –í–µ—â–µ—Å—Ç–≤–∞
                    </Typography>
                    <Typography variant="body2" color="text.secondary">
                        –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Å–ø–æ—Ä—Ç–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏
                    </Typography>
                </Box>

                <Stack direction="row" spacing={2}>
                    <Button
                        variant="contained"
                        color="success" // –ó–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
                        startIcon={<Add />}
                        onClick={() => navigate('/dashboard/elements/new')}
                        sx={{
                            borderRadius: 2, textTransform: 'none', fontWeight: 600,
                            px: 3, py: 1, boxShadow: '0 4px 12px rgba(34, 197, 94, 0.2)'
                        }}
                    >
                        –°–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é
                    </Button>

                    <Divider orientation="vertical" flexItem />

                    <Button
                        variant="outlined"
                        startIcon={<CloudUpload />}
                        onClick={() => navigate('/dashboard/import')}
                        sx={{
                            borderRadius: 2, textTransform: 'none', fontWeight: 600,
                            color: '#475569', borderColor: '#cbd5e1',
                            '&:hover': { borderColor: '#94a3b8', bgcolor: '#f8fafc' }
                        }}
                    >
                        –ò–º–ø–æ—Ä—Ç Excel
                    </Button>
                </Stack>
            </Paper>

            {/* --- –¢–ê–ë–õ–ò–¶–ê --- */}
            <Paper
                elevation={0}
                sx={{
                    border: '1px solid #e2e8f0',
                    borderRadius: 3,
                    overflow: 'hidden',
                    bgcolor: 'white',
                    boxShadow: '0 4px 20px rgba(0,0,0,0.03)' // –õ–µ–≥–∫–∞—è —Ç–µ–Ω—å
                }}
            >
                <DataGrid
                    rows={data?.results || []}
                    columns={columns}
                    initialState={{ pagination: { paginationModel: { pageSize: 10 } } }}
                    pageSizeOptions={[10, 20, 50]}
                    autoHeight
                    disableRowSelectionOnClick
                    rowHeight={60} // –ß—É—Ç—å –≤—ã—à–µ —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ–±—ã –±—ã–ª–æ –ø—Ä–æ—Å—Ç–æ—Ä–Ω–µ–µ
                    sx={{
                        border: 'none',
                        // –°—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
                        '& .MuiDataGrid-columnHeaders': {
                            bgcolor: '#f8fafc',
                            color: '#475569',
                            fontWeight: 700,
                            textTransform: 'uppercase',
                            fontSize: '0.75rem',
                            borderBottom: '1px solid #e2e8f0'
                        },
                        // –°—Ç–∏–ª–∏ —è—á–µ–µ–∫
                        '& .MuiDataGrid-cell': {
                            borderBottom: '1px solid #f1f5f9'
                        },
                        // –£–±–∏—Ä–∞–µ–º —Ñ–æ–∫—É—Å –ø—Ä–∏ –∫–ª–∏–∫–µ (—Å–∏–Ω—é—é —Ä–∞–º–∫—É)
                        '& .MuiDataGrid-columnHeader:focus, & .MuiDataGrid-cell:focus': { outline: 'none' },
                    }}
                />
            </Paper>
        </Box>
    );
};

export default SubstancesList;

==================================================
FILE: .\frontend\src\pages\Public\HomePage.tsx
==================================================
import { useNavigate } from 'react-router-dom';
import {
    Box, Container, Typography, Button, Grid, Paper, Stack,
    Card, CardContent, Chip, Divider
} from '@mui/material';
import {
    Search, Login, MenuBook, Security, Gavel,
    BarChart, Science
} from '@mui/icons-material';
import { StatisticsSection } from './StatisticsSection';
import { SupportFab } from './components/SupportFab';

const HomePage = () => {
    const navigate = useNavigate();

    return (
        <Box sx={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', bgcolor: '#ffffff' }}>

            {/* ==================================================================================
                1. HERO SECTION (–®–ê–ü–ö–ê)
               ================================================================================== */}
            <Box sx={{
                background: 'linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%)',
                color: 'white',
                pt: 2,
                pb: { xs: 12, md: 20 }, // –ß—É—Ç—å –º–µ–Ω—å—à–µ –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É
                position: 'relative',
                overflow: 'hidden'
            }}>
                <Box sx={{ position: 'absolute', top: -150, right: -100, width: 600, height: 600, borderRadius: '50%', bgcolor: 'rgba(59, 130, 246, 0.15)', filter: 'blur(80px)' }} />
                <Box sx={{ position: 'absolute', bottom: 0, left: -100, width: 400, height: 400, borderRadius: '50%', bgcolor: 'rgba(59, 130, 246, 0.1)', filter: 'blur(60px)' }} />

                <Container maxWidth="lg" sx={{ position: 'relative', zIndex: 2 }}>

                    {/* –ù–ê–í–ò–ì–ê–¶–ò–Ø */}
                    <Box display="flex" justifyContent="space-between" alignItems="center" py={3} mb={6}>
                        <Box display="flex" alignItems="center" gap={2} sx={{ cursor: 'pointer' }} onClick={() => window.location.reload()}>
                            <Box sx={{
                                width: 40, height: 40, bgcolor: 'white', borderRadius: 2,
                                display: 'flex', alignItems: 'center', justifyContent: 'center',
                                color: '#0f172a', fontWeight: '900', fontSize: 16
                            }}>
                                UZ
                            </Box>
                            <Box>
                                <Typography variant="subtitle2" fontWeight="800" lineHeight={1.1} color="white">
                                    –ù–ê–¶–ò–û–ù–ê–õ–¨–ù–´–ô<br/>–†–ï–ï–°–¢–†
                                </Typography>
                            </Box>
                        </Box>
                        <Stack direction="row" spacing={2} alignItems="center">
                            <Button
                                color="inherit"
                                onClick={() => navigate('/login')}
                                sx={{ display: { xs: 'none', sm: 'block' }, fontWeight: 500, fontSize: '0.9rem' }}
                            >
                                –í—Ö–æ–¥ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                            </Button>
                            <Button
                                variant="contained"
                                size="small"
                                color="primary"
                                startIcon={<Login />}
                                onClick={() => navigate('/login')}
                                sx={{
                                    borderRadius: 50, px: 3,
                                    bgcolor: 'rgba(255,255,255,0.15)',
                                    backdropFilter: 'blur(10px)',
                                    boxShadow: 'none',
                                    '&:hover': { bgcolor: 'rgba(255,255,255,0.25)' }
                                }}
                            >
                                –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                            </Button>
                        </Stack>
                    </Box>

                    {/* –ì–õ–ê–í–ù–´–ô –ë–õ–û–ö */}
                    <Grid container spacing={6} alignItems="center">
                        <Grid item xs={12} md={7}>
                            <Chip
                                label="–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"
                                size="small"
                                sx={{ bgcolor: 'rgba(96, 165, 250, 0.2)', color: '#93c5fd', fontWeight: 600, mb: 3, border: '1px solid rgba(96, 165, 250, 0.3)' }}
                            />
                            <Typography variant="h2" fontWeight="800" sx={{ mb: 3, lineHeight: 1.1, fontSize: { xs: '2.5rem', md: '3.5rem' }, color: 'white' }}>
                                –ï–¥–∏–Ω—ã–π —É—á–µ—Ç —Ö–∏–º–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏
                            </Typography>
                            <Typography variant="h6" sx={{ mb: 5, opacity: 0.85, fontWeight: 400, maxWidth: 550, color: '#e2e8f0', lineHeight: 1.6, fontSize: '1.1rem' }}>
                                –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ø–∞—Å–ø–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –æ–±–æ—Ä–æ—Ç–∞ –æ–ø–∞—Å–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω.
                            </Typography>

                            <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>
                                <Button
                                    variant="contained"
                                    size="large"
                                    onClick={() => navigate('/registry')}
                                    startIcon={<Search />}
                                    sx={{
                                        py: 1.5, px: 4, borderRadius: 2,
                                        fontSize: '1rem', fontWeight: 'bold',
                                        bgcolor: '#3b82f6', color: 'white',
                                        boxShadow: '0 10px 20px -5px rgba(59, 130, 246, 0.5)',
                                        '&:hover': { bgcolor: '#2563eb' }
                                    }}
                                >
                                    –ü–æ–∏—Å–∫ –≤ –†–µ–µ—Å—Ç—Ä–µ
                                </Button>
                                <Button
                                    variant="outlined"
                                    size="large"
                                    onClick={() => navigate('/statistics')}
                                    startIcon={<BarChart />}
                                    sx={{
                                        py: 1.5, px: 4, borderRadius: 2,
                                        fontSize: '1rem', color: 'white',
                                        borderColor: 'rgba(255,255,255,0.3)',
                                        '&:hover': { borderColor: 'white', bgcolor: 'rgba(255,255,255,0.05)' }
                                    }}
                                >
                                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                                </Button>
                            </Stack>
                        </Grid>

                        {/* –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨ (–ò–Ω—Ñ–æ-–±–ª–æ–∫) */}
                        <Grid item xs={12} md={5} sx={{ display: { xs: 'none', md: 'block' } }}>
                            <Paper sx={{
                                bgcolor: 'rgba(30, 41, 59, 0.7)', // –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
                                backdropFilter: 'blur(12px)',
                                borderRadius: 3,
                                border: '1px solid rgba(255,255,255,0.1)',
                                overflow: 'hidden',
                                boxShadow: '0 20px 40px -10px rgba(0,0,0,0.3)'
                            }}>
                                <Box p={2.5} borderBottom="1px solid rgba(255,255,255,0.1)">
                                    <Typography variant="subtitle2" fontWeight="bold" color="white" letterSpacing={1}>–ö–õ–Æ–ß–ï–í–´–ï –ó–ê–î–ê–ß–ò</Typography>
                                </Box>
                                <Stack spacing={0}>
                                    <InfoItem icon={<Security sx={{ color: '#4ade80' }} />} title="–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" text="–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–æ—Ä–æ—Ç–∞ –æ–ø–∞—Å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤" />
                                    <Divider sx={{ borderColor: 'rgba(255,255,255,0.05)' }} />
                                    <InfoItem icon={<MenuBook sx={{ color: '#60a5fa' }} />} title="–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è" text="–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ (GHS/–ì–û–°–¢)" />
                                    <Divider sx={{ borderColor: 'rgba(255,255,255,0.05)' }} />
                                    <InfoItem icon={<Gavel sx={{ color: '#facc15' }} />} title="–†–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ" text="–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É –†–£–∑" />
                                </Stack>
                            </Paper>
                        </Grid>
                    </Grid>
                </Container>
            </Box>

            {/* ==================================================================================
                2. –ë–õ–û–ö –°–¢–ê–¢–ò–°–¢–ò–ö–ò (–ü–õ–ê–í–ê–Æ–©–ò–ô)
               ================================================================================== */}
            <Container maxWidth="lg" sx={{ mt: -10, position: 'relative', zIndex: 10, mb: 12 }}>
                <Paper
                    elevation={0}
                    sx={{
                        borderRadius: 4,
                        // –ö—Ä–∞—Å–∏–≤–∞—è –≥–ª—É–±–æ–∫–∞—è —Ç–µ–Ω—å
                        boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.15)',
                        bgcolor: 'white',
                        border: '1px solid rgba(0,0,0,0.05)',
                        overflow: 'hidden'
                    }}
                >
                    <StatisticsSection />
                </Paper>
            </Container>

            {/* ==================================================================================
                3. –í–û–ó–ú–û–ñ–ù–û–°–¢–ò (–ö–ê–†–¢–û–ß–ö–ò –í –†–Ø–î)
               ================================================================================== */}
            <Container maxWidth="lg" sx={{ mb: 12 }}>
                <Box textAlign="center" mb={6}>
                    <Typography variant="overline" color="primary" fontWeight="bold" letterSpacing={2}>
                        –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –°–ò–°–¢–ï–ú–´
                    </Typography>
                    <Typography variant="h3" fontWeight="800" color="#1e293b" mt={1}>
                        –ï–¥–∏–Ω–æ–µ —Ü–∏—Ñ—Ä–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
                    </Typography>
                </Box>

                {/* Grid container —Å spacing 4. –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç 4 –∫–æ–ª–æ–Ω–∫–∏ —à–∏—Ä–∏–Ω–æ–π –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ (md={4}) */}
                <Grid container spacing={4} alignItems="stretch">
                    <FeatureCard
                        title="–û—Ç–∫—Ä—ã—Ç—ã–π —Ä–µ–µ—Å—Ç—Ä"
                        desc="–î–æ—Å—Ç—É–ø –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤, –ø—Ä–æ—à–µ–¥—à–∏—Ö –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é."
                        icon={<Search fontSize="large" color="primary" />}
                    />
                    <FeatureCard
                        title="–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ü–∞—Å–ø–æ—Ä—Ç–æ–≤"
                        desc="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–∞—Å–ø–æ—Ä—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ö–∏–º–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ –ì–û–°–¢ 30333-2007."
                        icon={<MenuBook fontSize="large" color="secondary" />}
                    />
                    <FeatureCard
                        title="–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è GHS"
                        desc="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –°–ì–° (GHS)."
                        icon={<Science fontSize="large" color="warning" />}
                    />
                </Grid>
            </Container>

            {/* ==================================================================================
                4. –≠–¢–ê–ü–´ –†–ê–ë–û–¢–´ (–°–ï–†–´–ô –§–û–ù)
               ================================================================================== */}
            <Box sx={{ bgcolor: '#f8fafc', py: 10 }}>
                <Container maxWidth="lg">
                    <Grid container spacing={6} alignItems="center">
                        {/* –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –¢–µ–∫—Å—Ç */}
                        <Grid item xs={12} md={6}>
                            <Typography variant="h4" fontWeight="800" color="#1e293b" mb={4}>
                                –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤–µ—â–µ—Å—Ç–≤–∞
                            </Typography>
                            <Stack spacing={3}>
                                <StepItem num="1" title="–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏" text="–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–µ—Ä –ø–æ–¥–∞–µ—Ç –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, —É–∫–∞–∑—ã–≤–∞—è —Å–æ—Å—Ç–∞–≤ –∏ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–µ—â–µ—Å—Ç–≤–∞." />
                                <StepItem num="2" title="–≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞" text="–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏." />
                                <StepItem num="3" title="–í–Ω–µ—Å–µ–Ω–∏–µ –≤ —Ä–µ–µ—Å—Ç—Ä" text="–í–µ—â–µ—Å—Ç–≤—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä, –∏ –æ–Ω–æ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ." />
                            </Stack>
                        </Grid>

                        {/* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - CTA –ö–∞—Ä—Ç–æ—á–∫–∞ */}
                        <Grid item xs={12} md={6}>
                            <Paper elevation={0} sx={{
                                height: 380,
                                borderRadius: 4,
                                border: '1px solid #e2e8f0',
                                bgcolor: 'white',
                                display: 'flex',
                                flexDirection: 'column', // –í–ê–ñ–ù–û: –ö–æ–ª–æ–Ω–∫–∞
                                justifyContent: 'center', // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
                                alignItems: 'center', // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                                background: 'radial-gradient(circle at top right, #f1f5f9, white)',
                                position: 'relative',
                                overflow: 'hidden',
                                p: 4
                            }}>
                                {/* –§–æ–Ω–æ–≤–∞—è –∏–∫–æ–Ω–∫–∞ */}
                                <Science sx={{ fontSize: 180, color: '#f1f5f9', position: 'absolute', top: -20, right: -20, opacity: 0.8 }} />

                                <Box sx={{ position: 'relative', zIndex: 2, textAlign: 'center' }}>
                                    <Typography variant="h5" fontWeight="800" color="#1e293b" gutterBottom>
                                        –ù–∞—á–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É<br/>–ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
                                    </Typography>
                                    <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
                                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏ –ø–æ–ª—É—á–∏—Ç–µ<br/>–¥–æ—Å—Ç—É–ø –∫ –∫–∞–±–∏–Ω–µ—Ç—É
                                    </Typography>
                                    <Button
                                        variant="contained"
                                        size="large"
                                        onClick={() => navigate('/login')}
                                        sx={{ borderRadius: 2, px: 4, py: 1.5, fontWeight: 'bold' }}
                                    >
                                        –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
                                    </Button>
                                </Box>
                            </Paper>
                        </Grid>
                    </Grid>
                </Container>
            </Box>

            {/* 5. –§–£–¢–ï–† */}
            <Box sx={{ bgcolor: '#0f172a', color: '#94a3b8', py: 8, mt: 'auto' }}>
                <Container maxWidth="lg">
                    <Grid container spacing={4}>
                        <Grid item xs={12} md={4}>
                            <Box display="flex" alignItems="center" gap={2} mb={2}>
                                <Box sx={{ width: 32, height: 32, bgcolor: 'white', borderRadius: 1, display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#0f172a', fontWeight: 'bold' }}>UZ</Box>
                                <Typography variant="h6" fontWeight="bold" color="white">–ù–†–û–•–í</Typography>
                            </Box>
                            <Typography variant="body2" sx={{ maxWidth: 300, lineHeight: 1.6 }}>
                                –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–ø–∞—Å–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω.
                            </Typography>
                        </Grid>
                        <Grid item xs={6} md={4}>
                            <Typography variant="subtitle2" fontWeight="bold" color="white" gutterBottom sx={{ textTransform: 'uppercase', letterSpacing: 1, mb: 2 }}>–ù–∞–≤–∏–≥–∞—Ü–∏—è</Typography>
                            <Stack spacing={1.5}>
                                <LinkItem onClick={() => navigate('/registry')}>–†–µ–µ—Å—Ç—Ä –≤–µ—â–µ—Å—Ç–≤</LinkItem>
                                <LinkItem onClick={() => navigate('/statistics')}>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</LinkItem>
                                <LinkItem onClick={() => navigate('/login')}>–ö–∞–±–∏–Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞</LinkItem>
                            </Stack>
                        </Grid>
                        <Grid item xs={6} md={4}>
                            <Typography variant="subtitle2" fontWeight="bold" color="white" gutterBottom sx={{ textTransform: 'uppercase', letterSpacing: 1, mb: 2 }}>–ü–æ–º–æ—â—å</Typography>
                            <Stack spacing={1.5}>
                                <Box>
                                    <Typography variant="caption" display="block">–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞:</Typography>
                                    <Typography variant="body2" color="white" fontWeight="500">support@chem-registry.uz</Typography>
                                </Box>
                                <Typography variant="caption" sx={{ display: 'block' }}>–ü–Ω-–ü—Ç, 09:00 - 18:00</Typography>
                            </Stack>
                        </Grid>
                    </Grid>
                    <Divider sx={{ borderColor: 'rgba(255,255,255,0.1)', my: 4 }} />
                    <Typography variant="body2" align="center" sx={{ opacity: 0.5 }}>
                        ¬© 2025 –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –†–µ–µ—Å—Ç—Ä –û–•–í. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
                    </Typography>
                </Container>
            </Box>

            <SupportFab />
        </Box>
    );
};

// --- –ö–û–ú–ü–û–ù–ï–ù–¢–´ ---

const InfoItem = ({ icon, title, text }: any) => (
    <Box display="flex" alignItems="center" gap={2} p={2} sx={{ '&:hover': { bgcolor: 'rgba(255,255,255,0.05)' }, transition: '0.2s' }}>
        <Box sx={{ display: 'flex', alignItems: 'center' }}>{icon}</Box>
        <Box>
            <Typography variant="body2" fontWeight="bold" color="white">{title}</Typography>
            <Typography variant="caption" sx={{ color: '#94a3b8' }}>{text}</Typography>
        </Box>
    </Box>
);

// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–æ md={4} –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏
const FeatureCard = ({ title, desc, icon }: any) => (
    <Grid item xs={12} md={4}>
        <Card elevation={0} sx={{
            height: '100%',
            border: '1px solid #e2e8f0',
            borderRadius: 3,
            transition: '0.3s',
            display: 'flex', flexDirection: 'column',
            '&:hover': { transform: 'translateY(-5px)', boxShadow: '0 15px 30px -10px rgba(0,0,0,0.08)' }
        }}>
            <CardContent sx={{ p: 4, flexGrow: 1 }}>
                <Box sx={{ mb: 3, p: 2, bgcolor: '#f1f5f9', borderRadius: 3, width: 'fit-content' }}>
                    {icon}
                </Box>
                <Typography variant="h6" fontWeight="800" gutterBottom color="#1e293b">{title}</Typography>
                <Typography variant="body2" color="text.secondary" lineHeight={1.6}>{desc}</Typography>
            </CardContent>
        </Card>
    </Grid>
);

const StepItem = ({ num, title, text }: any) => (
    <Box display="flex" gap={3}>
        <Box sx={{
            width: 48, height: 48, flexShrink: 0,
            borderRadius: '50%', bgcolor: '#ffffff', color: '#3b82f6',
            border: '2px solid #3b82f6',
            display: 'flex', alignItems: 'center', justifyContent: 'center',
            fontWeight: 'bold', fontSize: '1.2rem'
        }}>
            {num}
        </Box>
        <Box pt={0.5}>
            <Typography variant="h6" fontWeight="bold" gutterBottom color="#1e293b">{title}</Typography>
            <Typography variant="body2" color="text.secondary" lineHeight={1.6}>{text}</Typography>
        </Box>
    </Box>
);

const LinkItem = ({ children, onClick }: any) => (
    <Typography
        variant="body2"
        onClick={onClick}
        sx={{ cursor: 'pointer', transition: '0.2s', '&:hover': { color: 'white', transform: 'translateX(5px)' } }}
    >
        {children}
    </Typography>
);

export default HomePage;

==================================================
FILE: .\frontend\src\pages\Public\LandingPage.tsx
==================================================
import { useState } from 'react';
import {
    Container, Box, Typography, Paper,
    Button, InputBase, IconButton, Divider, Grid
} from '@mui/material';
import { Search, Login, Description, Clear, BarChart } from '@mui/icons-material';
import { DataGrid, GridToolbar } from '@mui/x-data-grid';
import type { GridColDef, GridRenderCellParams } from '@mui/x-data-grid';
import { useQuery } from '@tanstack/react-query';
import { useNavigate } from 'react-router-dom';
import client from '../../api/client';
import { downloadPassport } from '../../api/registry';
import { useDebounce } from '../../hooks/useDebounce';
import { FilterSidebar } from './components/FilterSidebar';
import { SupportFab } from './components/SupportFab';
import parse from 'autosuggest-highlight/parse';
import match from 'autosuggest-highlight/match';

// --- –•–µ–ª–ø–µ—Ä –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ ---
const HighlightedText = ({ text, query }: { text: string, query: string }) => {
    if (!text) return null;
    if (!query) return <span>{text}</span>;
    const matches = match(text, query);
    const parts = parse(text, matches);
    return (
        <span>
            {parts.map((part, index) => (
                <span
                    key={index}
                    style={{
                        fontWeight: part.highlight ? 800 : 400,
                        color: part.highlight ? '#1565c0' : 'inherit',
                        backgroundColor: part.highlight ? '#e3f2fd' : 'transparent',
                    }}
                >
                    {part.text}
                </span>
            ))}
        </span>
    );
};

interface RegistryColumn {
    field: string;
    headerName: string;
    minWidth: number;
}

const LandingPage = () => {
    const navigate = useNavigate();

    // 1. –ü–û–ò–°–ö
    const [inputValue, setInputValue] = useState('');
    const searchTerm = useDebounce(inputValue, 400);

    // 2. –§–ò–õ–¨–¢–†–´
    const [activeFilters, setActiveFilters] = useState<Record<string, string>>({});

    const handleFilterChange = (key: string, value: string | null) => {
        setActiveFilters(prev => {
            const next = { ...prev };
            if (value === null) delete next[key];
            else next[key] = value;
            return next;
        });
    };

    // 3. –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
    const { data: rowsData, isLoading } = useQuery({
        queryKey: ['public-data', searchTerm, activeFilters],
        queryFn: async () => {
            const params: any = { ...activeFilters };
            if (searchTerm) params.search = searchTerm;
            else params.ordering = '-updated_at';
            const res = await client.get('/registry/elements/', { params });
            return res.data;
        },
        staleTime: 1000 * 60 * 2,
    });

    // 4. –ó–ê–ì–†–£–ó–ö–ê –§–ê–°–ï–¢–û–í
    const { data: facetsData, isLoading: isFacetsLoading } = useQuery({
        queryKey: ['facets', searchTerm],
        queryFn: async () => {
            const params: any = {};
            if (searchTerm) params.search = searchTerm;
            const res = await client.get('/registry/elements/facets/', { params });
            return res.data;
        },
        retry: false
    });

    // 5. –ö–û–õ–û–ù–ö–ò
    const { data: configColumns } = useQuery({
        queryKey: ['public-config'],
        queryFn: async () => {
            const res = await client.get<RegistryColumn[]>('/registry/config/');
            return res.data;
        },
        staleTime: 1000 * 60 * 30,
    });

    const columns: GridColDef[] = [
        { field: 'id', headerName: 'ID', width: 70 },
        ...(configColumns || []).map(col => ({
            field: col.field, headerName: col.headerName, minWidth: 150, flex: 1,
            renderCell: (params: GridRenderCellParams) => {
                const value = params.value ? String(params.value) : '';
                if (col.field === 'primary_name_ru' || col.field === 'primary_name') {
                    return (
                        <span
                            style={{ cursor: 'pointer', textDecoration: 'underline', textUnderlineOffset: '3px' }}
                            onClick={(e) => { e.stopPropagation(); navigate(`/public/${params.row.id}`); }}
                        >
                            <HighlightedText text={value} query={searchTerm} />
                        </span>
                    );
                }
                return <HighlightedText text={value} query={searchTerm} />;
            }
        })),
        { field: 'actions', headerName: '–î–æ–∫—É–º–µ–Ω—Ç', width: 140, sortable: false, renderCell: (params) => (
                <Button size="small" onClick={() => downloadPassport(params.row.id)}>–ü–∞—Å–ø–æ—Ä—Ç</Button>
            )}
    ];

    const rows = (rowsData?.results || []).map((item: any) => {
        const flatItem = { ...item };
        Object.keys(item).forEach(key => {
            if (typeof item[key] === 'object' && item[key] !== null && key.startsWith('sec')) {
                Object.assign(flatItem, item[key]);
            }
        });
        return flatItem;
    });

    // –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∞–π–¥–±–∞—Ä–∞ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –µ—Å–ª–∏ –≥—Ä—É–∑–∏—Ç—Å—è –ò–õ–ò –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)
    const showSidebar = isFacetsLoading || (facetsData && Object.keys(facetsData).length > 0);

    return (
        <Box sx={{ minHeight: '100vh', bgcolor: '#f8fafc', display: 'flex', flexDirection: 'column' }}>

            {/* –ì–ï–†–û–ô */}
            <Box sx={{ background: 'linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%)', color: 'white', pb: 12 }}>
                <Container maxWidth="xl">
                    <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', py: 2, mb: 6 }}>
                        <Box sx={{ display:'flex', alignItems:'center', gap: 2 }}>
                            <Box sx={{ p: 1, bgcolor:'white', borderRadius:'50%', color: '#1e3a8a', fontWeight:'bold', width: 40, height: 40, display: 'flex', justifyContent:'center', alignItems:'center' }}>UZ</Box>
                            <Typography variant="h6" sx={{ fontWeight: 600 }}>–ù–ê–¶–ò–û–ù–ê–õ–¨–ù–´–ô –†–ï–ï–°–¢–†</Typography>
                        </Box>

                        <Box display="flex" gap={2}>
                            <Button
                                color="inherit"
                                startIcon={<BarChart />}
                                onClick={() => navigate('/statistics')}
                                sx={{ borderRadius: 20, textTransform: 'none', fontWeight: 500, opacity: 0.9, '&:hover': { opacity: 1, bgcolor: 'rgba(255,255,255,0.1)' } }}
                            >
                                –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            </Button>
                            <SupportFab />
                            <Button
                                variant="outlined"
                                color="inherit"
                                startIcon={<Login />}
                                onClick={() => navigate('/login')}
                                sx={{ borderRadius: 20, textTransform: 'none', borderColor: 'rgba(255,255,255,0.3)', '&:hover': { borderColor: 'white', bgcolor: 'rgba(255,255,255,0.1)' } }}
                            >
                                –ö–∞–±–∏–Ω–µ—Ç
                            </Button>
                        </Box>
                    </Box>

                    <Box sx={{ textAlign: 'center', maxWidth: '800px', mx: 'auto' }}>
                        <Typography variant="h3" fontWeight="800" sx={{ mb: 4, lineHeight: 1.2 }}>
                            –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö<br/>—Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                        </Typography>

                        {/* –ü–û–ò–°–ö */}
                        <Paper sx={{ p: '4px', display: 'flex', alignItems: 'center', borderRadius: 50, boxShadow: '0 8px 32px rgba(0,0,0,0.2)', bgcolor: 'white', height: 60 }}>
                            <Box sx={{ pl: 2, display: 'flex', alignItems: 'center', flex: 1 }}>
                                <Search sx={{ color: '#1e3a8a', fontSize: 26, mr: 1 }} />
                                <InputBase
                                    sx={{ flex: 1, fontSize: '1.1rem' }}
                                    placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ, CAS –Ω–æ–º–µ—Ä –∏–ª–∏ —Ñ–æ—Ä–º—É–ª—É..."
                                    value={inputValue}
                                    onChange={(e) => setInputValue(e.target.value)}
                                    onKeyDown={(e) => { if (e.key === 'Enter') (e.target as HTMLInputElement).blur(); }}
                                />
                                {inputValue && (
                                    <>
                                        <IconButton size="small" onClick={() => setInputValue('')} sx={{ mr: 1 }}><Clear/></IconButton>
                                        <Divider sx={{ height: 28, m: 0.5 }} orientation="vertical" />
                                    </>
                                )}
                            </Box>
                            <Button variant="contained" size="large" sx={{ borderRadius: 30, px: 4, height: '100%', boxShadow: 'none' }}>
                                –ù–∞–π—Ç–∏
                            </Button>
                        </Paper>
                    </Box>
                </Container>
            </Box>

            {/* –ö–û–ù–¢–ï–ù–¢ */}
            <Container maxWidth="xl" sx={{ mt: -8, mb: 10, flexGrow: 1, position: 'relative', zIndex: 2 }}>
                <Grid container spacing={3}>

                    {/* –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê (–°–∞–π–¥–±–∞—Ä) */}
                    {showSidebar && (
                        <Grid item xs={12} md={3} lg={2.5} sx={{ minWidth: 0 }}>
                            <Box sx={{ position: 'sticky', top: 24 }}>
                                <FilterSidebar
                                    data={facetsData}
                                    isLoading={isFacetsLoading}
                                    activeFilters={activeFilters}
                                    onFilterChange={handleFilterChange}
                                />
                            </Box>
                        </Grid>
                    )}

                    {/* –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê (–¢–∞–±–ª–∏—Ü–∞) */}
                    <Grid item xs={12} md={showSidebar ? 9 : 12} lg={showSidebar ? 9.5 : 12} sx={{ minWidth: 0 }}>
                        <Paper sx={{ height: 700, width: '100%', borderRadius: 4, overflow: 'hidden', boxShadow: '0 10px 40px -10px rgba(0,0,0,0.1)' }}>
                            <DataGrid
                                rows={rows}
                                columns={columns}
                                // –ò–°–ü–û–õ–¨–ó–£–ï–ú –í–°–¢–†–û–ï–ù–ù–´–ô LOADER
                                loading={isLoading}
                                disableRowSelectionOnClick
                                initialState={{ pagination: { paginationModel: { pageSize: 15 } } }}
                                pageSizeOptions={[15, 30]}
                                slots={{ toolbar: GridToolbar }}
                                slotProps={{ toolbar: { showQuickFilter: false, printOptions: { disableToolbarButton: true } } }}
                                sx={{
                                    border: 'none',
                                    '& .MuiDataGrid-columnHeaders': { bgcolor: '#f1f5f9', fontWeight: 'bold', textTransform: 'uppercase', color: '#475569', fontSize: '0.8rem' },
                                    '& .MuiDataGrid-cell': { fontSize: '14px', borderBottom: '1px solid #f1f5f9' }
                                }}
                            />
                        </Paper>
                    </Grid>

                </Grid>
            </Container>
        </Box>
    );
};

export default LandingPage;

==================================================
FILE: .\frontend\src\pages\Public\PublicElementPage.styles.ts
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\frontend\src\pages\Public\PublicElementPage.tsx
==================================================
import { useParams } from 'react-router-dom';
import { useQuery } from '@tanstack/react-query';
import { Box, CircularProgress, Alert, Grid } from '@mui/material';
import { getElementById } from '../../api/registry';
import { styles } from './PublicElementPage.styles';
import { ElementHeader } from './components/ElementHeader';
import { ElementSidebar } from './components/ElementSidebar';
import { ElementTabs } from './components/ElementTabs';

const PublicElementPage = () => {
    const { id } = useParams();

    const { data, isLoading, error } = useQuery({
        queryKey: ['public-element', id],
        queryFn: () => getElementById(id!),
        enabled: !!id
    });

    if (isLoading) return <Box sx={{ display: 'flex', justifyContent: 'center', height: '100vh', alignItems: 'center' }}><CircularProgress /></Box>;
    if (error) return <Box p={5}><Alert severity="error">–î–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.</Alert></Box>;

    return (
        <Box sx={styles.pageContainer}>

            {/* --- –®–ê–ü–ö–ê --- */}
            <Box sx={styles.headerPaper}>
                <Box sx={styles.contentWrapper}>
                    <ElementHeader data={data} />
                </Box>
            </Box>

            {/* --- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ --- */}
            <Box sx={styles.contentWrapper}>
                <Grid container spacing={4}>

                    {/* 1. –ë–õ–û–ö –° –¢–ê–ë–ê–ú–ò (–¢–µ–ø–µ—Ä—å –≤–æ –≤—Å—é —à–∏—Ä–∏–Ω—É) */}
                    <Grid item xs={12}>
                        <ElementTabs data={data} />
                    </Grid>

                    {/* 2. –ë–õ–û–ö –° –î–û–ö–£–ú–ï–ù–¢–ê–ú–ò (–¢–µ–ø–µ—Ä—å —Å–Ω–∏–∑—É –∏ –≤–æ –≤—Å—é —à–∏—Ä–∏–Ω—É) */}
                    <Grid item xs={12}>
                        <ElementSidebar attachments={data.attachments} />
                    </Grid>

                </Grid>
            </Box>
        </Box>
    );
};

export default PublicElementPage;

==================================================
FILE: .\frontend\src\pages\Public\StatisticsPage.tsx
==================================================
import { useQuery } from '@tanstack/react-query';
import { useNavigate } from 'react-router-dom';
import {
    Box, Container, Typography, Paper, Grid, LinearProgress,
    Skeleton, Button, Chip, Stack
} from '@mui/material';
import {
    ArrowBack, Science, WarningAmber, Assessment,
    Shield, LocalFireDepartment, Spa
} from '@mui/icons-material';
import { getStatistics } from '../../api/registry';

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤ –∏ –∏–∫–æ–Ω–æ–∫ –¥–ª—è –∫–ª–∞—Å—Å–æ–≤
const HAZARD_CONFIG: Record<string, { label: string, color: string, icon: any, desc: string }> = {
    '1': { label: '–ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ', color: '#d32f2f', icon: <LocalFireDepartment />, desc: '–¢—Ä–µ–±—É—é—Ç –æ—Å–æ–±–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è' },
    '2': { label: '–í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ', color: '#ed6c02', icon: <WarningAmber />, desc: '–°—Ç—Ä–æ–≥–∏–µ –Ω–æ—Ä–º—ã –æ–±—Ä–∞—â–µ–Ω–∏—è' },
    '3': { label: '–£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ', color: '#fbc02d', icon: <Science />, desc: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã' },
    '4': { label: '–ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ', color: '#2e7d32', icon: <Spa />, desc: '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏' },
    'NC': { label: '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ', color: '#9e9e9e', icon: <Shield />, desc: '–î–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç' }
};

const StatisticsPage = () => {
    const navigate = useNavigate();

    const { data, isLoading } = useQuery({
        queryKey: ['stats-full'],
        queryFn: getStatistics,
        staleTime: 1000 * 60 * 5 // 5 –º–∏–Ω—É—Ç –∫—ç—à–∞
    });

    const total = data?.total_elements || 0;
    const distribution = data?.hazard_distribution || [];

    // –ü–æ–¥—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞
    const getPercent = (count: number) => total > 0 ? Math.round((count / total) * 100) : 0;

    return (
        <Box sx={{ minHeight: '100vh', bgcolor: '#f8fafc' }}>

            {/* --- –•–ï–î–ï–† --- */}
            <Box sx={{ background: 'linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%)', color: 'white', pt: 4, pb: 12 }}>
                <Container maxWidth="lg">
                    <Button
                        startIcon={<ArrowBack />}
                        onClick={() => navigate('/')}
                        sx={{ color: 'white', mb: 2, opacity: 0.8, '&:hover': { opacity: 1 } }}
                    >
                        –ù–∞ –≥–ª–∞–≤–Ω—É—é
                    </Button>
                    <Box display="flex" alignItems="center" gap={2}>
                        <Assessment sx={{ fontSize: 48, opacity: 0.9 }} />
                        <Box>
                            <Typography variant="h4" fontWeight="800">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –†–µ–µ—Å—Ç—Ä–∞</Typography>
                            <Typography variant="body1" sx={{ opacity: 0.8 }}>
                                –û–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –±–∞–∑—ã —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤
                            </Typography>
                        </Box>
                    </Box>
                </Container>
            </Box>

            {/* --- –ö–û–ù–¢–ï–ù–¢ --- */}
            <Container maxWidth="lg" sx={{ mt: -8 }}>

                {/* 1. –ì–õ–ê–í–ù–ê–Ø –¶–ò–§–†–ê */}
                <Paper elevation={0} sx={{ p: 4, borderRadius: 4, mb: 4, boxShadow: '0 20px 40px -10px rgba(0,0,0,0.1)' }}>
                    <Grid container alignItems="center" spacing={4}>
                        <Grid item xs={12} md={6}>
                            <Typography variant="overline" color="text.secondary" fontWeight="700" letterSpacing={1}>
                                –û–±—â–∏–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
                            </Typography>
                            <Box display="flex" alignItems="baseline" gap={2} mt={1}>
                                {isLoading ? <Skeleton width={100} height={60} /> : (
                                    <Typography variant="h2" fontWeight="800" color="#1e293b">
                                        {total.toLocaleString()}
                                    </Typography>
                                )}
                                <Typography variant="h6" color="text.secondary" fontWeight="500">
                                    –≤–µ—â–µ—Å—Ç–≤
                                </Typography>
                            </Box>
                            <Typography variant="body2" color="text.secondary" sx={{ mt: 1, maxWidth: 400 }}>
                                –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ—à–µ–¥—à–∏—Ö –º–æ–¥–µ—Ä–∞—Ü–∏—é –≤ —Å–∏—Å—Ç–µ–º–µ.
                            </Typography>
                        </Grid>
                        <Grid item xs={12} md={6}>
                            {/* –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É, –ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞ –∏–ª–∏ –∏–∫–æ–Ω–∫–∞ */}
                            <Box sx={{
                                bgcolor: '#eff6ff', borderRadius: 3, p: 3,
                                display: 'flex', alignItems: 'center', gap: 2,
                                border: '1px dashed #bfdbfe'
                            }}>
                                <Science sx={{ fontSize: 40, color: '#3b82f6' }} />
                                <Box>
                                    <Typography variant="subtitle2" fontWeight="700" color="#1e3a8a">
                                        –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
                                    </Typography>
                                    <Typography variant="caption" color="#64748b">
                                        –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –º–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
                                    </Typography>
                                </Box>
                            </Box>
                        </Grid>
                    </Grid>
                </Paper>

                <Typography variant="h6" fontWeight="800" color="#334155" mb={3}>
                    –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–°–∞–Ω–ü–∏–ù)
                </Typography>

                {/* 2. –°–ï–¢–ö–ê –ö–õ–ê–°–°–û–í */}
                <Grid container spacing={3}>
                    {isLoading ? (
                        [1, 2, 3, 4].map(i => (
                            <Grid item xs={12} sm={6} md={4} key={i}>
                                <Skeleton variant="rectangular" height={160} sx={{ borderRadius: 3 }} />
                            </Grid>
                        ))
                    ) : (
                        distribution.map((item: any) => {
                            const code = item.sec11_class__sanpin_class || 'NC';
                            const count = item.count;
                            const percent = getPercent(count);
                            const conf = HAZARD_CONFIG[code] || HAZARD_CONFIG['NC'];

                            return (
                                <Grid item xs={12} sm={6} md={4} key={code}>
                                    <Paper
                                        elevation={0}
                                        sx={{
                                            p: 3, borderRadius: 3, border: '1px solid #e2e8f0',
                                            height: '100%', display: 'flex', flexDirection: 'column',
                                            transition: 'transform 0.2s',
                                            '&:hover': { transform: 'translateY(-4px)', borderColor: conf.color }
                                        }}
                                    >
                                        <Box display="flex" justifyContent="space-between" alignItems="flex-start" mb={2}>
                                            <Box sx={{
                                                p: 1.5, borderRadius: 2,
                                                bgcolor: `${conf.color}15`, color: conf.color
                                            }}>
                                                {conf.icon}
                                            </Box>
                                            <Chip label={`${percent}%`} size="small" sx={{ fontWeight: 700, bgcolor: '#f1f5f9' }} />
                                        </Box>

                                        <Typography variant="h4" fontWeight="800" color="#1e293b" mb={0.5}>
                                            {count}
                                        </Typography>
                                        <Typography variant="subtitle2" fontWeight="700" color="text.primary" gutterBottom>
                                            {code === 'NC' ? conf.label : `${code} –ö–ª–∞—Å—Å - ${conf.label}`}
                                        </Typography>
                                        <Typography variant="caption" color="text.secondary" sx={{ mb: 2, display: 'block', flexGrow: 1 }}>
                                            {conf.desc}
                                        </Typography>

                                        <LinearProgress
                                            variant="determinate"
                                            value={percent}
                                            sx={{
                                                height: 6, borderRadius: 3, bgcolor: '#f1f5f9',
                                                '& .MuiLinearProgress-bar': { bgcolor: conf.color }
                                            }}
                                        />
                                    </Paper>
                                </Grid>
                            );
                        })
                    )}
                </Grid>

            </Container>
        </Box>
    );
};

export default StatisticsPage;

==================================================
FILE: .\frontend\src\pages\Public\StatisticsSection.tsx
==================================================
import { useQuery } from '@tanstack/react-query';
import { Box, Grid, Typography, LinearProgress, Skeleton } from '@mui/material';
import { Science, WarningAmber } from '@mui/icons-material';
import { getStatistics } from '../../api/registry';

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤ –∏ –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è –∫–ª–∞—Å—Å–æ–≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
const HAZARD_CONFIG: Record<string, { label: string, color: string }> = {
    '1': { label: '1 - –ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã–µ', color: '#d32f2f' },
    '2': { label: '2 - –í—ã—Å–æ–∫–æ–æ–ø–∞—Å–Ω—ã–µ', color: '#ed6c02' },
    '3': { label: '3 - –£–º–µ—Ä–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã–µ', color: '#fbc02d' },
    '4': { label: '4 - –ú–∞–ª–æ–æ–ø–∞—Å–Ω—ã–µ', color: '#2e7d32' },
    'NC': { label: '–ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ', color: '#9e9e9e' }
};

export const StatisticsSection = () => {
    const { data, isLoading } = useQuery({
        queryKey: ['stats'],
        queryFn: getStatistics,
        staleTime: 1000 * 60 * 15,
    });

    if (isLoading) {
        return (
            <Grid container spacing={4} sx={{ p: 4 }}>
                <Grid item xs={12} md={4}><Skeleton variant="rectangular" height={100} /></Grid>
                <Grid item xs={12} md={8}><Skeleton variant="text" /><Skeleton variant="rectangular" height={80} /></Grid>
            </Grid>
        );
    }

    if (!data) return null;

    const total = data.total_elements || 0;
    const distribution = data.hazard_distribution || [];

    // –°—á–∏—Ç–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
    const getPercent = (count: number) => total > 0 ? (count / total) * 100 : 0;

    return (
        <Box sx={{ width: '100%', p: { xs: 3, md: 5 } }}> {/* –¢–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã */}
            <Grid container spacing={6} alignItems="center">

                {/* –õ–ï–í–ê–Ø –ß–ê–°–¢–¨: –û–ë–©–ê–Ø –¶–ò–§–†–ê */}
                <Grid item xs={12} md={4} sx={{ borderRight: { md: '1px solid #f1f5f9' }, textAlign: 'center' }}>
                    <Box
                        sx={{
                            display: 'inline-flex', p: 2.5, borderRadius: '50%',
                            bgcolor: '#eff6ff', color: '#2563eb', mb: 2
                        }}
                    >
                        <Science sx={{ fontSize: 40 }} />
                    </Box>
                    <Typography variant="h2" fontWeight="800" color="#1e293b" sx={{ lineHeight: 1 }}>
                        {total}
                    </Typography>
                    <Typography variant="body2" color="text.secondary" fontWeight="500" mt={1}>
                        –•–∏–º–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –≤ —Ä–µ–µ—Å—Ç—Ä–µ
                    </Typography>
                </Grid>

                {/* –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨: –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ü–û –ö–õ–ê–°–°–ê–ú */}
                <Grid item xs={12} md={8}>
                    <Box display="flex" alignItems="center" gap={1.5} mb={3}>
                        <WarningAmber color="action" />
                        <Typography variant="h6" fontWeight="700" color="#334155">
                            –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–°–∞–Ω–ü–∏–ù)
                        </Typography>
                    </Box>

                    <Grid container spacing={4}>
                        {distribution.map((item: any) => {
                            const code = item.sec11_class__sanpin_class || 'NC';
                            const count = item.count;
                            const config = HAZARD_CONFIG[code] || HAZARD_CONFIG['NC'];

                            return (
                                <Grid item xs={12} sm={6} key={code}>
                                    <Box mb={1} display="flex" justifyContent="space-between" alignItems="flex-end">
                                        <Typography variant="caption" fontWeight="700" sx={{ color: config.color, fontSize: '0.75rem', textTransform: 'uppercase' }}>
                                            {config.label}
                                        </Typography>
                                        <Typography variant="body2" fontWeight="700" color="#1e293b">
                                            {count} —à—Ç.
                                        </Typography>
                                    </Box>
                                    <LinearProgress
                                        variant="determinate"
                                        value={getPercent(count)}
                                        sx={{
                                            height: 8,
                                            borderRadius: 4,
                                            bgcolor: '#f1f5f9',
                                            '& .MuiLinearProgress-bar': { bgcolor: config.color }
                                        }}
                                    />
                                </Grid>
                            )
                        })}

                        {distribution.length === 0 && (
                            <Typography variant="body2" color="text.disabled" sx={{ pl: 3 }}>
                                –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                            </Typography>
                        )}
                    </Grid>
                </Grid>
            </Grid>
        </Box>
    );
};

==================================================
FILE: .\frontend\src\pages\Public\components\DataAtoms.tsx
==================================================
import { Box, Chip, Typography } from '@mui/material';
import { CheckCircle, Cancel } from '@mui/icons-material';
import { styles } from '../PublicElementPage.styles';
import { formatValue } from '../utils/formatters';

// === –°–¢–†–û–ö–ê –î–ê–ù–ù–´–• (–£–º–Ω–∞—è) ===
export const InfoRow = ({ label, value, isBool = false }: { label: string, value?: any, isBool?: boolean }) => {

    // --- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–ö–†–´–í–ê–ï–ú –ü–£–°–¢–û–ï ---
    if (value === null || value === undefined || value === "") {
        // –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –¥–ª—è Boolean –º—ã –º–æ–∂–µ–º —Ö–æ—Ç–µ—Ç—å –ø–æ–∫–∞–∑–∞—Ç—å "–ù–µ—Ç", –µ—Å–ª–∏ False.
        // –ù–æ –æ–±—ã—á–Ω–æ –≤ –ø–∞—Å–ø–æ—Ä—Ç–∞—Ö, –µ—Å–ª–∏ —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–µ—Ç, –µ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–∏—à—É—Ç.
        if (!isBool) return null;
        // –î–ª—è boolean, –µ—Å–ª–∏ null/undefined, —Ç–æ–∂–µ —Å–∫—Ä—ã–≤–∞–µ–º. –ï—Å–ª–∏ false - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ù–µ—Ç".
        if (value === null || value === undefined) return null;
    }
    // ------------------------------------

    return (
        <Box sx={styles.rowContainer}>
            <Typography variant="body2" sx={styles.rowLabel}>
                {label}
            </Typography>

            <Box>
                {isBool ? (
                    value ?
                        <Chip icon={<CheckCircle />} label="–î–∞" size="small" sx={{ fontWeight: 600, border: '1px solid #b7eb8f', bgcolor: '#f6ffed', color: '#389e0d', height: 24 }} /> :
                        <Chip icon={<Cancel />} label="–ù–µ—Ç" size="small" sx={{ fontWeight: 600, border: '1px solid #d9d9d9', bgcolor: '#fafafa', color: '#8c8c8c', height: 24 }} />
                ) : (
                    <Typography sx={styles.rowValue}>
                        {formatValue(value)}
                    </Typography>
                )}
            </Box>
        </Box>
    );
};

export const SectionHeader = ({ title }: { title: string }) => (
    <Box sx={styles.sectionHeaderBox}>
        <Box sx={styles.sectionHeaderLine}></Box>
        <Typography sx={styles.sectionHeaderText}>
            {title}
        </Typography>
    </Box>
);

==================================================
FILE: .\frontend\src\pages\Public\components\ElementHeader.tsx
==================================================
import { Box, Button, Chip, Typography, Paper } from '@mui/material';
import { ArrowBack, PictureAsPdf } from '@mui/icons-material';
import { useNavigate } from 'react-router-dom';
import { downloadPassport } from '../../../api/registry';
import { styles } from '../PublicElementPage.styles';

interface ElementHeaderProps {
    data: any;
    disableGutters?: boolean; // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–ø, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—è
}

export const ElementHeader = ({ data }: ElementHeaderProps) => {
    const navigate = useNavigate();

    // –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
    const structureImage = data.sec1_identification?.structure_image;

    return (
        <Box>
            {/* –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" */}
            <Button
                startIcon={<ArrowBack />}
                onClick={() => navigate('/')}
                sx={{
                    mb: 3,
                    color: '#64748b',
                    fontWeight: 600,
                    textTransform: 'none',
                    '&:hover': { bgcolor: 'transparent', color: '#0f172a'}
                }}
            >
                –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
            </Button>

            {/* –û—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */}
            <Box sx={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'flex-start',
                flexWrap: 'wrap',
                gap: 3
            }}>

                {/* –õ–ï–í–ê–Ø –ß–ê–°–¢–¨: –ö–∞—Ä—Ç–∏–Ω–∫–∞ + –ù–∞–∑–≤–∞–Ω–∏–µ */}
                <Box sx={{ display: 'flex', gap: 3, alignItems: 'flex-start', flex: 1 }}>

                    {/* 1. –ö–∞—Ä—Ç–∏–Ω–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–†–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å URL) */}
                    {structureImage && (
                        <Paper
                            elevation={0}
                            sx={{
                                width: 120,
                                height: 120,
                                flexShrink: 0, // –ù–µ —Å–∂–∏–º–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É
                                border: '1px solid #e2e8f0',
                                borderRadius: 3,
                                p: 1,
                                bgcolor: 'white',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                overflow: 'hidden'
                            }}
                        >
                            <img
                                src={structureImage}
                                alt="Structure"
                                style={{
                                    maxWidth: '100%',
                                    maxHeight: '100%',
                                    objectFit: 'contain' // –í–ø–∏—Å–∞—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
                                }}
                            />
                        </Paper>
                    )}

                    {/* 2. –¢–µ–∫—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
                    <Box>
                        <Typography variant="h1" sx={styles.elementTitle}>
                            {data.primary_name_ru}
                        </Typography>

                        <Box sx={styles.metaInfo}>
                            {/* –°—Ç–∞—Ç—É—Å */}
                            <Chip
                                label="–û–ü–£–ë–õ–ò–ö–û–í–ê–ù–û"
                                color="success"
                                size="small"
                                sx={{ fontWeight: 800, borderRadius: 1, px: 1 }}
                            />

                            {/* –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è */}
                            <Typography variant="body2" sx={styles.metaText}>
                                –û–±–Ω–æ–≤–ª–µ–Ω–æ: {new Date(data.updated_at).toLocaleDateString()}
                            </Typography>

                            {/* CAS –ù–æ–º–µ—Ä */}
                            {data.cas_number && (
                                <Chip
                                    label={`CAS: ${data.cas_number}`}
                                    size="small"
                                    variant="outlined"
                                    sx={{
                                        fontWeight: 600,
                                        color: '#475569',
                                        borderColor: '#cbd5e1',
                                        bgcolor: '#f8fafc'
                                    }}
                                />
                            )}
                        </Box>
                    </Box>
                </Box>

                {/* –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨: –ö–Ω–æ–ø–∫–∞ –°–∫–∞—á–∞—Ç—å */}
                <Button
                    variant="contained"
                    color="error"
                    startIcon={<PictureAsPdf />}
                    onClick={() => downloadPassport(data.id, `Passport_${data.id}.pdf`)}
                    sx={{
                        boxShadow: '0 4px 10px rgba(239, 68, 68, 0.3)',
                        borderRadius: 2,
                        px: 3,
                        py: 1.2,
                        fontWeight: 700,
                        whiteSpace: 'nowrap' // –ß—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–ª—Å—è
                    }}
                >
                    –°–∫–∞—á–∞—Ç—å –ü–∞—Å–ø–æ—Ä—Ç
                </Button>
            </Box>
        </Box>
    );
}

==================================================
FILE: .\frontend\src\pages\Public\components\ElementSidebar.tsx
==================================================
import { Box, Button, Paper, Typography, Card, CardContent, Chip, Grid } from '@mui/material';
import { Description, Download, PictureAsPdf } from '@mui/icons-material';
import { styles } from '../PublicElementPage.styles';
import { PdfThumbnail } from './PdfThumbnail.tsx';

interface ElementSidebarProps {
    attachments: any[];
}

export const ElementSidebar = ({ attachments }: ElementSidebarProps) => {
    return (
        <Box sx={{ mt: 2 }}> {/* –ù–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */}
            <Paper
                elevation={0}
                sx={{
                    p: 3,
                    bgcolor: '#ffffff',
                    border: '1px solid #e2e8f0',
                    borderRadius: 3,
                }}
            >
                {/* –ó–ê–ì–û–õ–û–í–û–ö –°–ï–ö–¶–ò–ò */}
                <Box sx={{ mb: 3, pb: 1.5, borderBottom: '1px solid #f1f5f9', display: 'flex', alignItems: 'center', gap: 1 }}>
                    <Box component="span" sx={{ width: 6, height: 6, borderRadius: '50%', bgcolor: '#3b82f6', display: 'inline-block' }} />
                    <Typography
                        variant="subtitle2"
                        sx={{
                            fontWeight: 800,
                            color: '#334155',
                            textTransform: 'uppercase',
                            letterSpacing: '0.5px',
                            fontSize: '0.9rem'
                        }}
                    >
                        –ü–†–ò–ö–†–ï–ü–õ–ï–ù–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´ ({attachments?.length || 0})
                    </Typography>
                </Box>

                {!attachments?.length ? (
                    <Box sx={{ textAlign: 'center', color: '#94a3b8', py: 6, bgcolor: '#f8fafc', borderRadius: 2, border: '1px dashed #cbd5e1' }}>
                        <Description sx={{ fontSize: 40, opacity: 0.3, mb: 1 }} />
                        <Typography variant="body2" fontWeight="500">–ù–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</Typography>
                    </Box>
                ) : (
                    // === –°–ï–¢–ö–ê –ö–ê–†–¢–û–ß–ï–ö ===
                    <Grid container spacing={3}>
                        {attachments.map((file: any) => {
                            const isPdf = file.file.toLowerCase().endsWith('.pdf');

                            return (
                                // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å: –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º 1 –∫–æ–ª–æ–Ω–∫–∞, –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ 2 (sm=6), –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ 4 (md=3)
                                <Grid item xs={12} sm={6} md={4} lg={3} key={file.id}>
                                    <Card
                                        elevation={0}
                                        sx={{
                                            height: '100%',
                                            display: 'flex',
                                            flexDirection: 'column',
                                            overflow: 'hidden',
                                            border: '1px solid #f1f5f9',
                                            borderRadius: 2,
                                            transition: 'all 0.2s',
                                            '&:hover': {
                                                transform: 'translateY(-4px)',
                                                borderColor: '#cbd5e1',
                                                boxShadow: '0 10px 20px -5px rgba(0, 0, 0, 0.08)'
                                            }
                                        }}
                                    >
                                        {/* –ü–†–ï–í–¨–Æ */}
                                        <Box
                                            sx={{
                                                height: 180, // –°–¥–µ–ª–∞–ª–∏ —á—É—Ç—å –≤—ã—à–µ –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
                                                bgcolor: '#f8fafc',
                                                position: 'relative',
                                                display: 'flex',
                                                alignItems: 'flex-start',
                                                justifyContent: 'center',
                                                overflow: 'hidden',
                                                cursor: 'pointer',
                                                borderBottom: '1px solid #f1f5f9'
                                            }}
                                            onClick={() => window.open(file.file, '_blank')}
                                        >
                                            <Box sx={{ position: 'absolute', top: 10, right: 10, zIndex: 10 }}>
                                                {isPdf && (
                                                    <Chip
                                                        label="PDF"
                                                        size="small"
                                                        icon={<PictureAsPdf style={{fontSize: 12, color: 'white'}}/>}
                                                        sx={{ height: 22, fontSize: 10, fontWeight: 700, bgcolor: '#ef4444', color: 'white', '& .MuiChip-icon': { color: 'white' } }}
                                                    />
                                                )}
                                            </Box>

                                            {isPdf ? (
                                                <Box sx={{ width: '100%', mt: -1, opacity: 0.9 }}>
                                                    <PdfThumbnail url={file.file} width={400} />
                                                </Box>
                                            ) : (
                                                <Box component="img" src={file.file} sx={{ width: '100%', height: '100%', objectFit: 'cover' }} />
                                            )}
                                        </Box>

                                        {/* –ò–ù–§–û–†–ú–ê–¶–ò–Ø */}
                                        <CardContent sx={{ p: 2, flexGrow: 1, display: 'flex', flexDirection: 'column', justifyContent: 'space-between' }}>
                                            <Box>
                                                <Typography
                                                    variant="body2"
                                                    sx={{
                                                        fontWeight: 600,
                                                        color: '#334155',
                                                        fontSize: '0.9rem',
                                                        lineHeight: 1.3,
                                                        mb: 1,
                                                        display: '-webkit-box',
                                                        WebkitLineClamp: 2,
                                                        WebkitBoxOrient: 'vertical',
                                                        overflow: 'hidden',
                                                        minHeight: '2.6em' // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è —Ä–æ–≤–Ω–æ—Å—Ç–∏
                                                    }}
                                                    title={file.description}
                                                >
                                                    {file.description || "–î–æ–∫—É–º–µ–Ω—Ç –±–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"}
                                                </Typography>
                                                <Typography variant="caption" sx={{ color: '#94a3b8', fontWeight: 500 }}>
                                                    {new Date(file.uploaded_at).toLocaleDateString()}
                                                </Typography>
                                            </Box>

                                            <Button
                                                href={file.file}
                                                target="_blank"
                                                fullWidth
                                                variant="outlined"
                                                startIcon={<Download sx={{ fontSize: 16 }} />}
                                                sx={{
                                                    mt: 2,
                                                    fontSize: '0.75rem',
                                                    py: 0.5,
                                                    borderRadius: 1.5,
                                                    textTransform: 'none',
                                                    color: '#475569',
                                                    borderColor: '#e2e8f0',
                                                    '&:hover': { bgcolor: '#f1f5f9', borderColor: '#cbd5e1', color: '#0f172a' }
                                                }}
                                            >
                                                –°–∫–∞—á–∞—Ç—å
                                            </Button>
                                        </CardContent>
                                    </Card>
                                </Grid>
                            );
                        })}
                    </Grid>
                )}
            </Paper>

            <Typography sx={{ fontSize: '11px', color: '#cbd5e1', textAlign: 'center', mt: 2, fontWeight: 500 }}>
                –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–µ–∫–ª–∞—Ä–∞–Ω—Ç–æ–º
            </Typography>
        </Box>
    );
};

==================================================
FILE: .\frontend\src\pages\Public\components\ElementTabs.tsx
==================================================
import { useState } from 'react';
import { Box, Paper, Tabs, Tab, Grid } from '@mui/material';
import { PropertyGroup, PropertyItem, FieldWrapper } from './UI/PropertyKit';
import { styles } from '../PublicElementPage.styles';

// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–∞–Ω–µ–ª–∏ —Ç–∞–±–æ–≤
function TabPanel({ children, value, index }: { children?: React.ReactNode; index: number; value: number; }) {
    return (
        <div role="tabpanel" hidden={value !== index}>
            {value === index && <Box sx={{ py: 3, px: {xs: 0, md: 2} }}>{children}</Box>}
        </div>
    );
}

export const ElementTabs = ({ data }: { data: any }) => {
    const [tab, setTab] = useState(0);

    // –î–∞–Ω–Ω—ã–µ —Å–µ–∫—Ü–∏–π
    const s1 = data.sec1_identification || {};
    const s2 = data.sec2_physical || {};
    const s3 = data.sec3_sanpin || {};
    const s5 = data.sec5_acute || {};
    const s6 = data.sec6_risks || {};
    const s8 = data.sec8_ecotox || {};
    const s9 = data.sec9_soil || {};
    const s11 = data.sec11_class || {};
    const s13 = data.sec13_label || {};
    const s14 = data.sec14_safety || {};
    const s15 = data.sec15_storage || {};
    const s18 = data.sec18_intl || {};
    const s20 = data.sec20_docs || {};
    const s21 = data.sec21_companies || {};
    const s22 = data.sec22_volumes || {};
    const s23 = data.sec23_extra || {};

    return (
        <Paper sx={styles.tabsPaper}>
            <Tabs
                value={tab} onChange={(_, v) => setTab(v)} variant="scrollable" scrollButtons="auto"
                sx={styles.tabsList}
            >
                <Tab label="1. –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è" />
                <Tab label="2. –û–ø–∞—Å–Ω–æ—Å—Ç—å" />
                <Tab label="3. –≠–∫–æ–ª–æ–≥–∏—è" />
                <Tab label="4. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è" />
                <Tab label="5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" />
                <Tab label="6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" />
            </Tabs>

            {/* TAB 1: –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –ò –§–ò–ó–ò–ö–ê */}
            <TabPanel value={tab} index={0}>
                <Grid container spacing={3}>
                    {/* –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–®–∏—Ä–æ–∫–∞—è) */}
                    <Grid item xs={12} md={8}>
                        <PropertyGroup title="–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–µ—â–µ—Å—Ç–≤–∞">
                            <FieldWrapper xs={12}><PropertyItem label="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ (RU)" value={data.primary_name_ru} /></FieldWrapper>
                            <FieldWrapper md={4}><PropertyItem label="CAS –ù–æ–º–µ—Ä" value={data.cas_number} /></FieldWrapper>
                            <FieldWrapper md={4}><PropertyItem label="EC –ù–æ–º–µ—Ä" value={s1.ec_number} /></FieldWrapper>
                            <FieldWrapper md={4}><PropertyItem label="–ö–æ–¥ –¢–ù –í–≠–î" value={s1.tnved_code} /></FieldWrapper>

                            <FieldWrapper xs={12}><PropertyItem label="–°–∏–Ω–æ–Ω–∏–º—ã" value={s1.synonyms} /></FieldWrapper>
                            <FieldWrapper xs={12} md={6}><PropertyItem label="IUPAC (EN)" value={s1.iupac_name_en} /></FieldWrapper>
                            <FieldWrapper xs={12} md={6}><PropertyItem label="IUPAC (RU)" value={s1.iupac_name_ru} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–•–∏–º–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞" value={s1.molecular_formula} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>

                    {/* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –§–∏–∑–∏–∫–∞ (–£–∑–∫–∞—è) */}
                    <Grid item xs={12} md={4}>
                        <PropertyGroup title="–§–∏–∑–∏–∫–æ-—Ö–∏–º–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞">
                            <FieldWrapper xs={6} md={12}><PropertyItem label="–ê–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ" value={s2.appearance} /></FieldWrapper>
                            <FieldWrapper xs={6} md={12}><PropertyItem label="–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ / –¶–≤–µ—Ç" value={s2.color} /></FieldWrapper>
                            <FieldWrapper xs={6} md={12}><PropertyItem label="–ó–∞–ø–∞—Ö" value={s2.odor} /></FieldWrapper>
                            <FieldWrapper xs={6} md={6}><PropertyItem label="–¢. –ø–ª–∞–≤–ª–µ–Ω–∏—è" value={s2.melting_point} /></FieldWrapper>
                            <FieldWrapper xs={6} md={6}><PropertyItem label="–¢. –∫–∏–ø–µ–Ω–∏—è" value={s2.boiling_point} /></FieldWrapper>
                            <FieldWrapper xs={6} md={6}><PropertyItem label="–ü–ª–æ—Ç–Ω–æ—Å—Ç—å" value={s2.density} /></FieldWrapper>
                            <FieldWrapper xs={6} md={6}><PropertyItem label="pH" value={s2.ph} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å –≤ –≤–æ–¥–µ" value={s2.solubility_water} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>
                </Grid>
            </TabPanel>

            {/* TAB 2: –¢–û–ö–°–ò–ö–û–õ–û–ì–ò–Ø */}
            <TabPanel value={tab} index={1}>
                <Grid container spacing={3}>
                    <Grid item xs={12}>
                        <PropertyGroup title="–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ (–°–∞–Ω–ü–∏–ù)">
                            {/* –ü–ª–æ—Ç–Ω–∞—è —Å–µ—Ç–∫–∞ –ø–æ 4 —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Ä—è–¥ */}
                            <FieldWrapper md={3}><PropertyItem label="–ö–ª–∞—Å—Å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏" value={s3.hazard_class} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–ö–í–ò–û" value={s3.kvio} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–ü–î–ö –†–∞–±.–∑–æ–Ω—ã" value={s3.pdk_workzone} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ" value={s3.state_in_air} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–õ–î50 –ñ–µ–ª—É–¥–æ–∫" value={s3.ld50_stomach} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–õ–î50 –ö–æ–∂–∞" value={s3.ld50_skin} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–õ–ö50 –í–æ–∑–¥—É—Ö" value={s3.lc50_air} /></FieldWrapper>
                            <FieldWrapper md={3}><PropertyItem label="–ó–æ–Ω–∞ –æ—Å—Ç—Ä–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è" value={s3.zone_acute} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>

                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ (–°–ì–°)">
                            <FieldWrapper xs={12}><PropertyItem label="–†–∞–∑—ä–µ–¥–∞–Ω–∏–µ / —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–∂–∏" value={s6.skin_corr} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–ª–∞–∑" value={s6.eye_dmg} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–°–µ–Ω—Å–∏–±–∏–ª–∏–∑–∞—Ü–∏—è" value={s6.sensitization} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã">
                            <FieldWrapper xs={12}><PropertyItem label="–ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å" value={s6.carcinogenicity} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–ú—É—Ç–∞–≥–µ–Ω–Ω–æ—Å—Ç—å" value={s6.mutagenicity} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–†–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å" value={s6.repro_tox} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>
                </Grid>
            </TabPanel>

            {/* TAB 3: –≠–ö–û–õ–û–ì–ò–Ø */}
            <TabPanel value={tab} index={2}>
                <Grid container spacing={3}>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–≠–∫–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å">
                            <FieldWrapper md={6}><PropertyItem label="–õ–î50 –ú–ª–µ–∫–æ–ø–∏—Ç–∞—é—â–∏–µ" value={s8.ld50_mammals} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–õ–î50 –ü—Ç–∏—Ü—ã" value={s8.ld50_birds} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–õ–î50 –†—ã–±—ã" value={s8.ld50_fish} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–õ–î50 –ü—á–µ–ª—ã" value={s8.ld50_bees} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–ë–∏–æ–∞–∫–∫—É–º—É–ª—è—Ü–∏—è" value={s8.bioaccumulation} isBool /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–§–∏—Ç–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å" value={s8.phytotoxicity} isBool /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–µ">
                            <FieldWrapper md={6}><PropertyItem label="–ü–î–ö –≤ –ü–æ—á–≤–µ" value={s9.pdk_soil} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–û–î–ö –≤ –ü–æ—á–≤–µ" value={s9.odk_soil} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å" value={s9.persistence} /></FieldWrapper>
                            <FieldWrapper md={6}><PropertyItem label="–ú–∏–≥—Ä–∞—Ü–∏—è" value={s9.migration} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>
                </Grid>
            </TabPanel>

            {/* TAB 4: –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø */}
            <TabPanel value={tab} index={3}>
                <Grid container spacing={3}>
                    <Grid item xs={12}>
                        <PropertyGroup title="–ö–ª–∞—Å—Å—ã –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º">
                            <Grid container spacing={2}>
                                <FieldWrapper md={4}><PropertyItem label="–°–∞–Ω–ü–∏–ù 0294-11" value={s11.sanpin_class} /></FieldWrapper>
                                <FieldWrapper md={4}><PropertyItem label="–ì–û–°–¢ 12.1.007" value={s11.gost_body_class} /></FieldWrapper>
                                <FieldWrapper md={4}><PropertyItem label="–ì–û–°–¢ 32424" value={s11.gost_env_class} /></FieldWrapper>
                            </Grid>
                        </PropertyGroup>
                    </Grid>

                    <Grid item xs={12}>
                        <PropertyGroup title="–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ GHS (–°–ì–°)">
                            <Grid container spacing={4}>
                                <Grid item xs={12} md={3}>
                                    <PropertyItem label="–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ" value={s13.signal_word} />
                                    <PropertyItem label="–ü–∏–∫—Ç–æ–≥—Ä–∞–º–º—ã" value={s13.pictogram_code} />
                                </Grid>
                                <Grid item xs={12} md={4}>
                                    <PropertyItem label="H-—Ñ—Ä–∞–∑—ã (–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏)" value={s13.h_phrases} />
                                </Grid>
                                <Grid item xs={12} md={5}>
                                    <PropertyItem label="P-—Ñ—Ä–∞–∑—ã (–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏)" value={s13.p_phrases} />
                                </Grid>
                            </Grid>
                        </PropertyGroup>
                    </Grid>
                </Grid>
            </TabPanel>

            {/* TAB 5: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ */}
            <TabPanel value={tab} index={4}>
                <Grid container spacing={3}>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–ú–µ—Ä—ã –ø–µ—Ä–≤–æ–π –ø–æ–º–æ—â–∏">
                            <PropertyItem label="–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏–∏" value={s14.first_aid} />
                        </PropertyGroup>
                    </Grid>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–°—Ä–µ–¥—Å—Ç–≤–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã (–°–ò–ó)">
                            <PropertyItem label="–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –°–ò–ó" value={s14.prevent_health} />
                        </PropertyGroup>
                    </Grid>
                    <Grid item xs={12}>
                        <PropertyGroup title="–•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ">
                            <Grid container spacing={2}>
                                <FieldWrapper md={3}><PropertyItem label="–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞" value={s15.temp_conditions} /></FieldWrapper>
                                <FieldWrapper md={3}><PropertyItem label="–í–ª–∞–∂–Ω–æ—Å—Ç—å" value={s15.humidity} /></FieldWrapper>
                                <FieldWrapper md={3}><PropertyItem label="–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è" value={s15.shelf_life} /></FieldWrapper>
                                <FieldWrapper xs={12}><PropertyItem label="–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è" value={s15.storage_reqs} /></FieldWrapper>
                                <FieldWrapper xs={12}><PropertyItem label="–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞" value={s15.incompatible} /></FieldWrapper>
                            </Grid>
                        </PropertyGroup>
                    </Grid>
                </Grid>
            </TabPanel>

            {/* TAB 6: –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û */}
            <TabPanel value={tab} index={5}>
                <Grid container spacing={3}>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ">
                            <Grid container spacing={2}>
                                <FieldWrapper md={6}><PropertyItem label="–û–∑–æ–Ω–æ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–µ (–ú–æ–Ω—Ä–µ–∞–ª—å)" value={s18.ozone_destroying} isBool /></FieldWrapper>
                                <FieldWrapper md={6}><PropertyItem label="–°—Ç–æ–∫–≥–æ–ª—å–º—Å–∫–∞—è –∫–æ–Ω–≤–µ–Ω—Ü–∏—è (–°–û–ó)" value={s18.pops} isBool /></FieldWrapper>
                                <FieldWrapper md={6}><PropertyItem label="–†–æ—Ç—Ç–µ—Ä–¥–∞–º—Å–∫–∞—è –∫–æ–Ω–≤–µ–Ω—Ü–∏—è (PIC)" value={s18.pic} isBool /></FieldWrapper>
                                <FieldWrapper md={6}><PropertyItem label="–ú–∏–Ω–∞–º–∞—Ç—Å–∫–∞—è –∫–æ–Ω–≤–µ–Ω—Ü–∏—è (–†—Ç—É—Ç—å)" value={s18.mercury} isBool /></FieldWrapper>
                            </Grid>
                        </PropertyGroup>
                    </Grid>
                    <Grid item xs={12} md={6}>
                        <PropertyGroup title="–û–±–æ—Ä–æ—Ç –ø—Ä–æ–¥—É–∫—Ü–∏–∏">
                            <FieldWrapper xs={6}><PropertyItem label="–û–±—ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞" value={s22.vol_production} /></FieldWrapper>
                            <FieldWrapper xs={6}><PropertyItem label="–û–±—ä–µ–º –∏–º–ø–æ—Ä—Ç–∞" value={s22.vol_import} /></FieldWrapper>
                            <FieldWrapper xs={12}><PropertyItem label="–£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ü–µ–ø–∏ –ø–æ—Å—Ç–∞–≤–æ–∫" value={s21.info} /></FieldWrapper>
                        </PropertyGroup>
                    </Grid>
                    <Grid item xs={12}>
                        <PropertyGroup title="–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è">
                            <PropertyItem label="–ì–û–°–¢—ã –∏ –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã" value={s20.gost_standards} />
                            <PropertyItem label="–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã" value={s20.intl_docs} />
                        </PropertyGroup>
                    </Grid>
                </Grid>
            </TabPanel>
        </Paper>
    );
};

==================================================
FILE: .\frontend\src\pages\Public\components\FilterSidebar.tsx
==================================================
import {
    Box, Paper, Typography, Checkbox, FormGroup, FormControlLabel,
    Accordion, AccordionSummary, AccordionDetails, Skeleton, Button
} from '@mui/material';
import { ExpandMore, FilterList, CleaningServices, InfoOutlined } from '@mui/icons-material';

interface FilterOption {
    value: string | boolean;
    label: string;
    count: number;
}

interface FilterGroup {
    title: string;
    options: FilterOption[];
}

interface FilterSidebarProps {
    data: Record<string, FilterGroup> | undefined;
    isLoading: boolean;
    activeFilters: Record<string, string>;
    onFilterChange: (key: string, value: string | null) => void;
}

export const FilterSidebar = ({ data, isLoading, activeFilters, onFilterChange }: FilterSidebarProps) => {

    // 1. –°–û–°–¢–û–Ø–ù–ò–ï –ó–ê–ì–†–£–ó–ö–ò (–ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–µ–ª–µ—Ç–æ–Ω)
    if (isLoading) {
        return (
            <Paper elevation={0} sx={{ p: 2, borderRadius: 3, border: '1px solid #e2e8f0', bgcolor: 'white' }}>
                <Box display="flex" gap={1} mb={2} alignItems="center">
                    <Skeleton variant="circular" width={24} height={24} />
                    <Skeleton variant="text" width="60%" height={30} />
                </Box>
                {/* –ò–º–∏—Ç–∞—Ü–∏—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ */}
                {[1, 2, 3].map((i) => (
                    <Box key={i} mb={2}>
                        <Skeleton variant="rectangular" height={32} sx={{ borderRadius: 1, mb: 1 }} />
                        <Skeleton variant="text" width="80%" />
                        <Skeleton variant="text" width="70%" />
                    </Box>
                ))}
            </Paper>
        );
    }

    // 2. –°–û–°–¢–û–Ø–ù–ò–ï "–ù–ï–¢ –î–ê–ù–ù–´–•" (–ü—É—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç)
    if (!data || Object.keys(data).length === 0) {
        return (
            <Paper elevation={0} sx={{ p: 3, borderRadius: 3, border: '1px dashed #cbd5e1', bgcolor: '#f8fafc', textAlign: 'center' }}>
                <InfoOutlined sx={{ color: '#94a3b8', fontSize: 40, mb: 1 }} />
                <Typography variant="body2" color="text.secondary" fontWeight="600">
                    –§–∏–ª—å—Ç—Ä—ã
                </Typography>
                <Typography variant="caption" color="text.disabled" display="block" mt={0.5} lineHeight={1.2}>
                    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.
                </Typography>
            </Paper>
        );
    }

    // 3. –û–ë–´–ß–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï
    return (
        <Paper elevation={0} sx={{ border: '1px solid #e2e8f0', borderRadius: 3, overflow: 'hidden', bgcolor: 'white' }}>
            {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
            <Box sx={{ p: 2, borderBottom: '1px solid #f1f5f9', bgcolor: '#f8fafc', display:'flex', alignItems:'center', justifyContent:'space-between' }}>
                <Box sx={{ display:'flex', alignItems:'center', gap:1 }}>
                    <FilterList fontSize="small" color="action" />
                    <Typography variant="subtitle2" fontWeight="700" color="#334155">–§–ò–õ–¨–¢–†–´</Typography>
                </Box>
                {Object.keys(activeFilters).length > 0 && (
                    <Button
                        size="small"
                        color="error"
                        sx={{ minWidth:0, p:0.5 }}
                        onClick={() => Object.keys(activeFilters).forEach(k => onFilterChange(k, null))}
                    >
                        <CleaningServices fontSize="small"/>
                    </Button>
                )}
            </Box>

            {/* –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø */}
            {Object.entries(data).map(([key, group], idx) => (
                <Accordion
                    key={key}
                    defaultExpanded={idx < 3} // –ü–µ—Ä–≤—ã–µ 3 –æ—Ç–∫—Ä—ã—Ç—ã
                    disableGutters
                    elevation={0}
                    sx={{ '&:before': { display: 'none' }, borderBottom: '1px solid #f1f5f9' }}
                >
                    <AccordionSummary expandIcon={<ExpandMore />}>
                        <Typography variant="body2" fontWeight="600" color="#1e293b">{group.title}</Typography>
                    </AccordionSummary>
                    <AccordionDetails sx={{ pt: 0, pb: 1 }}>
                        <FormGroup>
                            {group.options.map((opt) => {
                                const valStr = String(opt.value);
                                const isChecked = activeFilters[key] === valStr;

                                return (
                                    <FormControlLabel
                                        key={valStr}
                                        control={
                                            <Checkbox
                                                size="small"
                                                checked={isChecked}
                                                onChange={() => onFilterChange(key, isChecked ? null : valStr)}
                                            />
                                        }
                                        label={
                                            <Box display="flex" justifyContent="space-between" width="100%" gap={1}>
                                                <Typography variant="body2" fontSize="0.85rem" sx={{ wordBreak: 'break-word' }}>{opt.label}</Typography>
                                                <Typography variant="caption" color="text.secondary">({opt.count})</Typography>
                                            </Box>
                                        }
                                        sx={{
                                            ml: 0, mr: 0,
                                            justifyContent: 'space-between',
                                            width: '100%',
                                            alignItems: 'flex-start', // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ö—É –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
                                            '& .MuiFormControlLabel-label': { width: '100%', pt: 0.2 }
                                        }}
                                    />
                                );
                            })}
                        </FormGroup>
                    </AccordionDetails>
                </Accordion>
            ))}
        </Paper>
    );
};

==================================================
FILE: .\frontend\src\pages\Public\components\PdfThumbnail.tsx
==================================================
import { useState } from 'react';
import { Document, Page, pdfjs } from 'react-pdf';
import { Box, Skeleton, Typography } from '@mui/material';
import { PictureAsPdf, BrokenImage } from '@mui/icons-material';
import 'react-pdf/dist/Page/AnnotationLayer.css';
import 'react-pdf/dist/Page/TextLayer.css';

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ—Ä–∫–µ—Ä–∞ (–¥–≤–∏–∂–∫–∞ PDF)
// –ò—Å–ø–æ–ª—å–∑—É–µ–º CDN –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã –Ω–µ –≤–æ–∑–∏—Ç—å—Å—è —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ –≤ Vite
pdfjs.GlobalWorkerOptions.workerSrc = `//unpkg.com/pdfjs-dist@${pdfjs.version}/build/pdf.worker.min.mjs`;

interface Props {
    url: string;
    width?: number;
}

export const PdfThumbnail = ({ url, width = 280 }: Props) => {
    const [numPages, setNumPages] = useState<number | null>(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(false);

    const onDocumentLoadSuccess = ({ numPages }: { numPages: number }) => {
        setNumPages(numPages);
        setLoading(false);
    };

    const onDocumentLoadError = () => {
        setLoading(false);
        setError(true);
    };

    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –Ω–µ PDF
    if (error) {
        return (
            <Box
                sx={{
                    height: 140, bgcolor: '#f1f5f9', display: 'flex',
                    alignItems: 'center', justifyContent: 'center',
                    flexDirection: 'column', color: '#94a3b8',
                    borderBottom: '1px solid #e2e8f0'
                }}
            >
                <BrokenImage fontSize="large" />
                <Typography variant="caption" sx={{mt:1}}>–ü—Ä–µ–≤—å—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ</Typography>
            </Box>
        );
    }

    return (
        <Box
            sx={{
                width: '100%',
                height: 'auto',
                bgcolor: '#e2e8f0',
                overflow: 'hidden',
                position: 'relative',
                minHeight: 140,
                display: 'flex',
                justifyContent: 'center',
                borderBottom: '1px solid #ddd'
            }}
        >
            {/* –õ–æ–∞–¥–µ—Ä –ø–æ–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è */}
            {loading && (
                <Skeleton
                    variant="rectangular"
                    width="100%"
                    height={140}
                    sx={{ position: 'absolute', top:0, left:0, zIndex:2 }}
                />
            )}

            {/* –†–µ–Ω–¥–µ—Ä PDF */}
            <Document
                file={url}
                onLoadSuccess={onDocumentLoadSuccess}
                onLoadError={onDocumentLoadError}
                loading={<div />}
            >
                <Page
                    pageNumber={1}
                    width={width}
                    renderTextLayer={false} // –û—Ç–∫–ª—é—á–∞–µ–º —Ç–µ–∫—Å—Ç (–Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞)
                    renderAnnotationLayer={false}
                />
            </Document>

            {/* –ò–∫–æ–Ω–∫–∞ –ø–æ–≤–µ—Ä—Ö –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è —Å—Ç–∏–ª—è */}
            {!loading && !error && (
                <Box
                    sx={{
                        position: 'absolute', bottom: 5, right: 5,
                        bgcolor: 'rgba(255,255,255,0.8)',
                        borderRadius: '50%', p: 0.5,
                        display: 'flex'
                    }}
                >
                    <PictureAsPdf color="error" fontSize="small" />
                </Box>
            )}
        </Box>
    );
};

==================================================
FILE: .\frontend\src\pages\Public\components\SupportFab.tsx
==================================================
[BINARY FILE OR NON-UTF8 CONTENT - SKIPPED]

==================================================
FILE: .\frontend\src\pages\Public\components\UI\PropertyKit.tsx
==================================================
import { Box, Grid, Typography, Paper, Divider, Chip } from '@mui/material';
import { CheckCircle, Cancel, HelpOutline } from '@mui/icons-material';

// --- 1. –¢–ò–ü–´ ---
interface PropertyItemProps {
    label: string;
    value?: any;
    isBool?: boolean;
    // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ü–≤–µ—Ç –∏–ª–∏ –∏–∫–æ–Ω–∫—É
}

interface PropertyGroupProps {
    title?: string;
    children: React.ReactNode;
}

// –•–µ–ª–ø–µ—Ä –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ utils)
const formatValue = (val: any) => {
    if (val === null || val === undefined || val === '') return '‚Äî';
    const map: Record<string, string> = {
        'SOLID': '–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ', 'LIQUID': '–ñ–∏–¥–∫–æ—Å—Ç—å', 'GAS': '–ì–∞–∑',
        'VAPOR': '–ü–∞—Ä', 'AEROSOL': '–ê—ç—Ä–æ–∑–æ–ª—å',
        'NONE': '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç', 'SHARP': '–†–µ–∑–∫–∏–π', 'SPECIFIC': '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π',
        'FRUIT': '–§—Ä—É–∫—Ç–æ–≤—ã–π', 'OTHER': '–î—Ä—É–≥–æ–µ'
    };
    return map[String(val)] || val;
};

// --- 2. –ö–û–ú–ü–û–ù–ï–ù–¢ –û–î–ù–û–ì–û –ü–û–õ–Ø (PropertyItem) ---
export const PropertyItem = ({ label, value, isBool = false }: PropertyItemProps) => {
    // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ—Ç, –º—ã —Ä–µ–Ω–¥–µ—Ä–∏–º "‚Äî", —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å —Å–µ—Ç–∫—É (–∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null, –µ—Å–ª–∏ —Ö–æ—Ç–∏–º —Å–∫—Ä—ã–≤–∞—Ç—å)
    const displayValue = formatValue(value);

    // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∫—Ä—ã–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ –ø–æ–ª—è –ø–æ–ª–Ω–æ—Å—Ç—å—é:
    if ((value === null || value === undefined || value === "") && !isBool) return null;

    return (
        <Box sx={{ mb: 2 }}>
            <Typography
                variant="caption"
                sx={{
                    color: '#64748b',
                    fontWeight: 700,
                    letterSpacing: '0.5px',
                    textTransform: 'uppercase',
                    display: 'block',
                    mb: 0.5,
                    fontSize: '0.7rem'
                }}
            >
                {label}
            </Typography>

            <Box sx={{ minHeight: 24, display: 'flex', alignItems: 'center' }}>
                {isBool ? (
                    value ?
                        <Chip icon={<CheckCircle style={{ fontSize: 16 }}/>} label="–î–∞" size="small" color="success" variant="outlined" sx={{ fontWeight: 600, height: 24 }} /> :
                        <Chip icon={<Cancel style={{ fontSize: 16 }}/>} label="–ù–µ—Ç" size="small" color="default" variant="outlined" sx={{ fontWeight: 600, height: 24, borderColor: '#e2e8f0' }} />
                ) : (
                    <Typography
                        variant="body2"
                        sx={{
                            color: '#0f172a',
                            fontWeight: 500,
                            fontSize: '0.95rem',
                            lineHeight: 1.4,
                            wordBreak: 'break-word'
                        }}
                    >
                        {displayValue}
                    </Typography>
                )}
            </Box>
        </Box>
    );
};

// --- 3. –ö–û–ú–ü–û–ù–ï–ù–¢ –ì–†–£–ü–ü–´ (PropertyGroup) ---
export const PropertyGroup = ({ title, children }: PropertyGroupProps) => {
    return (
        <Paper
            elevation={0}
            sx={{
                p: 2.5,
                height: '100%', // –ß—Ç–æ–±—ã –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—ã–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –≤—ã—Å–æ—Ç—ã
                bgcolor: '#ffffff',
                border: '1px solid #e2e8f0',
                borderRadius: 3,
                transition: 'box-shadow 0.2s',
                '&:hover': {
                    boxShadow: '0 4px 12px rgba(0,0,0,0.03)'
                }
            }}
        >
            {title && (
                <Box sx={{ mb: 2.5, pb: 1.5, borderBottom: '1px solid #f1f5f9' }}>
                    <Typography
                        variant="subtitle2"
                        sx={{
                            fontWeight: 800,
                            color: '#334155',
                            textTransform: 'uppercase',
                            letterSpacing: '0.5px',
                            display: 'flex',
                            alignItems: 'center',
                            gap: 1
                        }}
                    >
                        {/* –ú–∞–ª–µ–Ω—å–∫–∏–π –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç */}
                        <Box component="span" sx={{ width: 6, height: 6, borderRadius: '50%', bgcolor: '#3b82f6', display: 'inline-block' }} />
                        {title}
                    </Typography>
                </Box>
            )}

            <Grid container spacing={2}>
                {children}
            </Grid>
        </Paper>
    );
};

// –•–µ–ª–ø–µ—Ä –¥–ª—è –æ–±–µ—Ä—Ç–∫–∏ PropertyItem –≤ Grid (—á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å <Grid item xs={...}> –∫–∞–∂–¥—ã–π —Ä–∞–∑)
export const FieldWrapper = ({ children, xs = 12, sm = 6, md = 6 }: { children: React.ReactNode, xs?: number, sm?: number, md?: number }) => (
    <Grid item xs={xs} sm={sm} md={md}>
        {children}
    </Grid>
);

==================================================
FILE: .\frontend\src\pages\Public\utils\formatters.ts
==================================================
// –°–õ–û–í–ê–†–¨ –ó–ù–ê–ß–ï–ù–ò–ô (RU)
const DISPLAY_MAP: Record<string, string> = {
    'SOLID': '–¢–≤–µ—Ä–¥–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ', 'LIQUID': '–ñ–∏–¥–∫–æ—Å—Ç—å', 'GAS': '–ì–∞–∑', 'VAPOR': '–ü–∞—Ä', 'AEROSOL': '–ê—ç—Ä–æ–∑–æ–ª—å',
    'NONE': '–ë–µ–∑ –∑–∞–ø–∞—Ö–∞', 'SHARP': '–†–µ–∑–∫–∏–π', 'SPECIFIC': '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π', 'FRUIT': '–§—Ä—É–∫—Ç–æ–≤—ã–π', 'OTHER': '–î—Ä—É–≥–æ–µ',
};

export const formatValue = (val: any) => {
    if (val === null || val === undefined || val === "") return "‚Äî";
    return DISPLAY_MAP[String(val)] || val;
};

==================================================
FILE: .\Postman collection\ChemicalRegistry.postman_collection.json
==================================================
{
  "info": {
    "_postman_id": "chemical-registry-collection-001",
    "name": "Chemical Registry API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "gpt-assistant"
  },
  "item": [
    {
      "name": "AUTH",
      "item": [
        {
          "name": "Login (JWT)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "let json = pm.response.json();",
                  "if (json.access) {",
                  "    pm.environment.set(\"auth_token\", json.access);",
                  "    pm.environment.set(\"refresh_token\", json.refresh);",
                  "    console.log(\"Access token saved.\");",
                  "}",
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"{{username}}\",\n    \"password\": \"{{password}}\"\n}"
            },
            "url": {
              "raw": "{{login_url}}",
              "host": ["{{login_url}}"]
            }
          }
        },
        {
          "name": "Refresh Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "let json = pm.response.json();",
                  "if (json.access) {",
                  "    pm.environment.set(\"auth_token\", json.access);",
                  "    console.log(\"Token refreshed.\");",
                  "}",
                  "pm.test(\"Status 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{ \"refresh\": \"{{refresh_token}}\" }"
            },
            "url": {
              "raw": "{{refresh_url}}",
              "host": ["{{refresh_url}}"]
            }
          }
        },
        {
          "name": "Register Supplier",
          "request": {
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"newuser\",\n  \"email\": \"new@user.com\",\n  \"password\": \"Pass1234\",\n  \"company\": {\n    \"company_name\": \"New LLC\",\n    \"inn\": \"123456789\",\n    \"address\": \"Test street\",\n    \"phone\": \"+998901234567\",\n    \"is_manufacturer\": true,\n    \"is_importer\": false,\n    \"is_exporter\": false\n  }\n}"
            },
            "url": {
              "raw": "{{register_url}}",
              "host": ["{{register_url}}"]
            }
          }
        },
        {
          "name": "Me (Current User)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{me_url}}",
              "host": ["{{me_url}}"]
            }
          }
        }
      ]
    },
    {
      "name": "ELEMENTS",
      "item": [
        {
          "name": "List Elements",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{elements_url}}",
              "host": ["{{elements_url}}"]
            }
          }
        },
        {
          "name": "Create Element",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cas_number\": \"123-45-6\",\n  \"primary_name_ru\": \"–•–ª–æ—Ä\",\n  \"status\": \"draft\"\n}"
            },
            "url": {
              "raw": "{{elements_url}}",
              "host": ["{{elements_url}}"]
            }
          }
        },
        {
          "name": "Retrieve Element",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{elements_url}}1/",
              "host": ["{{elements_url}}1/"]
            }
          }
        },
        {
          "name": "Update Element",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"primary_name_ru\": \"–•–ª–æ—Ä (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)\" }"
            },
            "url": {
              "raw": "{{elements_url}}1/",
              "host": ["{{elements_url}}1/"]
            }
          }
        },
        {
          "name": "Delete Element",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{elements_url}}1/",
              "host": ["{{elements_url}}1/"]
            }
          }
        }
      ]
    },
    {
      "name": "IMPORT",
      "item": [
        {
          "name": "Download Template",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{import_template_url}}",
              "host": ["{{import_template_url}}"]
            }
          }
        },
        {
          "name": "Upload Excel",
          "request": {
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": ""
                }
              ]
            },
            "url": {
              "raw": "{{import_upload_url}}",
              "host": ["{{import_upload_url}}"]
            }
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "exec": [
          "// Auto login if no token",
          "if (!pm.environment.get(\"auth_token\")) {",
          "    console.log(\"No token ‚Üí auto login...\");",
          "    pm.sendRequest({",
          "        url: pm.environment.get(\"login_url\"),",
          "        method: 'POST',",
          "        header: { 'Content-Type': 'application/json' },",
          "        body: {",
          "            mode: 'raw',",
          "            raw: JSON.stringify({",
          "                username: pm.environment.get('username'),",
          "                password: pm.environment.get('password')",
          "            })",
          "        }",
          "    }, function (err, res) {",
          "        if (!err) {",
          "            let data = res.json();",
          "            pm.environment.set(\"auth_token\", data.access);",
          "            pm.environment.set(\"refresh_token\", data.refresh);",
          "            console.log(\"Auto login token acquired.\");",
          "        }",
          "    });",
          "}"
        ]
      }
    }
  ]
}


==================================================
FILE: .\Postman collection\ChemicalRegistry.postman_environment.json
==================================================
{
  "id": "chemical-registry-env-001",
  "name": "Chemical Registry Local",
  "values": [
    {
      "key": "base_url",
      "value": "http://localhost:8000/api",
      "type": "default",
      "enabled": true
    },
    {
      "key": "username",
      "value": "",
      "type": "secret",
      "enabled": true
    },
    {
      "key": "password",
      "value": "",
      "type": "secret",
      "enabled": true
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "secret",
      "enabled": true
    },
    {
      "key": "refresh_token",
      "value": "",
      "type": "secret",
      "enabled": true
    },
    {
      "key": "login_url",
      "value": "{{base_url}}/token/",
      "type": "default",
      "enabled": true
    },
    {
      "key": "refresh_url",
      "value": "{{base_url}}/token/refresh/",
      "type": "default",
      "enabled": true
    },
    {
      "key": "me_url",
      "value": "{{base_url}}/auth/me/",
      "type": "default",
      "enabled": true
    },
    {
      "key": "register_url",
      "value": "{{base_url}}/auth/register/",
      "type": "default",
      "enabled": true
    },
    {
      "key": "elements_url",
      "value": "{{base_url}}/registry/elements/",
      "type": "default",
      "enabled": true
    },
    {
      "key": "import_template_url",
      "value": "{{base_url}}/registry/import/template/",
      "type": "default",
      "enabled": true
    },
    {
      "key": "import_upload_url",
      "value": "{{base_url}}/registry/import/upload/",
      "type": "default",
      "enabled": true
    }
  ],
  "_postman_variable_scope": "environment",
  "_postman_exported_at": "2025-12-03T00:00:00.000Z",
  "_postman_exported_using": "Postman GPT Assistant"
}


